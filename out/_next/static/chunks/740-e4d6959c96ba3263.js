"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[740],{740:function(e,n,r){r.r(n);var t=r(8520),s=r.n(t),i=r(5893),c=r(9736),a=r(2028),o=r(9762),l=r(4612),d=r(5193),u=r(3441),x=r(9042),h=r(8790),p=r(7375),f=r(4090),m=r(9669),j=r.n(m),g=r(7294),k=r(8756),w=r(1163);function v(e,n,r,t,s,i,c){try{var a=e[i](c),o=a.value}catch(l){return void r(l)}a.done?n(o):Promise.resolve(o).then(t,s)}function b(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var i=e.apply(n,r);function c(e){v(i,t,s,c,a,"next",e)}function a(e){v(i,t,s,c,a,"throw",e)}c(void 0)}))}}n.default=function(){var e=function(){return(0,i.jsxs)(a.u_,{size:"2xl",onClose:V.onClose,isOpen:V.isOpen,onOpen:V.onOpen,isCentered:!0,children:[(0,i.jsx)(a.ZA,{}),(0,i.jsxs)(a.hz,{children:[(0,i.jsx)(a.xB,{children:"Rework Request"}),(0,i.jsx)(a.ol,{}),(0,i.jsxs)(a.fe,{children:[(0,i.jsxs)(o.NI,{id:"file",children:[(0,i.jsx)(o.lX,{children:"1) Upload File"}),(0,i.jsxs)(l.BZ,{children:[(0,i.jsx)(l.II,{type:"text",isReadOnly:!0,value:_}),(0,i.jsxs)(l.xW,{children:[(0,i.jsx)(d.zx,{onClick:function(){return E.current.click()},children:(0,i.jsx)(c.Uj,{})}),(0,i.jsx)("input",{type:"file",onChange:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(E.current.files[0].name),e.next=3,te(E.current.files[0].name,E.current.files[0]);case 3:case"end":return e.stop()}}),e)}))),ref:E,style:{display:"none"}})]})]})]}),(0,i.jsxs)(l.BZ,{flexDirection:"column",children:[(0,i.jsx)(o.lX,{children:"2) Add Comments For Experts"}),(0,i.jsx)(u.g,{id:"qcComment"})]})]}),(0,i.jsx)(a.mz,{children:(0,i.jsx)(d.zx,{onClick:function(){q?window.alert("File is still being uploaded"):function(e){G.apply(this,arguments)}(I)},children:"Send"})})]})]})},n=function(){return(0,i.jsxs)(a.u_,{size:"2xl",onClose:ie.onClose,isOpen:ie.isOpen,onOpen:ie.onOpen,isCentered:!0,children:[(0,i.jsx)(a.ZA,{}),(0,i.jsxs)(a.hz,{children:[(0,i.jsx)(a.xB,{children:"Submissions"}),(0,i.jsx)(a.ol,{}),(0,i.jsx)(a.fe,{children:(0,i.jsxs)(x.iA,{variant:"simple",size:"sm",children:[(0,i.jsx)(x.hr,{bgColor:"gray.200",children:(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"File"}),(0,i.jsx)(x.Th,{children:"Category"}),(0,i.jsx)(x.Th,{children:"Date"}),(0,i.jsx)(x.Th,{children:"Delivery"}),(0,i.jsx)(x.Th,{children:"Expert ID"})]})}),(0,i.jsx)(x.p3,{children:0===T.length?(0,i.jsx)(i.Fragment,{}):T.map((function(e,n){return(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Td,{maxW:"100px",children:(0,i.jsx)(h.rU,{isExternal:!0,href:e.url,children:e.name})}),(0,i.jsx)(x.Td,{children:e.category}),(0,i.jsx)(x.Td,{children:e.createdAt}),(0,i.jsx)(x.Td,{color:new Date(e.createdAtNF)-new Date(t[I].expertDeadlineNF)<=0?"green":"red",children:new Date(e.createdAtNF)-new Date(t[I].expertDeadlineNF)<=0?"On Time":"Late"}),(0,i.jsx)(x.Td,{children:e.expertId})]},e._id)}))})]})})]})]})},r=(0,g.useState)([]),t=r[0],m=r[1],v=(0,g.useState)([]),T=v[0],C=v[1],y=(0,g.useState)(),I=y[0],S=y[1],A=(0,g.useState)(""),z=A[0],D=A[1],E=(0,g.useRef)(null),O=(0,g.useState)(""),_=O[0],F=O[1],R=(0,g.useState)(""),W=R[0],Q=R[1],B=(0,p.qY)(),N=B.isOpen,U=(B.onOpen,B.onClose),J=(0,g.useState)(!1),q=J[0],P=J[1],Z=[],L=[],M=(0,w.useRouter)();function X(e){return Y.apply(this,arguments)}function Y(){return(Y=b(s().mark((function e(n){var r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem("userToken"),i={headers:{Authorization:"Bearer ".concat(r)}},e.next=5,j().post(k.JW+"/expert/remove/ask",{assignmentId:t[n].id},i);case 5:e.sent,window.alert("Operator asked for approval to remove expert"),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function H(e){return K.apply(this,arguments)}function K(){return(K=b(s().mark((function e(n){var r,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem("userToken"),i=localStorage.getItem("userEmail"),c={headers:{Authorization:"Bearer ".concat(r)}},e.next=6,j().post(k.JW+"/assignment/update",{_id:t[n].id,status:"Proof Read",assignedQC:i},c);case 6:e.sent,oe(),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function G(){return(G=b(s().mark((function e(n){var r,i,c,a,o,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=document.getElementById("qcComment"),i=localStorage.getItem("userEmail"),c=localStorage.getItem("userName"),""!==r.value){e.next=7;break}window.alert("Add a comment"),e.next=43;break;case 7:if(""!==W){e.next=25;break}return e.prev=8,a=localStorage.getItem("userToken"),o={headers:{Authorization:"Bearer ".concat(a)}},e.next=13,j().post(k.JW+"/assignment/update",{_id:t[n].id,status:"Internal Rework",assignedQC:i},o);case 13:return e.sent,e.next=16,j().post(k.JW+"/assignment/comments/QCToExpert",{assignmentId:t[n].id,expertId:t[n].assignedExpert,commentsFromQC:{_id:i,name:c,comment:r.value}},o);case 16:e.sent,oe(),V.onClose(),e.next=23;break;case 21:e.prev=21,e.t0=e.catch(8);case 23:e.next=43;break;case 25:return e.prev=25,l=localStorage.getItem("userToken"),d={headers:{Authorization:"Bearer ".concat(l)}},e.next=30,j().post(k.JW+"/assignment/update",{_id:t[n].id,status:"Internal Rework",assignedQC:i},d);case 30:return e.sent,e.next=33,j().post(k.JW+"/assignment/comments/QCToExpert",{assignmentId:t[n].id,expertId:t[n].assignedExpert,commentsFromQC:{_id:i,name:c,comment:W}},d);case 33:return e.sent,e.next=36,j().post(k.JW+"/assignment/comments/QCToExpert",{assignmentId:t[n].id,expertId:t[n].assignedExpert,commentsFromQC:{_id:i,name:c,comment:r.value}},d);case 36:e.sent,oe(),V.onClose(),e.next=43;break;case 41:e.prev=41,e.t1=e.catch(25);case 43:case"end":return e.stop()}}),e,null,[[8,21],[25,41]])})))).apply(this,arguments)}var V=(0,p.qY)();function $(e){return ee.apply(this,arguments)}function ee(){return(ee=b(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(n),F(""),Q(""),V.onOpen();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return re.apply(this,arguments)}function re(){return(re=b(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j().get(k.JW+"/util/sas-token?container_name=assignment-dscp");case 3:n=e.sent,(r=n.data).success&&D(r.SASToken),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function te(e,n){return se.apply(this,arguments)}function se(){return(se=b(s().mark((function e(n,r){var t,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(!0),t=r,i={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(n)+"?"+z,headers:{"x-ms-blob-type":"BlockBlob"},data:t},j()(i).then((function(e){Q("https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(n)),P(!1)})).catch((function(e){console.log(e),P(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=(0,p.qY)();function ce(e){return ae.apply(this,arguments)}function ae(){return(ae=b(s().mark((function e(n){var r,i,c,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(n),e.prev=1,null==(r=localStorage.getItem("userToken"))&&M.replace("/admin/login"),i={headers:{Authorization:"Bearer ".concat(r)}},e.next=7,j().get(k.JW+"/assignment/submissions/fetch?assignment_id="+t[n].id,i);case 7:return c=e.sent,e.next=10,c.data.result.workSubmissions;case 10:if(a=e.sent,L=[],0!==a.length)for(o=0;o<a.length;o++)L.push({_id:a[o]._id,name:a[o].name,url:a[o].url,category:a[o].category,createdAt:a[o].createdAt,createdAtNF:a[o].createdAt,expertId:a[o].expertId});else window.alert("No Submissions Found");C(L),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0);case 19:ie.onOpen();case 20:case"end":return e.stop()}}),e,null,[[1,16]])})))).apply(this,arguments)}function oe(){return le.apply(this,arguments)}function le(){return(le=b(s().mark((function e(){var n,r,t,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==(n=localStorage.getItem("userToken"))&&M.replace("/admin/login"),r={headers:{Authorization:"Bearer ".concat(n)}},e.next=6,j().get(k.JW+"/assignment/fetch?status=Client%20Rework",r);case 6:if(t=e.sent,i=t.data.assignmentData,Z=[],0===i.length){e.next=15;break}for(c=0;c<i.length;c++)Z.push({id:i[c]._id,assignedExpert:i[c].assignedExpert,assignedQC:i[c].assignedQC,client_id:i[c].client_id,subject:i[c].subject,status:i[c].status,quotation:i[c].quotation,currencyOfQuote:i[c].currencyOfQuote,level:i[c].level,reference:i[c].reference,description:i[c].description,descriptionFile:i[c].descriptionFile,numOfPages:i[c].numOfPages,paid:i[c].paid,deadline:new Date(i[c].deadline).toLocaleTimeString()+", "+new Date(i[c].deadline).toDateString(),expertDeadline:new Date(i[c].expertDeadline).toLocaleTimeString()+", "+new Date(i[c].expertDeadline).toDateString(),expertDeadlineNF:i[c].expertDeadline});return e.next=13,ne();case 13:e.next=16;break;case 15:console.log("No Raw Submission Orders");case 16:m(Z),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}return(0,g.useEffect)((function(){oe()}),[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{display:{base:"none",sm:"block",md:"block"},children:[(0,i.jsxs)(a.u_,{closeOnOverlayClick:!1,isOpen:N,onClose:U,children:[(0,i.jsx)(a.ZA,{}),(0,i.jsxs)(a.hz,{children:[(0,i.jsx)(a.xB,{children:"File Upload"}),(0,i.jsx)(a.ol,{}),(0,i.jsx)(a.fe,{pb:6,children:"File is being uploaded, please wait.."})]})]}),(0,i.jsx)(e,{}),(0,i.jsx)(n,{}),(0,i.jsxs)(x.iA,{variant:"simple",size:"md",display:{base:"none",sm:"block",md:"block"},children:[(0,i.jsx)(x.hr,{bgColor:"gray.200",children:(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Id"}),(0,i.jsx)(x.Th,{children:"Subject"}),(0,i.jsx)(x.Th,{children:"Deadline"}),(0,i.jsx)(x.Th,{children:"Expert Deadline"}),(0,i.jsx)(x.Th,{children:"Assigned Expert"}),(0,i.jsx)(x.Th,{children:"Assigned QC"}),(0,i.jsx)(x.Th,{children:(0,i.jsx)(d.zx,{leftIcon:(0,i.jsx)(c.ny,{}),onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:case"end":return e.stop()}}),e)}))),children:"Refresh"})})]})}),(0,i.jsx)(x.p3,{children:t.map((function(e,n){return(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Td,{fontWeight:"semibold",children:(0,i.jsx)(h.rU,{href:"/admin/assignment_details/"+e.id,children:e.id})}),(0,i.jsx)(x.Td,{color:"green.600",fontWeight:"semibold",children:e.subject}),(0,i.jsx)(x.Td,{color:"red.600",fontWeight:"semibold",children:e.deadline}),(0,i.jsx)(x.Td,{color:"red.600",fontWeight:"semibold",children:e.expertDeadline}),(0,i.jsx)(x.Td,{children:e.assignedExpert}),(0,i.jsx)(x.Td,{children:e.assignedQC}),(0,i.jsx)(x.Td,{children:(0,i.jsxs)(h.Ug,{children:[(0,i.jsx)(d.zx,{onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ce(n));case 1:case"end":return e.stop()}}),e)}))),children:"Submissions from Experts"}),(0,i.jsx)(d.zx,{onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",H(n));case 1:case"end":return e.stop()}}),e)}))),children:"Mark as Proof Read"}),(0,i.jsx)(d.zx,{color:"red",onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$(n));case 1:case"end":return e.stop()}}),e)}))),children:"Send for Rework"}),(0,i.jsx)(d.zx,{color:"red",onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(n));case 1:case"end":return e.stop()}}),e)}))),children:"Remove Expert"})]})})]},e.id)}))})]})]}),(0,i.jsx)("div",{className:"",children:t.map((function(r,t){return(0,i.jsx)(f.UQ,{defaultIndex:[0],allowMultiple:!0,children:(0,i.jsxs)(f.Qd,{children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(f.KF,{children:[(0,i.jsx)(h.xu,{flex:"1",textAlign:"left",children:(0,i.jsx)(x.iA,{children:(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Id"}),(0,i.jsx)(x.Td,{fontWeight:"semibold",children:(0,i.jsx)(h.rU,{href:"/admin/assignment_details/"+r.id,children:r.id})})]})})}),(0,i.jsx)(f.XE,{})]})}),(0,i.jsxs)(f.Hk,{pb:0,children:[(0,i.jsxs)(a.u_,{closeOnOverlayClick:!1,isOpen:N,onClose:U,children:[(0,i.jsx)(a.ZA,{}),(0,i.jsxs)(a.hz,{children:[(0,i.jsx)(a.xB,{children:"File Upload"}),(0,i.jsx)(a.ol,{}),(0,i.jsx)(a.fe,{pb:6,children:"File is being uploaded, please wait.."})]})]}),(0,i.jsx)(e,{}),(0,i.jsx)(n,{}),(0,i.jsxs)(x.iA,{variant:"simple",size:"md",children:[(0,i.jsx)(x.hr,{bgColor:"gray.200"}),(0,i.jsx)(x.p3,{children:(0,i.jsx)(x.Tr,{children:(0,i.jsxs)(x.iA,{children:[(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Subject"}),(0,i.jsx)(x.Td,{color:"green.600",fontWeight:"semibold",children:r.subject})]}),(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Deadline"}),(0,i.jsx)(x.Td,{color:"red.600",fontWeight:"semibold",children:r.deadline})]}),(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Expert Deadline"}),(0,i.jsx)(x.Td,{color:"red.600",fontWeight:"semibold",children:r.expertDeadline})]}),(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Assigned Expert"}),(0,i.jsx)(x.Td,{children:r.assignedExpert})]}),(0,i.jsxs)(x.Tr,{children:[(0,i.jsx)(x.Th,{children:"Assigned QC"}),(0,i.jsx)(x.Td,{children:r.assignedQC})]}),(0,i.jsx)(x.Tr,{children:(0,i.jsx)(x.Td,{children:(0,i.jsxs)(h.Ug,{children:[(0,i.jsx)(d.zx,{onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ce(t));case 1:case"end":return e.stop()}}),e)}))),children:"Submissions from Experts"}),(0,i.jsx)(d.zx,{onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",H(t));case 1:case"end":return e.stop()}}),e)}))),children:"Mark as Proof Read"}),(0,i.jsx)(d.zx,{color:"red",onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$(t));case 1:case"end":return e.stop()}}),e)}))),children:"Send for Rework"}),(0,i.jsx)(d.zx,{color:"red",onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(t));case 1:case"end":return e.stop()}}),e)}))),children:"Remove Expert"})]})})}),(0,i.jsx)(x.Tr,{children:(0,i.jsx)(x.Th,{children:(0,i.jsx)(d.zx,{leftIcon:(0,i.jsx)(c.ny,{}),onClick:b(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:case"end":return e.stop()}}),e)}))),children:"Refresh"})})})]})},r.id)})]})]})]})})}))})]})}}}]);