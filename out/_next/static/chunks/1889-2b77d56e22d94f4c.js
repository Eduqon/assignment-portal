"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1889],{1889:function(e,n,t){t.r(n);var r=t(8520),s=t.n(r),i=t(5893),a=t(7294),c=t(9736),o=t(2028),l=t(8790),d=t(4612),u=t(5193),h=t(9042),p=t(7375),x=t(4090),f=t(6257),g=t(1163),m=t(9669),j=t.n(m),b=t(7388),v=t(8756),w=t(8765);function T(e,n,t,r,s,i,a){try{var c=e[i](a),o=c.value}catch(l){return void t(l)}c.done?n(o):Promise.resolve(o).then(r,s)}function y(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function a(e){T(i,r,s,a,c,"next",e)}function c(e){T(i,r,s,a,c,"throw",e)}a(void 0)}))}}function k(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){k(e,n,t[n])}))}return e}function S(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.default=function(e){var n=e.confirmOrderAssignedExpertMessages,t=e.operatorExpertChat,r=function(){return(0,i.jsxs)(o.u_,{size:"lg",onClose:ee.onClose,isOpen:ee.isOpen,onOpen:ee.onOpen,isCentered:!0,children:[(0,i.jsx)(o.ZA,{}),(0,i.jsxs)(o.hz,{maxH:"500px",children:[(0,i.jsx)(o.ol,{}),(0,i.jsx)(o.fe,{children:(0,i.jsxs)(l.xu,{display:"block",borderWidth:"1px",borderRadius:"md",width:"md",children:[(0,i.jsx)(l.xu,{p:4,bgColor:"gray.200",children:(0,i.jsx)(l.Ug,{children:(0,i.jsx)(l.X6,{fontSize:"xl",children:"Operator Chat with Expert"})})}),(0,i.jsxs)(l.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,i.jsx)(l.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:_&&t&&t[_.id]&&t[_.id].map((function(e,n){return(0,i.jsx)(l.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",alignSelf:e.user===P?"flex-end":"flex-start",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:e.user===P?"blue.100":"green.100",children:(0,i.jsxs)(l.gC,{maxWidth:"100%",overflowWrap:"break-word",children:[(0,i.jsx)(l.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,i.jsx)(l.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg&&e.msg.substring(62)})]})},n)}))}),(0,i.jsxs)(d.BZ,{children:[(0,i.jsx)(d.II,{type:"text",id:"addChatOperatorExpert"}),(0,i.jsx)(d.II,{type:"file",id:"addFileOperatorExpert",onChange:y(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",B){M();try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(B.current.files[0].name)+"?"+Z,headers:{"x-ms-blob-type":"BlockBlob"},data:B.current.files[0]},j()(t).then(function(e){var t=y(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(B.current.files[0].name),e.next=3,(0,f.r7)((0,f.JU)(b.db,"chat",_.chat[_.chat.length-1].user+"_"+P+"_"+_.id),{conversation:(0,f.vr)({msg:n,time:Date.now(),type:"MEDIA",user:P})});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(r){console.log(r)}J()}case 2:case"end":return e.stop()}}),e)}))),ref:B,style:{display:"none"}}),(0,i.jsx)(d.Z8,{h:"full",children:(0,i.jsx)(u.zx,{id:"attachButton",onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,i.jsx)(c.Uj,{})})}),(0,i.jsx)(d.xH,{h:"full",children:(0,i.jsx)(u.zx,{id:"sendButton",onClick:y(s().mark((function e(){var n,t,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("userToken"),t=/\b[\+]?[(]?[0-9]{2,6}[)]?[-\s\.]?[-\s\/\.0-9]{3,15}\b/m,""===(r=document.getElementById("addChatOperatorExpert")).value||void 0===r.value){e.next=23;break}if(!t.test(r.value)){e.next=8;break}window.alert("Sharing Phone Numbers through Chat is not allowed"),e.next=23;break;case 8:return e.next=10,(0,f.r7)((0,f.JU)(b.db,"chat",_.chat[_.chat.length-1].user+"_"+P+"_"+_.id),{conversation:(0,f.vr)({msg:r.value,time:Date.now(),type:"TEXT",user:P})});case 10:return e.sent,i={headers:{Authorization:"Bearer ".concat(n)}},e.prev=12,e.next=15,j().post(v.JW+"/messages",{id:_.id,expertEmail:_.chat[_.chat.length-1].user},i);case 15:a=e.sent,a.data.success&&(r.value=""),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(12),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[12,20]])}))),children:(0,i.jsx)(c.mr,{})})})]})]})]})})]})]})},m=function(){var e;return k&&0!==k.length&&n&&0!==n.length&&A&&(e=n.filter((function(e){return k[A].id===e.id}))),(0,i.jsxs)(o.u_,{size:"4xl",onClose:$.onClose,isOpen:$.isOpen,onOpen:$.onOpen,isCentered:!0,children:[(0,i.jsx)(o.ZA,{}),(0,i.jsxs)(o.hz,{children:[(0,i.jsx)(o.xB,{children:"Messages"}),(0,i.jsx)(o.ol,{}),(0,i.jsx)(o.fe,{children:(0,i.jsxs)(h.iA,{variant:"simple",size:"sm",children:[(0,i.jsx)(h.hr,{bgColor:"gray.200",children:(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Id"}),(0,i.jsx)(h.Th,{children:"Expert Email"}),(0,i.jsx)(h.Th,{children:"Messages"}),(0,i.jsx)(h.Th,{})]})}),(0,i.jsx)(h.p3,{children:e&&0===e.length?(0,i.jsx)(i.Fragment,{}):e&&e.map((function(e,n){return(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Td,{children:e.id}),(0,i.jsx)(h.Td,{children:e.chat[e.chat.length-1].user}),(0,i.jsx)(h.Td,{children:e.chat[e.chat.length-1].msg}),(0,i.jsx)(h.Td,{children:(0,i.jsx)(l.Ug,{children:(0,i.jsx)(u.zx,{onClick:y(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,le(e);case 2:ue(e.id);case 3:case"end":return n.stop()}}),n)}))),children:"Reply"})})})]},e.id)}))})]})})]})]})},T=(0,a.useState)([]),k=T[0],E=T[1],I=(0,a.useState)(),A=I[0],O=I[1],D=(0,a.useState)([]),_=D[0],W=D[1],z=(0,a.useState)(""),P=z[0],R=z[1],B=(0,a.useRef)(null),U=(0,p.qY)(),M=U.onOpen,J=U.onClose,N=(0,a.useState)(!1),F=N[0],L=N[1],q=(0,a.useState)(null),H=q[0],Q=q[1],X=(0,a.useState)(""),Z=X[0],Y=X[1],K=(0,a.useState)(""),G=K[0],V=K[1],$=(0,p.qY)(),ee=(0,p.qY)(),ne=[],te=(0,g.useRouter)();function re(){return se.apply(this,arguments)}function se(){return(se=y(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userEmail"),R(n),e.prev=2,e.next=5,j().get(v.JW+"/util/sas-token?container_name=assignment-dscp");case 5:t=e.sent,(r=t.data).success&&Y(r.SASToken),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function ie(e){return ae.apply(this,arguments)}function ae(){return(ae=y(s().mark((function e(n){var t,r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem("userToken"),r=localStorage.getItem("userEmail"),i={headers:{Authorization:"Bearer ".concat(t)}},e.next=6,j().post(v.JW+"/assignment/update",{_id:k[n].id,status:"CP1 Done",assignedExpert:"",assignedQC:r},i);case 6:e.sent,ce(),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function ce(){return oe.apply(this,arguments)}function oe(){return(oe=y(s().mark((function e(){var n,t,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==(n=localStorage.getItem("userToken"))&&te.replace("/admin/login"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=6,j().get(v.JW+"/assignment/fetch?status=Expert%20Assigned",t);case 6:if(r=e.sent,i=r.data.assignmentData,ne=[],0!==i.length)for(a=0;a<i.length;a++)ne.push({id:i[a]._id,assignedExpert:i[a].assignedExpert,client_id:i[a].client_id,subject:i[a].subject,status:i[a].status,quotation:i[a].quotation,currencyOfQuote:i[a].currencyOfQuote,level:i[a].level,reference:i[a].reference,description:i[a].description,descriptionFile:i[a].descriptionFile,numOfPages:i[a].numOfPages,paid:i[a].paid,deadline:new Date(i[a].deadline).toLocaleTimeString()+", "+new Date(i[a].deadline).toDateString(),expertDeadline:new Date(i[a].expertDeadline).toLocaleTimeString()+", "+new Date(i[a].expertDeadline).toDateString()});else console.log("No Expert Asked Orders");E(ne),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=y(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{null==localStorage.getItem("userToken")&&te.replace("/admin/login")}catch(t){console.log(t)}W(n),ee.onOpen();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return he.apply(this,arguments)}function he(){return(he=y(s().mark((function e(n){var r,i,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==(r=localStorage.getItem("userToken"))&&te.replace("/admin/login"),{headers:{Authorization:"Bearer ".concat(r)}},!t[n]){e.next=11;break}return i=t[n].slice(),a=i.pop(),c=localStorage.getItem("userEmail"),e.next=10,(0,f.r7)((0,f.JU)(b.db,"chat",a.user+"_"+c+"_"+n),{conversation:S(i).concat([C({},a,{newMessageCount:0})])});case 10:e.sent;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function pe(e){return xe.apply(this,arguments)}function xe(){return(xe=y(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(n),$.onOpen();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.useEffect)((function(){y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re();case 2:case"end":return e.stop()}}),e)})))()}),[]),(0,a.useEffect)((function(){ce()}),[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m,{}),(0,i.jsx)(r,{}),(0,i.jsxs)(h.iA,{variant:"simple",size:"md",display:{base:"none",sm:"block",md:"block"},children:[(0,i.jsx)(h.hr,{bgColor:"gray.200",children:(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Id"}),(0,i.jsx)(h.Th,{children:"Student Email"}),(0,i.jsx)(h.Th,{children:"Subject"}),(0,i.jsx)(h.Th,{children:"Amount Paid"}),(0,i.jsx)(h.Th,{children:"Expert"}),(0,i.jsx)(h.Th,{children:"Expert Deadline"}),(0,i.jsx)(h.Th,{children:"Deadline"}),(0,i.jsx)(h.Th,{children:(0,i.jsx)(u.zx,{leftIcon:(0,i.jsx)(c.ny,{}),onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:case"end":return e.stop()}}),e)}))),children:"Refresh"})})]})}),(0,i.jsx)(h.p3,{children:k.map((function(e,t){return(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Td,{fontWeight:"semibold",paddingTop:9,children:(0,i.jsxs)(l.xu,{display:"flex",children:[(0,i.jsx)(l.rU,{href:"/admin/assignment_details/"+e.id,children:e.id}),n&&0!==n.length&&n.map((function(n){if(n.id===e.id&&n.chat&&0!==n.chat.length&&0!==n.chat[n.chat.length-1].newMessageCount)return(0,i.jsxs)(l.xu,{display:"flex",alignItems:"center",position:"relative",marginLeft:2,cursor:"pointer",onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe(t));case 1:case"end":return e.stop()}}),e)}))),children:[(0,i.jsx)(c.kB,{width:"1.5em",height:"1.5em"}),(0,i.jsx)(l.xu,{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:15,backgroundColor:"rgb(201, 105, 105)",marginLeft:2,width:5,height:5,color:"white",position:"absolute",right:"-10px",top:"-5px",children:n.chat&&n.chat[n.chat.length-1].newMessageCount})]})}))]})}),(0,i.jsx)(h.Td,{children:"Super Admin"===localStorage.getItem("userRole")||"Admin"===localStorage.getItem("userRole")?e.client_id:e.client_id.substring(0,2)+"****@****.com"}),(0,i.jsx)(h.Td,{color:"green.600",fontWeight:"semibold",children:e.subject}),(0,i.jsx)(h.Td,{children:e.paid}),(0,i.jsx)(h.Td,{children:e.assignedExpert}),(0,i.jsx)(h.Td,{color:"red.600",fontWeight:"semibold",onClick:function(){return function(e,n){L(e),Q(n)}(!0,t)},children:e.expertDeadline}),(0,i.jsx)(h.Td,{color:"red.600",fontWeight:"semibold",children:e.deadline}),(0,i.jsx)(h.Td,{children:(0,i.jsx)(u.zx,{color:"red",onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie(t));case 1:case"end":return e.stop()}}),e)}))),children:"Remove Expert"})})]},t)}))})]}),!0===F?(0,i.jsx)(w.default,{showPopup:F,setShowPopup:L,expertdeadlineDate:G,setExpertdeadlineDate:V,index:H,assignments:k}):null,(0,i.jsx)("div",{className:"ShowSideClick dummy",children:k.map((function(e,n){return(0,i.jsx)(x.UQ,{defaultIndex:[0],allowMultiple:!0,display:{base:"block",sm:"none",md:"none"},children:(0,i.jsxs)(x.Qd,{children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(x.KF,{children:[(0,i.jsx)(l.xu,{flex:"1",textAlign:"left",children:(0,i.jsx)(h.iA,{children:(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Id"}),(0,i.jsx)(h.Td,{fontWeight:"semibold",children:(0,i.jsx)(l.rU,{href:"/admin/assignment_details/"+e.id,children:e.id})})]})})}),(0,i.jsx)(x.XE,{})]})}),(0,i.jsx)(x.Hk,{pb:0,children:(0,i.jsx)(h.iA,{variant:"simple",size:"md",children:(0,i.jsx)(h.p3,{className:"paddZero",children:(0,i.jsx)(h.Tr,{children:(0,i.jsxs)(h.iA,{bgColor:"gray.100",children:[(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Student Email"}),(0,i.jsx)(h.Td,{children:"Super Admin"===localStorage.getItem("userRole")||"Admin"===localStorage.getItem("userRole")?e.client_id:e.client_id.substring(0,2)+"****@****.com"})]}),(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Subject"}),(0,i.jsx)(h.Td,{color:"green.600",fontWeight:"semibold",children:e.subject})]}),(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Amount Paid"}),(0,i.jsx)(h.Td,{children:e.paid})]}),(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Expert"}),(0,i.jsx)(h.Td,{children:e.assignedExpert})]}),(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Expert Deadline"}),(0,i.jsx)(h.Td,{color:"red.600",fontWeight:"semibold",children:e.expertDeadline})]}),(0,i.jsxs)(h.Tr,{children:[(0,i.jsx)(h.Th,{children:"Deadline"}),(0,i.jsx)(h.Td,{color:"red.600",fontWeight:"semibold",children:e.deadline})]}),(0,i.jsx)(h.Tr,{children:(0,i.jsx)(h.Td,{children:(0,i.jsx)(u.zx,{color:"red",onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie(n));case 1:case"end":return e.stop()}}),e)}))),children:"Remove Expert"})})}),(0,i.jsx)(h.Tr,{children:(0,i.jsx)(h.Th,{children:(0,i.jsx)(u.zx,{leftIcon:(0,i.jsx)(c.ny,{}),onClick:y(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:case"end":return e.stop()}}),e)}))),children:"Refresh"})})})]})},n)})})})]})})}))})]})}},8765:function(e,n,t){t.r(n);var r=t(8520),s=t.n(r),i=t(5893),a=(t(7294),t(4612)),c=t(9669),o=t.n(c),l=t(8756);function d(e,n,t,r,s,i,a){try{var c=e[i](a),o=c.value}catch(l){return void t(l)}c.done?n(o):Promise.resolve(o).then(r,s)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function a(e){d(i,r,s,a,c,"next",e)}function c(e){d(i,r,s,a,c,"throw",e)}a(void 0)}))}}n.default=function(e){var n=e.showPopup,t=e.setShowPopup,r=e.expertdeadlineDate,c=e.setExpertdeadlineDate,d=e.index,h=e.assignments;function p(){return(p=u(s().mark((function e(){var i,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=localStorage.getItem("userToken"),a=r,c={headers:{Authorization:"Bearer ".concat(i)}},e.next=6,o().post(l.JW+"/assignment/update",{_id:h[d].id,expertDeadline:a},c);case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0+"error triggered");case 12:t(!n);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return(0,i.jsxs)("div",{className:"popup",style:{width:"250px",height:"170px",backgroundColor:" #f8f9fa",position:" absolute",borderRadius:"13px",left:"56%",top:" 28%",padding:"30px",boxShadow:"0 0 3px"},children:[(0,i.jsx)("div",{className:"showpic",onClick:function(){return t(!n)},style:{height:"19%",width:"11%",marginLeft:" 98%",marginTop:"-9%",cursor:"pointer"},children:(0,i.jsx)("img",{src:"https://img.icons8.com/emoji/48/000000/cross-mark-emoji.png"})}),(0,i.jsx)("label",{style:{fontWeight:"600",marginTop:"0%"},children:"Update Expert Deadline"}),(0,i.jsx)(a.II,{onChange:function(e){return c(e.target.value)},placeholder:"Select Date and Time",size:"md",type:"datetime-local"}),(0,i.jsx)("button",{onClick:function(){return function(){return p.apply(this,arguments)}()},style:{backgroundColor:"blue",height:"26%",width:"35%",borderRadius:"10px",color:"white",marginLeft:"33%",marginTop:"9%"},children:"Save"})]})}}}]);