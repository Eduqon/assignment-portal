(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6677],{2571:function(e,t,r){"use strict";r.d(t,{_:function(){return n}});class n extends Error{constructor(e){super(e),this.name="AbortError"}}},3186:function(e,t,r){"use strict";r.d(t,{A:function(){return gr}});var n={};r.r(n),r.d(n,{AddChatParticipantsRequest:function(){return ht},AddChatParticipantsResult:function(){return ft},ChatError:function(){return nt},ChatMessage:function(){return ct},ChatMessageContent:function(){return ut},ChatMessageReadReceipt:function(){return Je},ChatMessageReadReceiptsCollection:function(){return Ge},ChatMessagesCollection:function(){return at},ChatParticipant:function(){return lt},ChatParticipantsCollection:function(){return pt},ChatThreadItem:function(){return bt},ChatThreadProperties:function(){return gt},ChatThreadsItemCollection:function(){return vt},CommunicationErrorResponse:function(){return rt},CommunicationIdentifierModel:function(){return Ye},CommunicationUserIdentifierModel:function(){return Ze},CreateChatThreadRequest:function(){return mt},CreateChatThreadResult:function(){return yt},MicrosoftTeamsUserIdentifierModel:function(){return tt},PhoneNumberIdentifierModel:function(){return et},SendChatMessageRequest:function(){return ot},SendChatMessageResult:function(){return st},SendReadReceiptRequest:function(){return it},SendTypingNotificationRequest:function(){return Ct},UpdateChatMessageRequest:function(){return dt},UpdateChatThreadRequest:function(){return wt}});function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}Object.create;function o(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e){return this instanceof s?(this.v=e,this):new s(e)}function a(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof s?Promise.resolve(r.value.v).then(u,l):d(o[0][2],r)}catch(n){d(o[0][3],n)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function d(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}function c(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:s(e[n](t)),done:!1}:i?i(t):t}:i}}function u(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}Object.create;const l=e=>(e=>"string"===typeof e.communicationUserId)(e)?Object.assign(Object.assign({},e),{kind:"communicationUser"}):(e=>"string"===typeof e.phoneNumber)(e)?Object.assign(Object.assign({},e),{kind:"phoneNumber"}):(e=>"string"===typeof e.microsoftTeamsUserId)(e)?Object.assign(Object.assign({},e),{kind:"microsoftTeamsUser"}):Object.assign(Object.assign({},e),{kind:"unknown"}),d=e=>{const t=l(e);switch(t.kind){case"communicationUser":return t.communicationUserId;case"microsoftTeamsUser":{const{microsoftTeamsUserId:e,rawId:r,cloud:n,isAnonymous:i}=t;if(r)return r;if(i)return`8:teamsvisitor:${e}`;switch(n){case"dod":return`8:dod:${e}`;case"gcch":return`8:gcch:${e}`;case"public":return`8:orgid:${e}`}return`8:orgid:${e}`}case"phoneNumber":{const{phoneNumber:e,rawId:r}=t;return r||`4:${e}`}case"unknown":return t.id}},p=(e,t)=>{const r=Object.keys(e)[0],n=e[r];if(t in n)return n[t];throw new Error(`Property ${t} is required for identifier of type ${r}.`)},h=e=>{var t,r,n,i;const o=l(e);switch(o.kind){case"communicationUser":return{rawId:d(o),communicationUser:{id:o.communicationUserId}};case"phoneNumber":return{rawId:null!==(t=o.rawId)&&void 0!==t?t:d(o),phoneNumber:{value:o.phoneNumber}};case"microsoftTeamsUser":return{rawId:null!==(r=o.rawId)&&void 0!==r?r:d(o),microsoftTeamsUser:{userId:o.microsoftTeamsUserId,isAnonymous:null!==(n=o.isAnonymous)&&void 0!==n&&n,cloud:null!==(i=o.cloud)&&void 0!==i?i:"public"}};case"unknown":return{rawId:o.id};default:throw new Error(`Can't serialize an identifier with kind ${o.kind}`)}},f=e=>{var t;(e=>{const t=[];if(void 0!==e.communicationUser&&t.push("communicationUser"),void 0!==e.microsoftTeamsUser&&t.push("microsoftTeamsUser"),void 0!==e.phoneNumber&&t.push("phoneNumber"),t.length>1)throw new Error(`Only one of the properties in ${JSON.stringify(t)} should be present.`)})(e);const{communicationUser:r,microsoftTeamsUser:n,phoneNumber:i}=e,o=null!==(t=e.kind)&&void 0!==t?t:(e=>e.communicationUser?"communicationUser":e.phoneNumber?"phoneNumber":e.microsoftTeamsUser?"microsoftTeamsUser":"unknown")(e);return"communicationUser"===o&&r?{kind:"communicationUser",communicationUserId:p({communicationUser:r},"id")}:"phoneNumber"===o&&i?{kind:"phoneNumber",phoneNumber:p({phoneNumber:i},"value"),rawId:p({phoneNumber:e},"rawId")}:"microsoftTeamsUser"===o&&n?{kind:"microsoftTeamsUser",microsoftTeamsUserId:p({microsoftTeamsUser:n},"userId"),isAnonymous:p({microsoftTeamsUser:n},"isAnonymous"),cloud:p({microsoftTeamsUser:n},"cloud"),rawId:p({microsoftTeamsUser:e},"rawId")}:{kind:"unknown",id:p({unknown:e},"rawId")}},m=e=>{const{id:t}=e,r=i(e,["id"]);return Object.assign(Object.assign({},r),{communicationIdentifier:h(t)})},y=e=>{const{communicationIdentifier:t}=e,r=i(e,["communicationIdentifier"]);return Object.assign(Object.assign({},r),{id:f(t)})},g=e=>{const{participants:t,initiatorCommunicationIdentifier:r}=e,n=i(e,["participants","initiatorCommunicationIdentifier"]);let o=Object.assign({},n);if(r){const e=f(r);o=Object.assign(Object.assign({},o),{initiator:e})}return t&&(o=Object.assign(Object.assign({},o),{participants:null===t||void 0===t?void 0:t.map((e=>y(e)))})),o},v=e=>{const{content:t,senderCommunicationIdentifier:r}=e,n=i(e,["content","senderCommunicationIdentifier"]);let o=Object.assign({},n);if(t&&(o=Object.assign(Object.assign({},o),{content:g(t)})),r){const e=f(r);o=Object.assign(Object.assign({},o),{sender:e})}return o},b=e=>{const{createdByCommunicationIdentifier:t}=e,r=i(e,["createdByCommunicationIdentifier"]);return t?Object.assign(Object.assign({},r),{createdBy:f(t)}):Object.assign({},r)},w=e=>{const{senderCommunicationIdentifier:t}=e,r=i(e,["senderCommunicationIdentifier"]);return Object.assign(Object.assign({},r),{sender:f(t)})};function C(e){return e.toLowerCase()}class R{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(C(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(C(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(C(e))}delete(e){this._headersMap.delete(C(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const r of this._headersMap.values())t[r.name]=r.value;else for(const[r,n]of this._headersMap)t[r]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function T(e){return new R(e)}var E=r(5934);class S{constructor(e){var t,r,n,i,o,s,a;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:T(),this.method=null!==(r=e.method)&&void 0!==r?r:"GET",this.timeout=null!==(n=e.timeout)&&void 0!==n?n:0,this.formData=e.formData,this.disableKeepAlive=null!==(i=e.disableKeepAlive)&&void 0!==i&&i,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,E.Z)(),this.allowInsecureConnection=null!==(s=e.allowInsecureConnection)&&void 0!==s&&s,this.enableBrowserStreams=null!==(a=e.enableBrowserStreams)&&void 0!==a&&a}}const x="$",P="_";function O(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function N(e){if(O(e)){const t="string"===typeof e.name,r="string"===typeof e.message;return t&&r}return!1}function A(e){if(N(e))return e.message;{let r;try{r="object"===typeof e&&e?JSON.stringify(e):String(e)}catch(t){r="[unable to stringify input]"}return`Unknown error ${r}`}}const M={},I="REDACTED",q=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],_=["api-version"];class k{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=q.concat(e),t=_.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if(r instanceof Error)return Object.assign(Object.assign({},r),{name:r.name,message:r.message});if("headers"===e)return this.sanitizeHeaders(r);if("url"===e)return this.sanitizeUrl(r);if("query"===e)return this.sanitizeQuery(r);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(r)||O(r)){if(t.has(r))return"[Circular]";t.add(r)}return r}}),2)}sanitizeHeaders(e){const t={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?t[r]=e[r]:t[r]=I;return t}sanitizeQuery(e){if("object"!==typeof e||null===e)return e;const t={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?t[r]=e[r]:t[r]=I;return t}sanitizeUrl(e){if("string"!==typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[r]of t.searchParams)this.allowedQueryParameters.has(r.toLowerCase())||t.searchParams.set(r,I);return t.toString()}}const z=new k;class j extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,j.prototype)}[M](){return`RestError: ${this.message} \n ${z.sanitize(this)}`}}function $(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function U(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}j.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",j.PARSE_ERROR="PARSE_ERROR";const D=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;const L=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function B(e,t){var r,n;const i=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},i),{body:e.parsedBody});const o=t&&t.bodyMapper,s=Boolean(null===o||void 0===o?void 0:o.nullable),a=null===o||void 0===o?void 0:o.type.name;if("Stream"===a)return Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const c="Composite"===a&&o.type.modelProperties||{},u=Object.keys(c).some((e=>""===c[e].serializedName));if("Sequence"===a||u){const t=null!==(r=e.parsedBody)&&void 0!==r?r:[];for(const r of Object.keys(c))c[r].serializedName&&(t[r]=null===(n=e.parsedBody)||void 0===n?void 0:n[r]);if(i)for(const e of Object.keys(i))t[e]=i[e];return!s||e.parsedBody||i||0!==Object.getOwnPropertyNames(c).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:i,hasNullableType:s,shouldWrapBody:(l=e.parsedBody,d=a,"Composite"!==d&&"Dictionary"!==d&&("string"===typeof l||"number"===typeof l||"boolean"===typeof l||null!==(null===d||void 0===d?void 0:d.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||void 0===l||null===l))});var l,d}class H{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,r){const n=(e,n)=>{throw new Error(`"${r}" with value "${t}" should satisfy the constraint "${e}": ${n}.`)};if(e.constraints&&void 0!==t&&null!==t){const{ExclusiveMaximum:r,ExclusiveMinimum:i,InclusiveMaximum:o,InclusiveMinimum:s,MaxItems:a,MaxLength:c,MinItems:u,MinLength:l,MultipleOf:d,Pattern:p,UniqueItems:h}=e.constraints;if(void 0!==r&&t>=r&&n("ExclusiveMaximum",r),void 0!==i&&t<=i&&n("ExclusiveMinimum",i),void 0!==o&&t>o&&n("InclusiveMaximum",o),void 0!==s&&t<s&&n("InclusiveMinimum",s),void 0!==a&&t.length>a&&n("MaxItems",a),void 0!==c&&t.length>c&&n("MaxLength",c),void 0!==u&&t.length<u&&n("MinItems",u),void 0!==l&&t.length<l&&n("MinLength",l),void 0!==d&&t%d!==0&&n("MultipleOf",d),p){const e="string"===typeof p?new RegExp(p):p;"string"===typeof t&&null!==t.match(e)||n("Pattern",p)}h&&t.some(((e,t,r)=>r.indexOf(e)!==t))&&n("UniqueItems",h)}}serialize(e,t,r,n={xml:{}}){var i,o,s;const a={xml:{rootName:null!==(i=n.xml.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=n.xml.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(s=n.xml.xmlCharKey)&&void 0!==s?s:P}};let c={};const u=e.type.name;r||(r=e.serializedName),null!==u.match(/^Sequence$/i)&&(c=[]),e.isConstant&&(t=e.defaultValue);const{required:l,nullable:d}=e;if(l&&d&&void 0===t)throw new Error(`${r} cannot be undefined.`);if(l&&!d&&(void 0===t||null===t))throw new Error(`${r} cannot be null or undefined.`);if(!l&&!1===d&&null===t)throw new Error(`${r} cannot be null.`);if(void 0===t||null===t)c=t;else if(null!==u.match(/^any$/i))c=t;else if(null!==u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))c=function(e,t,r){if(null!==r&&void 0!==r)if(null!==e.match(/^Number$/i)){if("number"!==typeof r)throw new Error(`${t} with value ${r} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!==typeof r.valueOf())throw new Error(`${t} with value "${r}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!==typeof r.valueOf()||(n=r,!L.test(n)))throw new Error(`${t} with value "${r}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!==typeof r)throw new Error(`${t} with value ${r} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof r;if("string"!==e&&"function"!==typeof r.pipe&&!(r instanceof ArrayBuffer)&&!ArrayBuffer.isView(r)&&("function"!==typeof Blob&&"object"!==typeof Blob||!(r instanceof Blob))&&"function"!==e)throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, NodeJS.ReadableStream, or () => NodeJS.ReadableStream.`)}var n;return r}(u,r,t);else if(null!==u.match(/^Enum$/i)){c=function(e,t,r){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"===typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r)))throw new Error(`${r} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return r}(r,e.type.allowedValues,t)}else null!==u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?c=function(e,t,r){if(void 0!==t&&null!==t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(!e)return;"string"===typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return D.test(e)}(t))throw new Error(`${r} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(u,t,r):null!==u.match(/^ByteArray$/i)?c=function(e,t){if(void 0!==t&&null!==t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=$(t)}return t}(r,t):null!==u.match(/^Base64Url$/i)?c=function(e,t){if(void 0!==t&&null!==t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let r=e.length;for(;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}($(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(r,t):null!==u.match(/^Sequence$/i)?c=function(e,t,r,n,i,o){var s;if(!Array.isArray(r))throw new Error(`${n} must be of type Array.`);let a=t.type.element;if(!a||"object"!==typeof a)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);"Composite"===a.type.name&&a.type.className&&(a=null!==(s=e.modelMappers[a.type.className])&&void 0!==s?s:a);const c=[];for(let u=0;u<r.length;u++){const t=e.serialize(a,r[u],n,o);if(i&&a.xmlNamespace){const e=a.xmlNamespacePrefix?`xmlns:${a.xmlNamespacePrefix}`:"xmlns";"Composite"===a.type.name?(c[u]=Object.assign({},t),c[u][x]={[e]:a.xmlNamespace}):(c[u]={},c[u][o.xml.xmlCharKey]=t,c[u][x]={[e]:a.xmlNamespace})}else c[u]=t}return c}(this,e,t,r,Boolean(this.isXML),a):null!==u.match(/^Dictionary$/i)?c=function(e,t,r,n,i,o){if("object"!==typeof r)throw new Error(`${n} must be of type object.`);const s=t.type.value;if(!s||"object"!==typeof s)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);const a={};for(const c of Object.keys(r)){const t=e.serialize(s,r[c],n,o);a[c]=Q(s,t,i,o)}if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",r=a;return r[x]={[e]:t.xmlNamespace},r}return a}(this,e,t,r,Boolean(this.isXML),a):null!==u.match(/^Composite$/i)&&(c=function(e,t,r,n,i,o){J(e,t)&&(t=G(e,t,r,"clientName"));if(void 0!==r&&null!==r){const s={},a=K(e,t,n);for(const u of Object.keys(a)){const c=a[u];if(c.readOnly)continue;let l,d=s;if(e.isXML)l=c.xmlIsWrapped?c.xmlName:c.xmlElementName||c.xmlName;else{const e=V(c.serializedName);l=e.pop();for(const t of e){const e=d[t];void 0!==e&&null!==e||(void 0===r[u]||null===r[u])&&void 0===c.defaultValue||(d[t]={}),d=d[t]}}if(void 0!==d&&null!==d){if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";d[x]=Object.assign(Object.assign({},d[x]),{[e]:t.xmlNamespace})}const s=""!==c.serializedName?n+"."+c.serializedName:n;let a=r[u];const p=J(e,t);!p||p.clientName!==u||void 0!==a&&null!==a||(a=t.serializedName);const h=e.serialize(c,a,s,o);if(void 0!==h&&void 0!==l&&null!==l){const e=Q(c,h,i,o);i&&c.xmlIsAttribute?(d[x]=d[x]||{},d[x][l]=h):i&&c.xmlIsWrapped?d[l]={[c.xmlElementName]:e}:d[l]=e}}}const c=function(e,t,r){const n=t.type.additionalProperties;if(!n&&t.type.className){const n=W(e,t,r);return null===n||void 0===n?void 0:n.type.additionalProperties}return n}(e,t,n);if(c){const t=Object.keys(a);for(const i in r){t.every((e=>e!==i))&&(s[i]=e.serialize(c,r[i],n+'["'+i+'"]',o))}}return s}return r}(this,e,t,r,Boolean(this.isXML),a));return c}deserialize(e,t,r,n={xml:{}}){var i,o,s,a;const c={xml:{rootName:null!==(i=n.xml.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=n.xml.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(s=n.xml.xmlCharKey)&&void 0!==s?s:P},ignoreUnknownProperties:null!==(a=n.ignoreUnknownProperties)&&void 0!==a&&a};if(void 0===t||null===t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let u;const l=e.type.name;if(r||(r=e.serializedName),null!==l.match(/^Composite$/i))u=function(e,t,r,n,i){var o,s;const a=null!==(o=i.xml.xmlCharKey)&&void 0!==o?o:P;J(e,t)&&(t=G(e,t,r,"serializedName"));const c=K(e,t,n);let u={};const l=[];for(const p of Object.keys(c)){const o=c[p],d=V(c[p].serializedName);l.push(d[0]);const{serializedName:h,xmlName:f,xmlElementName:m}=o;let y=n;""!==h&&void 0!==h&&(y=n+"."+h);const g=o.headerCollectionPrefix;if(g){const t={};for(const n of Object.keys(r))n.startsWith(g)&&(t[n.substring(g.length)]=e.deserialize(o.type.value,r[n],y,i)),l.push(n);u[p]=t}else if(e.isXML)if(o.xmlIsAttribute&&r[x])u[p]=e.deserialize(o,r[x][f],y,i);else if(o.xmlIsMsText)void 0!==r[a]?u[p]=r[a]:"string"===typeof r&&(u[p]=r);else{const t=m||f||h;if(o.xmlIsWrapped){const t=r[f],n=null!==(s=null===t||void 0===t?void 0:t[m])&&void 0!==s?s:[];u[p]=e.deserialize(o,n,y,i),l.push(f)}else{const n=r[t];u[p]=e.deserialize(o,n,y,i),l.push(t)}}else{let n,s=r;for(const e of d){if(!s)break;s=s[e]}n=s;const a=t.type.polymorphicDiscriminator;let l;if(!a||p!==a.clientName||void 0!==n&&null!==n||(n=t.serializedName),Array.isArray(r[p])&&""===c[p].serializedName){n=r[p];const t=e.deserialize(o,n,y,i);for(const[e,r]of Object.entries(u))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=r);u=t}else void 0===n&&void 0===o.defaultValue||(l=e.deserialize(o,n,y,i),u[p]=l)}}const d=t.type.additionalProperties;if(d){const t=e=>{for(const t in c){if(V(c[t].serializedName)[0]===e)return!1}return!0};for(const o in r)t(o)&&(u[o]=e.deserialize(d,r[o],n+'["'+o+'"]',i))}else if(r&&!i.ignoreUnknownProperties)for(const p of Object.keys(r))void 0!==u[p]||l.includes(p)||X(p,i)||(u[p]=r[p]);return u}(this,e,t,r,c);else{if(this.isXML){const e=c.xml.xmlCharKey;void 0!==t[x]&&void 0!==t[e]&&(t=t[e])}null!==l.match(/^Number$/i)?(u=parseFloat(t),isNaN(u)&&(u=t)):null!==l.match(/^Boolean$/i)?u="true"===t||"false"!==t&&t:null!==l.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?u=t:null!==l.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?u=new Date(t):null!==l.match(/^UnixTime$/i)?u=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==l.match(/^ByteArray$/i)?u=U(t):null!==l.match(/^Base64Url$/i)?u=function(e){if(!e)return;if(e&&"string"!==typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return U(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==l.match(/^Sequence$/i)?u=function(e,t,r,n,i){var o;let s=t.type.element;if(!s||"object"!==typeof s)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(r){Array.isArray(r)||(r=[r]),"Composite"===s.type.name&&s.type.className&&(s=null!==(o=e.modelMappers[s.type.className])&&void 0!==o?o:s);const t=[];for(let o=0;o<r.length;o++)t[o]=e.deserialize(s,r[o],`${n}[${o}]`,i);return t}return r}(this,e,t,r,c):null!==l.match(/^Dictionary$/i)&&(u=function(e,t,r,n,i){const o=t.type.value;if(!o||"object"!==typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(r){const t={};for(const s of Object.keys(r))t[s]=e.deserialize(o,r[s],n,i);return t}return r}(this,e,t,r,c))}return e.isConstant&&(u=e.defaultValue),u}}function F(e={},t=!1){return new H(e,t)}function V(e){const t=[];let r="";if(e){const n=e.split(".");for(const e of n)"\\"===e.charAt(e.length-1)?r+=e.substr(0,e.length-1)+".":(r+=e,t.push(r),r="")}return t}function W(e,t,r){const n=t.type.className;if(!n)throw new Error(`Class name for model "${r}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[n]}function K(e,t,r){let n=t.type.modelProperties;if(!n){const i=W(e,t,r);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(n=null===i||void 0===i?void 0:i.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${t.type.className}" for object "${r}".`)}return n}function Q(e,t,r,n){if(!r||!e.xmlNamespace)return t;const i={[e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[x])return t;{const e=Object.assign({},t);return e[x]=i,e}}const o={};return o[n.xml.xmlCharKey]=t,o[x]=i,o}function X(e,t){return[x,t.xml.xmlCharKey].includes(e)}function G(e,t,r,n){var i;const o=J(e,t);if(o){let s=o[n];if(s){"serializedName"===n&&(s=s.replace(/\\/gi,""));const o=r[s],a=null!==(i=t.type.uberParent)&&void 0!==i?i:t.type.className;if("string"===typeof o&&a){const r=function(e,t,r){const n=[r];for(;n.length;){const r=n.shift(),i=t===r?t:r+"."+t;if(Object.prototype.hasOwnProperty.call(e,i))return e[i];for(const[t,o]of Object.entries(e))t.startsWith(r+".")&&o.type.uberParent===r&&o.type.className&&n.push(o.type.className)}}(e.modelMappers.discriminators,o,a);r&&(t=r)}}}return t}function J(e,t){return t.type.polymorphicDiscriminator||Y(e,t.type.uberParent)||Y(e,t.type.className)}function Y(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const Z="Sequence",ee="String",te="Stream";function re(e,t,r){let n=t.parameterPath;const i=t.mapper;let o;if("string"===typeof n&&(n=[n]),Array.isArray(n)){if(n.length>0)if(i.isConstant)o=i.defaultValue;else{let t=ne(e,n);!t.propertyFound&&r&&(t=ne(r,n));let s=!1;t.propertyFound||(s=i.required||"options"===n[0]&&2===n.length),o=s?i.defaultValue:t.propertyValue}}else{i.required&&(o={});for(const t in n){const s=i.type.modelProperties[t],a=re(e,{parameterPath:n[t],mapper:s},r);void 0!==a&&(o||(o={}),o[t]=a)}}return o}function ne(e,t){const r={propertyFound:!1};let n=0;for(;n<t.length;++n){const r=t[n];if(!e||!(r in e))break;e=e[r]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}const ie=new WeakMap,oe=Symbol.for("@azure/core-client original request");function se(e){if(function(e){return oe in e}(e))return se(e[oe]);let t=ie.get(e);return t||(t={},ie.set(e,t)),t}const ae=["application/json","text/json"],ce=["application/xml","application/atom+xml"];function ue(e={}){var t,r,n,i,o,s,a;const c=null!==(r=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==r?r:ae,u=null!==(i=null===(n=e.expectedContentTypes)||void 0===n?void 0:n.xml)&&void 0!==i?i:ce,l=e.parseXML,d=e.serializerOptions,p={xml:{rootName:null!==(o=null===d||void 0===d?void 0:d.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(s=null===d||void 0===d?void 0:d.xml.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(a=null===d||void 0===d?void 0:d.xml.xmlCharKey)&&void 0!==a?a:P}};return{name:"deserializationPolicy",async sendRequest(e,t){const r=await t(e);return async function(e,t,r,n,i){const o=await async function(e,t,r,n,i){var o;if(!(null===(o=r.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(r.status))&&r.bodyAsText){const o=r.bodyAsText,a=r.headers.get("Content-Type")||"",c=a?a.split(";").map((e=>e.toLowerCase())):[];try{if(0===c.length||c.some((t=>-1!==e.indexOf(t))))return r.parsedBody=JSON.parse(o),r;if(c.some((e=>-1!==t.indexOf(e)))){if(!i)throw new Error("Parsing XML not supported.");const e=await i(o,n.xml);return r.parsedBody=e,r}}catch(s){const e=`Error "${s}" occurred while parsing the response body - ${r.bodyAsText}.`,t=s.code||j.PARSE_ERROR;throw new j(e,{code:t,statusCode:r.status,request:r.request,response:r})}}return r}(e,t,r,n,i);if(!function(e){const t=se(e.request),r=null===t||void 0===t?void 0:t.shouldDeserialize;let n;n=void 0===r||("boolean"===typeof r?r:r(e));return n}(o))return o;const s=se(o.request),a=null===s||void 0===s?void 0:s.operationSpec;if(!a||!a.responses)return o;const c=function(e){let t;const r=se(e.request),n=null===r||void 0===r?void 0:r.operationSpec;n&&(t=(null===r||void 0===r?void 0:r.operationResponseGetter)?null===r||void 0===r?void 0:r.operationResponseGetter(n,e):n.responses[e.status]);return t}(o),{error:u,shouldReturnResponse:l}=function(e,t,r,n){var i;const o=200<=e.status&&e.status<300;if(function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?o:r){if(!r)return{error:null,shouldReturnResponse:!1};if(!r.isError)return{error:null,shouldReturnResponse:!1}}const s=null!==r&&void 0!==r?r:t.responses.default,a=(null===(i=e.request.streamResponseStatusCodes)||void 0===i?void 0:i.has(e.status))?`Unexpected status code: ${e.status}`:e.bodyAsText,c=new j(a,{statusCode:e.status,request:e.request,response:e});if(!s)throw c;const u=s.bodyMapper,l=s.headersMapper;try{if(e.parsedBody){const r=e.parsedBody;let i;if(u){let e=r;if(t.isXML&&u.type.name===Z){e=[];const t=u.xmlElementName;"object"===typeof r&&t&&(e=r[t])}i=t.serializer.deserialize(u,e,"error.response.parsedBody",n)}const o=r.error||i||r;c.code=o.code,o.message&&(c.message=o.message),u&&(c.response.parsedBody=i)}e.headers&&l&&(c.response.parsedHeaders=t.serializer.deserialize(l,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(d){c.message=`Error "${d.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:c,shouldReturnResponse:!1}}(o,a,c,n);if(u)throw u;if(l)return o;if(c){if(c.bodyMapper){let e=o.parsedBody;a.isXML&&c.bodyMapper.type.name===Z&&(e="object"===typeof e?e[c.bodyMapper.xmlElementName]:[]);try{o.parsedBody=a.serializer.deserialize(c.bodyMapper,e,"operationRes.parsedBody",n)}catch(d){throw new j(`Error ${d} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===a.httpMethod&&(o.parsedBody=r.status>=200&&r.status<300);c.headersMapper&&(o.parsedHeaders=a.serializer.deserialize(c.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}(c,u,r,p,l)}}}var le=r(8417);const de=(0,le.YR)("core-rest-pipeline");const pe=new Set(["Deserialize","Serialize","Retry","Sign"]);class he{constructor(e){var t;this._policies=[],this._policies=null!==(t=null===e||void 0===e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!pe.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!pe.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((r=>!(e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase)||(t.push(r.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>r=>t.sendRequest(r,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new he(this._policies)}static create(){return new he}orderPolicies(){const e=[],t=new Map;function r(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const n=r("Serialize"),i=r("None"),o=r("Deserialize"),s=r("Retry"),a=r("Sign"),c=[n,i,o,s,a];function u(e){return"Retry"===e?s:"Serialize"===e?n:"Deserialize"===e?o:"Sign"===e?a:i}for(const h of this._policies){const e=h.policy,r=h.options,n=e.name;if(t.has(n))throw new Error("Duplicate policy names not allowed in pipeline");const i={policy:e,dependsOn:new Set,dependants:new Set};r.afterPhase&&(i.afterPhase=u(r.afterPhase),i.afterPhase.hasAfterPolicies=!0),t.set(n,i);u(r.phase).policies.add(i)}for(const h of this._policies){const{policy:e,options:r}=h,n=e.name,i=t.get(n);if(!i)throw new Error(`Missing node for policy ${n}`);if(r.afterPolicies)for(const o of r.afterPolicies){const e=t.get(o);e&&(i.dependsOn.add(e),e.dependants.add(i))}if(r.beforePolicies)for(const o of r.beforePolicies){const e=t.get(o);e&&(e.dependsOn.add(i),i.dependants.add(e))}}function l(r){r.hasRun=!0;for(const n of r.policies)if((!n.afterPhase||n.afterPhase.hasRun&&!n.afterPhase.policies.size)&&0===n.dependsOn.size){e.push(n.policy);for(const e of n.dependants)e.dependsOn.delete(n);t.delete(n.policy.name),r.policies.delete(n)}}function d(){for(const e of c){if(l(e),e.policies.size>0&&e!==i)return void(i.hasRun||l(i));e.hasAfterPolicies&&l(i)}}let p=0;for(;t.size>0;){p++;const t=e.length;if(d(),e.length<=t&&p>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}const fe="1.10.1";function me(e){const t=new Map;t.set("core-rest-pipeline",fe),function(e){const t=self.navigator;e.set("OS",(t.oscpu||t.platform).replace(" ",""))}(t);const r=function(e){const t=[];for(const[r,n]of e){const e=n?`${r}/${n}`:r;t.push(e)}return t.join(" ")}(t);return e?`${e} ${r}`:r}const ye="x-ms-useragent";new Error("decompressResponsePolicy is not supported in browser environment");var ge=r(2571);function ve(e,t,r){return new Promise(((n,i)=>{let o,s;const a=()=>i(new ge._((null===r||void 0===r?void 0:r.abortErrorMsg)?null===r||void 0===r?void 0:r.abortErrorMsg:"The operation was aborted.")),c=()=>{(null===r||void 0===r?void 0:r.abortSignal)&&s&&r.abortSignal.removeEventListener("abort",s)};if(s=()=>(o&&clearTimeout(o),c(),a()),(null===r||void 0===r?void 0:r.abortSignal)&&r.abortSignal.aborted)return a();o=setTimeout((()=>{c(),n(t)}),e),(null===r||void 0===r?void 0:r.abortSignal)&&r.abortSignal.addEventListener("abort",s)}))}function be(e,t){const r=e.headers.get(t);if(!r)return;const n=Number(r);return Number.isNaN(n)?void 0:n}const we="Retry-After",Ce=["retry-after-ms","x-ms-retry-after-ms",we];function Re(e){if(e&&[429,503].includes(e.status))try{for(const n of Ce){const t=be(e,n);if(0===t||t){return t*(n===we?1e3:1)}}const t=e.headers.get(we);if(!t)return;const r=Date.parse(t)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch(t){return}}function Te(e={}){var t,r;const n=null!==(t=e.retryDelayInMs)&&void 0!==t?t:1e3,i=null!==(r=e.maxRetryDelayInMs)&&void 0!==r?r:64e3;let o=n;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:r,responseError:n}){const s=function(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code}(n),a=s&&e.ignoreSystemErrors,c=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(r),u=c&&e.ignoreHttpStatusCodes;if(r&&(function(e){return Number.isFinite(Re(e))}(r)||!c)||u||a)return{skipStrategy:!0};if(n&&!s&&!c)return{errorToThrow:n};const l=o*Math.pow(2,t),d=Math.min(i,l);var p,h;return o=d/2+(p=0,h=d/2,p=Math.ceil(p),h=Math.floor(h),Math.floor(Math.random()*(h-p+1))+p),{retryAfterInMs:o}}}}const Ee=(0,le.YR)("core-rest-pipeline retryPolicy");function Se(e,t={maxRetries:3}){const r=t.logger||Ee;return{name:"retryPolicy",async sendRequest(n,i){var o,s;let a,c,u=-1;e:for(;;){u+=1,a=void 0,c=void 0;try{r.info(`Retry ${u}: Attempting to send request`,n.requestId),a=await i(n),r.info(`Retry ${u}: Received a response from request`,n.requestId)}catch(l){if(r.error(`Retry ${u}: Received an error from request`,n.requestId),c=l,!l||"RestError"!==c.name)throw l;a=c.response}if(null===(o=n.abortSignal)||void 0===o?void 0:o.aborted){r.error(`Retry ${u}: Request aborted.`);throw new ge._}if(u>=(null!==(s=t.maxRetries)&&void 0!==s?s:3)){if(r.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${u}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||Ee;e.info(`Retry ${u}: Processing retry strategy ${t.name}.`);const r=t.retry({retryCount:u,response:a,responseError:c});if(r.skipStrategy){e.info(`Retry ${u}: Skipped.`);continue t}const{errorToThrow:i,retryAfterInMs:o,redirectTo:s}=r;if(i)throw e.error(`Retry ${u}: Retry strategy ${t.name} throws error:`,i),i;if(o||0===o){e.info(`Retry ${u}: Retry strategy ${t.name} retries after ${o}`),await ve(o,void 0,{abortSignal:n.abortSignal});continue e}if(s){e.info(`Retry ${u}: Retry strategy ${t.name} redirects to ${s}`),n.url=s;continue e}}if(c)throw r.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return r.info("None of the retry strategies could work with the received response. Returning it."),a}}}}new Error("proxyPolicy is not supported in browser environment");const xe={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Pe(e={}){let t=new Oe(e.parentContext);return e.span&&(t=t.setValue(xe.span,e.span)),e.namespace&&(t=t.setValue(xe.namespace,e.namespace)),t}class Oe{constructor(e){this._contextMap=e instanceof Oe?new Map(e._contextMap):new Map}setValue(e,t){const r=new Oe(this);return r._contextMap.set(e,t),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new Oe(this);return t._contextMap.delete(e),t}}let Ne;function Ae(){return Ne||(Ne={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Pe({parentContext:t.tracingContext})}),withContext:(e,t,...r)=>t(...r)}),Ne}function Me(e){const{namespace:t,packageName:r,packageVersion:n}=e;function i(e,i,o){var s;const a=Ae().startSpan(e,Object.assign(Object.assign({},o),{packageName:r,packageVersion:n,tracingContext:null===(s=null===i||void 0===i?void 0:i.tracingOptions)||void 0===s?void 0:s.tracingContext}));let c=a.tracingContext;const u=a.span;c.getValue(xe.namespace)||(c=c.setValue(xe.namespace,t)),u.setAttribute("az.namespace",c.getValue(xe.namespace));return{span:u,updatedOptions:Object.assign({},i,{tracingOptions:Object.assign(Object.assign({},null===i||void 0===i?void 0:i.tracingOptions),{tracingContext:c})})}}function o(e,t,...r){return Ae().withContext(e,t,...r)}return{startSpan:i,withSpan:async function(e,t,r,n){const{span:s,updatedOptions:a}=i(e,t,n);try{const e=await o(a.tracingOptions.tracingContext,(()=>Promise.resolve(r(a,s))));return s.setStatus({status:"success"}),e}catch(c){throw s.setStatus({status:"error",error:c}),c}finally{s.end()}},withContext:o,parseTraceparentHeader:function(e){return Ae().parseTraceparentHeader(e)},createRequestHeaders:function(e){return Ae().createRequestHeaders(e)}}}function Ie(e={}){const t=me(e.userAgentPrefix),r=function(){try{return Me({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:fe})}catch(e){return void de.warning(`Error when creating the TracingClient: ${A(e)}`)}}();return{name:"tracingPolicy",async sendRequest(e,n){var i,o;if(!r||!(null===(i=e.tracingOptions)||void 0===i?void 0:i.tracingContext))return n(e);const{span:s,tracingContext:a}=null!==(o=function(e,t,r){try{const{span:n,updatedOptions:i}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!n.isRecording())return void n.end();r&&n.setAttribute("http.user_agent",r);const o=e.createRequestHeaders(i.tracingOptions.tracingContext);for(const[e,r]of Object.entries(o))t.headers.set(e,r);return{span:n,tracingContext:i.tracingOptions.tracingContext}}catch(n){return void de.warning(`Skipping creating a tracing span due to an error: ${A(n)}`)}}(r,e,t))&&void 0!==o?o:{};if(!s||!a)return n(e);try{const t=await r.withContext(a,n,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const r=t.headers.get("x-ms-request-id");r&&e.setAttribute("serviceRequestId",r),e.setStatus({status:"success"}),e.end()}catch(r){de.warning(`Skipping tracing span processing due to an error: ${A(r)}`)}}(s,t),t}catch(c){throw function(e,t){try{e.setStatus({status:"error",error:N(t)?t:void 0}),((r=t)instanceof j||N(r)&&"RestError"===r.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(r){de.warning(`Skipping tracing span processing due to an error: ${A(r)}`)}var r}(s,c),c}}}}function qe(e){const t=he.create();return t.addPolicy({name:"formDataPolicy",async sendRequest(e,t){if(e.formData){const t=e.formData,r=new FormData;for(const e of Object.keys(t)){const n=t[e];if(Array.isArray(n))for(const t of n)r.append(e,t);else r.append(e,n)}e.body=r,e.formData=void 0;const n=e.headers.get("Content-Type");n&&-1!==n.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(r).toString():n&&-1!==n.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}}),t.addPolicy(function(e={}){const t=me(e.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(e,r)=>(e.headers.has(ye)||e.headers.set(ye,t),r(e))}}(e.userAgentOptions)),t.addPolicy(function(e="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(t,r)=>(t.headers.has(e)||t.headers.set(e,t.requestId),r(t))}}()),t.addPolicy(function(e={}){var t;return{name:"defaultRetryPolicy",sendRequest:Se([{name:"throttlingRetryStrategy",retry({response:e}){const t=Re(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},Te(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3}).sendRequest}}(e.retryOptions),{phase:"Retry"}),t.addPolicy(Ie(e.userAgentOptions),{afterPhase:"Retry"}),t.addPolicy(function(e={}){var t;const r=null!==(t=e.logger)&&void 0!==t?t:de.info,n=new k({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,t){if(!r.enabled)return t(e);r(`Request: ${n.sanitize(e)}`);const i=await t(e);return r(`Response status code: ${i.status}`),r(`Headers: ${n.sanitize(i.headers)}`),i}}}(e.loggingOptions),{afterPhase:"Sign"}),t}const _e={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function ke(e,t){let r,n=null,i=null;const o=Object.assign(Object.assign({},_e),t),s={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!s.isRefreshing&&(null!==(e=null===i||void 0===i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function a(t,a){var c;if(!s.isRefreshing){n=async function(e,t,r){async function n(){if(!(Date.now()<r)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(c){return null}}let i=await n();for(;null===i;)await ve(t),i=await n();return i}((()=>e.getToken(t,a)),o.retryIntervalInMs,null!==(c=null===i||void 0===i?void 0:i.expiresOnTimestamp)&&void 0!==c?c:Date.now()).then((e=>(n=null,i=e,r=a.tenantId,i))).catch((e=>{throw n=null,i=null,r=void 0,e}))}return n}return async(e,t)=>r!==t.tenantId||Boolean(t.claims)||s.mustRefresh?a(e,t):(s.shouldRefresh&&a(e,t),i)}async function ze(e){const{scopes:t,getAccessToken:r,request:n}=e,i={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions},o=await r(t,i);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function je(e){var t;const{credential:r,scopes:n,challengeCallbacks:i}=e,o=e.logger||de,s=Object.assign({authorizeRequest:null!==(t=null===i||void 0===i?void 0:i.authorizeRequest)&&void 0!==t?t:ze,authorizeRequestOnChallenge:null===i||void 0===i?void 0:i.authorizeRequestOnChallenge},i),a=r?ke(r):()=>Promise.resolve(null);return{name:"bearerTokenAuthenticationPolicy",async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let r,i;await s.authorizeRequest({scopes:Array.isArray(n)?n:[n],request:e,getAccessToken:a,logger:o});try{r=await t(e)}catch(c){i=c,r=c.response}if(s.authorizeRequestOnChallenge&&401===(null===r||void 0===r?void 0:r.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(r)){if(await s.authorizeRequestOnChallenge({scopes:Array.isArray(n)?n:[n],request:e,response:r,getAccessToken:a,logger:o}))return t(e)}if(i)throw i;return r}}}function $e(e){const{parameterPath:t,mapper:r}=e;let n;return n="string"===typeof t?t:Array.isArray(t)?t.join("."):r.serializedName,n}function Ue(e={}){const t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,r){const n=se(e),i=null===n||void 0===n?void 0:n.operationSpec,o=null===n||void 0===n?void 0:n.operationArguments;return i&&o&&(function(e,t,r){var n,i;if(r.headerParameters)for(const s of r.headerParameters){let n=re(t,s);if(null!==n&&void 0!==n||s.mapper.required){n=r.serializer.serialize(s.mapper,n,$e(s));const t=s.mapper.headerCollectionPrefix;if(t)for(const r of Object.keys(n))e.headers.set(t+r,n[r]);else e.headers.set(s.mapper.serializedName||$e(s),n)}}const o=null===(i=null===(n=t.options)||void 0===n?void 0:n.requestOptions)||void 0===i?void 0:i.customHeaders;if(o)for(const s of Object.keys(o))e.headers.set(s,o[s])}(e,o,i),function(e,t,r,n=function(){throw new Error("XML serialization unsupported!")}){var i,o,s,a,c;const u=null===(i=t.options)||void 0===i?void 0:i.serializerOptions,l={xml:{rootName:null!==(o=null===u||void 0===u?void 0:u.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(s=null===u||void 0===u?void 0:u.xml.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(a=null===u||void 0===u?void 0:u.xml.xmlCharKey)&&void 0!==a?a:P}},d=l.xml.xmlCharKey;if(r.requestBody&&r.requestBody.mapper){e.body=re(t,r.requestBody);const i=r.requestBody.mapper,{required:o,serializedName:s,xmlName:a,xmlElementName:u,xmlNamespace:h,xmlNamespacePrefix:f,nullable:m}=i,y=i.type.name;try{if(void 0!==e.body&&null!==e.body||m&&null===e.body||o){const t=$e(r.requestBody);e.body=r.serializer.serialize(i,e.body,t,l);const o=y===te;if(r.isXML){const t=f?`xmlns:${f}`:"xmlns",r=function(e,t,r,n,i){if(e&&!["Composite","Sequence","Dictionary"].includes(r)){const r={};return r[i.xml.xmlCharKey]=n,r[x]={[t]:e},r}return n}(h,t,y,e.body,l);y===Z?e.body=n(function(e,t,r,n){Array.isArray(e)||(e=[e]);if(!r||!n)return{[t]:e};const i={[t]:e};return i[x]={[r]:n},i}(r,u||a||s,t,h),{rootName:a||s,xmlCharKey:d}):o||(e.body=n(r,{rootName:a||s,xmlCharKey:d}))}else{if(y===ee&&((null===(c=r.contentType)||void 0===c?void 0:c.match("text/plain"))||"text"===r.mediaType))return;o||(e.body=JSON.stringify(e.body))}}}catch(p){throw new Error(`Error "${p.message}" occurred in serializing the payload - ${JSON.stringify(s,void 0,"  ")}.`)}}else if(r.formDataParameters&&r.formDataParameters.length>0){e.formData={};for(const n of r.formDataParameters){const i=re(t,n);if(void 0!==i&&null!==i){const t=n.mapper.serializedName||$e(n);e.formData[t]=r.serializer.serialize(n.mapper,i,$e(n),l)}}}}(e,o,i,t)),r(e)}}}function De(e){return Boolean(e&&"function"===typeof e.getReader&&"function"===typeof e.tee)}class Le{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:r}=function(e){const t=new AbortController;let r,n;if(e.abortSignal){if(e.abortSignal.aborted)throw new ge._("The operation was aborted.");n=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",n),r=()=>{var t;n&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",n))}}e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout);return{abortController:t,abortControllerCleanup:r}}(e);try{const i=function(e){const t=new Headers;for(const[r,n]of e)t.append(r,n);return t}(e.headers),o=function(e){const t="function"===typeof e.body?e.body():e.body;if(function(e){return e&&"function"===typeof e.pipe}(t))throw new Error("Node streams are not supported in browser environment.");return De(t)?Be(t,e.onUploadProgress):t}(e),s=await fetch(e.url,{body:o,method:e.method,headers:i,signal:t.signal,credentials:e.withCredentials?"include":"same-origin",cache:"no-store"});return n=e.body,("function"===typeof Blob||"object"===typeof Blob)&&n instanceof Blob&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t){var r,n;const i=function(e){const t=T();for(const[r,n]of e.headers)t.set(r,n);return t}(e),o={request:t,headers:i,status:e.status},s=De(e.body)?Be(e.body,t.onDownloadProgress):e.body;if((null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(Number.POSITIVE_INFINITY))||(null===(n=t.streamResponseStatusCodes)||void 0===n?void 0:n.has(o.status)))if(t.enableBrowserStreams)o.browserStreamBody=null!==s&&void 0!==s?s:void 0;else{const e=new Response(s);o.blobBody=e.blob()}else{const e=new Response(s);o.bodyAsText=await e.text()}return o}(s,e)}finally{r&&r()}var n}(e)}catch(t){throw function(e,t){var r;return e&&"AbortError"===(null===e||void 0===e?void 0:e.name)?e:new j(`Error sending request: ${e.message}`,{code:null!==(r=null===e||void 0===e?void 0:e.code)&&void 0!==r?r:j.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function Be(e,t){let r=0;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,n){null!==e?(n.enqueue(e),r+=e.length,t&&t({loadedBytes:r})):n.terminate()}}));{const n=e.getReader();return new ReadableStream({async pull(e){var i;const{done:o,value:s}=await n.read();if(o||!s)return e.close(),void n.releaseLock();r+=null!==(i=null===s||void 0===s?void 0:s.length)&&void 0!==i?i:0,e.enqueue(s),t&&t({loadedBytes:r})}})}}function He(){return new Le}let Fe;const Ve={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function We(e,t,r,n){const i=function(e,t,r){var n;const i=new Map;if(null===(n=e.urlParameters)||void 0===n?void 0:n.length)for(const o of e.urlParameters){let n=re(t,o,r);const s=$e(o);n=e.serializer.serialize(o.mapper,n,s),o.skipEncoding||(n=encodeURIComponent(n)),i.set(`{${o.mapper.serializedName||s}}`,n)}return i}(t,r,n);let o=!1,s=Ke(e,i);if(t.path){let e=Ke(t.path,i);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(s=e,o=!0):s=function(e,t){if(!t)return e;const r=new URL(e);let n=r.pathname;n.endsWith("/")||(n=`${n}/`);t.startsWith("/")&&(t=t.substring(1));const i=t.indexOf("?");if(-1!==i){const e=t.substring(0,i),o=t.substring(i+1);n+=e,o&&(r.search=r.search?`${r.search}&${o}`:o)}else n+=t;return r.pathname=n,r.toString()}(s,e)}const{queryParams:a,sequenceParams:c}=function(e,t,r){var n;const i=new Map,o=new Set;if(null===(n=e.queryParameters)||void 0===n?void 0:n.length)for(const s of e.queryParameters){"Sequence"===s.mapper.type.name&&s.mapper.serializedName&&o.add(s.mapper.serializedName);let n=re(t,s,r);if(void 0!==n&&null!==n||s.mapper.required){n=e.serializer.serialize(s.mapper,n,$e(s));const t=s.collectionFormat?Ve[s.collectionFormat]:"";if(Array.isArray(n)&&(n=n.map((e=>null===e||void 0===e?"":e))),"Multi"===s.collectionFormat&&0===n.length)continue;!Array.isArray(n)||"SSV"!==s.collectionFormat&&"TSV"!==s.collectionFormat||(n=n.join(t)),s.skipEncoding||(n=Array.isArray(n)?n.map((e=>encodeURIComponent(e))):encodeURIComponent(n)),!Array.isArray(n)||"CSV"!==s.collectionFormat&&"Pipes"!==s.collectionFormat||(n=n.join(t)),i.set(s.mapper.serializedName||$e(s),n)}}return{queryParams:i,sequenceParams:o}}(t,r,n);return s=function(e,t,r,n=!1){if(0===t.size)return e;const i=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const r=(e=e.slice(1)).split("&");for(const n of r){const[e,r]=n.split("=",2),i=t.get(e);i?Array.isArray(i)?i.push(r):t.set(e,[i,r]):t.set(e,r)}return t}(i.search);for(const[a,c]of t){const e=o.get(a);if(Array.isArray(e))if(Array.isArray(c)){e.push(...c);const t=new Set(e);o.set(a,Array.from(t))}else e.push(c);else e?(Array.isArray(c)?c.unshift(e):r.has(a)&&o.set(a,[e,c]),n||o.set(a,c)):o.set(a,c)}const s=[];for(const[a,c]of o)if("string"===typeof c)s.push(`${a}=${c}`);else if(Array.isArray(c))for(const e of c)s.push(`${a}=${e}`);else s.push(`${a}=${c}`);return i.search=s.length?`?${s.join("&")}`:"",i.toString()}(s,a,c,o),s}function Ke(e,t){let r=e;for(const[n,i]of t)r=r.split(n).join(i);return r}const Qe=(0,le.YR)("core-client");const Xe=Me({namespace:"Azure.Communication",packageName:"@azure/communication-chat",packageVersion:"1.2.3"}),Ge={type:{name:"Composite",className:"ChatMessageReadReceiptsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessageReadReceipt"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Je={type:{name:"Composite",className:"ChatMessageReadReceipt",modelProperties:{senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}},readOn:{serializedName:"readOn",required:!0,type:{name:"DateTime"}}}}},Ye={type:{name:"Composite",className:"CommunicationIdentifierModel",modelProperties:{rawId:{serializedName:"rawId",type:{name:"String"}},communicationUser:{serializedName:"communicationUser",type:{name:"Composite",className:"CommunicationUserIdentifierModel"}},phoneNumber:{serializedName:"phoneNumber",type:{name:"Composite",className:"PhoneNumberIdentifierModel"}},microsoftTeamsUser:{serializedName:"microsoftTeamsUser",type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel"}}}}},Ze={type:{name:"Composite",className:"CommunicationUserIdentifierModel",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},et={type:{name:"Composite",className:"PhoneNumberIdentifierModel",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"String"}}}}},tt={type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel",modelProperties:{userId:{serializedName:"userId",required:!0,type:{name:"String"}},isAnonymous:{serializedName:"isAnonymous",type:{name:"Boolean"}},cloud:{serializedName:"cloud",type:{name:"String"}}}}},rt={type:{name:"Composite",className:"CommunicationErrorResponse",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ChatError"}}}}},nt={type:{name:"Composite",className:"ChatError",modelProperties:{code:{serializedName:"code",required:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}},innerError:{serializedName:"innererror",type:{name:"Composite",className:"ChatError"}}}}},it={type:{name:"Composite",className:"SendReadReceiptRequest",modelProperties:{chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}}}},ot={type:{name:"Composite",className:"SendChatMessageRequest",modelProperties:{content:{serializedName:"content",required:!0,type:{name:"String"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},st={type:{name:"Composite",className:"SendChatMessageResult",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},at={type:{name:"Composite",className:"ChatMessagesCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessage"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},ct={type:{name:"Composite",className:"ChatMessage",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},type:{serializedName:"type",required:!0,type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},sequenceId:{serializedName:"sequenceId",required:!0,type:{name:"String"}},version:{serializedName:"version",required:!0,type:{name:"String"}},content:{serializedName:"content",type:{name:"Composite",className:"ChatMessageContent"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},editedOn:{serializedName:"editedOn",type:{name:"DateTime"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},ut={type:{name:"Composite",className:"ChatMessageContent",modelProperties:{message:{serializedName:"message",type:{name:"String"}},topic:{serializedName:"topic",type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},initiatorCommunicationIdentifier:{serializedName:"initiatorCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}}}}},lt={type:{name:"Composite",className:"ChatParticipant",modelProperties:{communicationIdentifier:{serializedName:"communicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},displayName:{serializedName:"displayName",type:{name:"String"}},shareHistoryTime:{serializedName:"shareHistoryTime",type:{name:"DateTime"}}}}},dt={type:{name:"Composite",className:"UpdateChatMessageRequest",modelProperties:{content:{serializedName:"content",type:{name:"String"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},pt={type:{name:"Composite",className:"ChatParticipantsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},ht={type:{name:"Composite",className:"AddChatParticipantsRequest",modelProperties:{participants:{serializedName:"participants",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},ft={type:{name:"Composite",className:"AddChatParticipantsResult",modelProperties:{invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},mt={type:{name:"Composite",className:"CreateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",required:!0,type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},yt={type:{name:"Composite",className:"CreateChatThreadResult",modelProperties:{chatThread:{serializedName:"chatThread",type:{name:"Composite",className:"ChatThreadProperties"}},invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},gt={type:{name:"Composite",className:"ChatThreadProperties",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},createdByCommunicationIdentifier:{serializedName:"createdByCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}}}}},vt={type:{name:"Composite",className:"ChatThreadsItemCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadItem"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},bt={type:{name:"Composite",className:"ChatThreadItem",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},lastMessageReceivedOn:{serializedName:"lastMessageReceivedOn",readOnly:!0,type:{name:"DateTime"}}}}},wt={type:{name:"Composite",className:"UpdateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",type:{name:"String"}}}}},Ct={type:{name:"Composite",className:"SendTypingNotificationRequest",modelProperties:{senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}}}}},Rt={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Tt={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},Et={parameterPath:"chatThreadId",mapper:{serializedName:"chatThreadId",required:!0,type:{name:"String"}}},St={parameterPath:["options","maxPageSize"],mapper:{serializedName:"maxPageSize",type:{name:"Number"}}},xt={parameterPath:["options","skip"],mapper:{serializedName:"skip",type:{name:"Number"}}},Pt={parameterPath:"apiVersion",mapper:{defaultValue:"2021-09-07",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},Ot={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Nt={parameterPath:"sendReadReceiptRequest",mapper:it},At={parameterPath:"sendChatMessageRequest",mapper:ot},Mt={parameterPath:["options","startTime"],mapper:{serializedName:"startTime",type:{name:"DateTime"}}},It={parameterPath:"chatMessageId",mapper:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}},qt={parameterPath:["options","contentType"],mapper:{defaultValue:"application/merge-patch+json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},_t={parameterPath:"updateChatMessageRequest",mapper:dt},kt={parameterPath:"participantCommunicationIdentifier",mapper:Ye},zt={parameterPath:"addChatParticipantsRequest",mapper:ht},jt={parameterPath:"updateChatThreadRequest",mapper:wt},$t={parameterPath:["options","sendTypingNotificationRequest"],mapper:Ct},Ut={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0},Dt={parameterPath:"createChatThreadRequest",mapper:mt};class Lt{constructor(e){this.client=e}async listChatReadReceipts(e,t){return Xe.withSpan("ChatApiClient.listChatReadReceipts",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},Ht)))}async sendChatReadReceipt(e,t,r){return Xe.withSpan("ChatApiClient.sendChatReadReceipt",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,sendReadReceiptRequest:t,options:r},Ft)))}async sendChatMessage(e,t,r){return Xe.withSpan("ChatApiClient.sendChatMessage",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,sendChatMessageRequest:t,options:r},Vt)))}async listChatMessages(e,t){return Xe.withSpan("ChatApiClient.listChatMessages",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},Wt)))}async getChatMessage(e,t,r){return Xe.withSpan("ChatApiClient.getChatMessage",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,chatMessageId:t,options:r},Kt)))}async updateChatMessage(e,t,r,n){return Xe.withSpan("ChatApiClient.updateChatMessage",null!==n&&void 0!==n?n:{},(async n=>this.client.sendOperationRequest({chatThreadId:e,chatMessageId:t,updateChatMessageRequest:r,options:n},Qt)))}async deleteChatMessage(e,t,r){return Xe.withSpan("ChatApiClient.deleteChatMessage",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,chatMessageId:t,options:r},Xt)))}async listChatParticipants(e,t){return Xe.withSpan("ChatApiClient.listChatParticipants",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},Gt)))}async removeChatParticipant(e,t,r){return Xe.withSpan("ChatApiClient.removeChatParticipant",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,participantCommunicationIdentifier:t,options:r},Jt)))}async addChatParticipants(e,t,r){return Xe.withSpan("ChatApiClient.addChatParticipants",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,addChatParticipantsRequest:t,options:r},Yt)))}async updateChatThreadProperties(e,t,r){return Xe.withSpan("ChatApiClient.updateChatThreadProperties",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,updateChatThreadRequest:t,options:r},Zt)))}async getChatThreadProperties(e,t){return Xe.withSpan("ChatApiClient.getChatThreadProperties",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},er)))}async sendTypingNotification(e,t){return Xe.withSpan("ChatApiClient.sendTypingNotification",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},tr)))}async listChatReadReceiptsNext(e,t,r){return Xe.withSpan("ChatApiClient.listChatReadReceiptsNext",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,nextLink:t,options:r},rr)))}async listChatMessagesNext(e,t,r){return Xe.withSpan("ChatApiClient.listChatMessagesNext",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,nextLink:t,options:r},nr)))}async listChatParticipantsNext(e,t,r){return Xe.withSpan("ChatApiClient.listChatParticipantsNext",null!==r&&void 0!==r?r:{},(async r=>this.client.sendOperationRequest({chatThreadId:e,nextLink:t,options:r},ir)))}}const Bt=F(n,!1),Ht={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"GET",responses:{200:{bodyMapper:Ge},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,xt,Pt],urlParameters:[Tt,Et],headerParameters:[Rt],serializer:Bt},Ft={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"POST",responses:{200:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:Nt,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,Ot],mediaType:"json",serializer:Bt},Vt={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"POST",responses:{201:{bodyMapper:st},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:At,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,Ot],mediaType:"json",serializer:Bt},Wt={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"GET",responses:{200:{bodyMapper:at},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,Pt,Mt],urlParameters:[Tt,Et],headerParameters:[Rt],serializer:Bt},Kt={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"GET",responses:{200:{bodyMapper:ct},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[Pt],urlParameters:[Tt,Et,It],headerParameters:[Rt],serializer:Bt},Qt={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:_t,queryParameters:[Pt],urlParameters:[Tt,Et,It],headerParameters:[Rt,qt],mediaType:"json",serializer:Bt},Xt={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[Pt],urlParameters:[Tt,Et,It],headerParameters:[Rt],serializer:Bt},Gt={path:"/chat/threads/{chatThreadId}/participants",httpMethod:"GET",responses:{200:{bodyMapper:pt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,xt,Pt],urlParameters:[Tt,Et],headerParameters:[Rt],serializer:Bt},Jt={path:"/chat/threads/{chatThreadId}/participants/:remove",httpMethod:"POST",responses:{204:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:kt,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,Ot],mediaType:"json",serializer:Bt},Yt={path:"/chat/threads/{chatThreadId}/participants/:add",httpMethod:"POST",responses:{201:{bodyMapper:ft},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:zt,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,Ot],mediaType:"json",serializer:Bt},Zt={path:"/chat/threads/{chatThreadId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:jt,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,qt],mediaType:"json",serializer:Bt},er={path:"/chat/threads/{chatThreadId}",httpMethod:"GET",responses:{200:{bodyMapper:gt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt],serializer:Bt},tr={path:"/chat/threads/{chatThreadId}/typing",httpMethod:"POST",responses:{200:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:$t,queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt,Ot],mediaType:"json",serializer:Bt},rr={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ge},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,xt,Pt],urlParameters:[Tt,Et,Ut],headerParameters:[Rt],serializer:Bt},nr={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:at},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,Pt,Mt],urlParameters:[Tt,Et,Ut],headerParameters:[Rt],serializer:Bt},ir={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:pt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,xt,Pt],urlParameters:[Tt,Et,Ut],headerParameters:[Rt],serializer:Bt};class or{constructor(e){this.client=e}async createChatThread(e,t){return Xe.withSpan("ChatApiClient.createChatThread",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({createChatThreadRequest:e,options:t},ar)))}async listChatThreads(e){return Xe.withSpan("ChatApiClient.listChatThreads",null!==e&&void 0!==e?e:{},(async e=>this.client.sendOperationRequest({options:e},cr)))}async deleteChatThread(e,t){return Xe.withSpan("ChatApiClient.deleteChatThread",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({chatThreadId:e,options:t},ur)))}async listChatThreadsNext(e,t){return Xe.withSpan("ChatApiClient.listChatThreadsNext",null!==t&&void 0!==t?t:{},(async t=>this.client.sendOperationRequest({nextLink:e,options:t},lr)))}}const sr=F(n,!1),ar={path:"/chat/threads",httpMethod:"POST",responses:{201:{bodyMapper:yt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},requestBody:Dt,queryParameters:[Pt],urlParameters:[Tt],headerParameters:[Rt,Ot,{parameterPath:["options","repeatabilityRequestId"],mapper:{serializedName:"repeatability-request-id",type:{name:"String"}}}],mediaType:"json",serializer:sr},cr={path:"/chat/threads",httpMethod:"GET",responses:{200:{bodyMapper:vt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,Pt,Mt],urlParameters:[Tt],headerParameters:[Rt],serializer:sr},ur={path:"/chat/threads/{chatThreadId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[Pt],urlParameters:[Tt,Et],headerParameters:[Rt],serializer:sr},lr={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:vt},401:{bodyMapper:rt,isError:!0},403:{bodyMapper:rt,isError:!0},429:{bodyMapper:rt,isError:!0},503:{bodyMapper:rt,isError:!0}},queryParameters:[St,Pt,Mt],urlParameters:[Tt,Ut],headerParameters:[Rt],serializer:sr};class dr extends class{constructor(e={}){var t,r;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&Qe.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(Fe||(Fe=He()),Fe),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes){const t=e.credentialScopes;return Array.isArray(t)?t.map((e=>new URL(e).toString())):new URL(t).toString()}if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy");return}(e),r=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=qe(null!==e&&void 0!==e?e:{});return e.credentialOptions&&t.addPolicy(je({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(Ue(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(ue(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:r}))}(e),null===(r=e.additionalPolicies)||void 0===r?void 0:r.length)for(const{policy:n,position:i}of e.additionalPolicies){const e="perRetry"===i?"Sign":void 0;this.pipeline.addPolicy(n,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const r=t.baseUrl||this._endpoint;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const n=function(e){return new S(e)}({url:We(r,t,e,this)});n.method=t.httpMethod;const i=se(n);i.operationSpec=t,i.operationArguments=e;const o=t.contentType||this._requestContentType;o&&t.requestBody&&n.headers.set("Content-Type",o);const s=e.options;if(s){const e=s.requestOptions;e&&(e.timeout&&(n.timeout=e.timeout),e.onUploadProgress&&(n.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(n.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(i.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(n.allowInsecureConnection=!0)),s.abortSignal&&(n.abortSignal=s.abortSignal),s.tracingOptions&&(n.tracingOptions=s.tracingOptions)}this._allowInsecureConnection&&(n.allowInsecureConnection=!0),void 0===n.streamResponseStatusCodes&&(n.streamResponseStatusCodes=function(e){const t=new Set;for(const r in e.responses){const n=e.responses[r];n.bodyMapper&&n.bodyMapper.type.name===te&&t.add(Number(r))}return t}(t));try{const e=await this.sendRequest(n),r=B(e,t.responses[e.status]);return(null===s||void 0===s?void 0:s.onResponse)&&s.onResponse(e,r),r}catch(a){if("object"===typeof a&&(null===a||void 0===a?void 0:a.response)){const e=a.response,r=B(e,t.responses[a.statusCode]||t.responses.default);a.details=r,(null===s||void 0===s?void 0:s.onResponse)&&s.onResponse(e,r,a)}throw a}}}{constructor(e,t){var r,n;if(void 0===e)throw new Error("'endpoint' cannot be null");t||(t={});const i="azsdk-js-communication-chat/1.2.3",o=t.userAgentOptions&&t.userAgentOptions.userAgentPrefix?`${t.userAgentOptions.userAgentPrefix} ${i}`:`${i}`;super(Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),t),{userAgentOptions:{userAgentPrefix:o},baseUri:null!==(n=null!==(r=t.endpoint)&&void 0!==r?r:t.baseUri)&&void 0!==n?n:"{endpoint}"})),this.endpoint=e,this.apiVersion=t.apiVersion||"2021-09-07",this.chatThread=new Lt(this),this.chat=new or(this),this.addCustomApiVersionPolicy(t.apiVersion)}addCustomApiVersionPolicy(e){if(!e)return;const t={name:"CustomApiVersionPolicy",async sendRequest(t,r){const n=t.url.split("?");if(n.length>1){const r=n[1].split("&").map((t=>t.indexOf("api-version")>-1?"api-version="+e:t));t.url=n[0]+"?"+r.join("&")}return r(t)}};this.pipeline.addPolicy(t)}}const pr=(0,le.YR)("communication-chat"),hr=e=>je({credential:{getToken:(t,r)=>e.getToken({abortSignal:null===r||void 0===r?void 0:r.abortSignal})},scopes:[]});class fr{constructor(e,t,r,n={}){this.endpoint=e,this.timeOfLastTypingRequest=void 0,this.threadId=t,this.tokenCredential=r;const i=Object.assign(Object.assign({},n),{loggingOptions:{logger:pr.info}});this.client=new dr(this.endpoint,Object.assign({endpoint:this.endpoint},i));const o=hr(this.tokenCredential);this.client.pipeline.addPolicy(o)}getProperties(e={}){return Xe.withSpan("ChatClient-GetProperties",e,(async e=>{const t=await this.client.chatThread.getChatThreadProperties(this.threadId,e);return b(t)}))}updateTopic(e,t={}){return Xe.withSpan("ChatThreadClient-UpdateTopic",t,(async t=>{await this.client.chatThread.updateChatThreadProperties(this.threadId,{topic:e},t)}))}sendMessage(e,t={}){return Xe.withSpan("ChatThreadClient-SendMessage",t,(async r=>{this.timeOfLastTypingRequest=void 0;return await this.client.chatThread.sendChatMessage(this.threadId,Object.assign(Object.assign({},e),t),r)}))}getMessage(e,t={}){return Xe.withSpan("ChatThreadClient-GetMessage",t,(async t=>{const r=await this.client.chatThread.getChatMessage(this.threadId,e,t);return v(r)}))}listMessagesPage(e,t={}){return a(this,arguments,(function*(){if(!e.continuationToken){const r=yield s(this.client.chatThread.listChatMessages(this.threadId,t));e.continuationToken=r.nextLink,r.value&&(yield yield s(r.value.map(v,this)))}for(;e.continuationToken;){const r=yield s(this.client.chatThread.listChatMessagesNext(this.threadId,e.continuationToken,t));if(e.continuationToken=r.nextLink,!r.value)break;yield yield s(r.value.map(v,this))}}))}listMessagesAll(e){return a(this,arguments,(function*(){var t,r;try{for(var n,i=u(this.listMessagesPage({},e));!(n=yield s(i.next())).done;){const e=n.value;yield s(yield*c(u(e)))}}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i.return)&&(yield s(r.call(i)))}finally{if(t)throw t.error}}}))}listMessages(e={}){const{span:t,updatedOptions:r}=Xe.startSpan("ChatThreadClient-ListMessages",e);try{const e=this.listMessagesAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listMessagesPage(e,r)}}catch(n){throw t.setStatus({status:"error",error:n}),n}finally{t.end()}}deleteMessage(e,t={}){return Xe.withSpan("ChatThreadClient-DeleteMessage",t,(async t=>{await this.client.chatThread.deleteChatMessage(this.threadId,e,t)}))}async updateMessage(e,t={}){return Xe.withSpan("ChatThreadClient-UpdateMessage",t,(async r=>{await this.client.chatThread.updateChatMessage(this.threadId,e,t,r)}))}async addParticipants(e,t={}){return Xe.withSpan("ChatThreadClient-AddParticipants",t,(async t=>await this.client.chatThread.addChatParticipants(this.threadId,(e=>{var t;return{participants:null===(t=e.participants)||void 0===t?void 0:t.map((e=>m(e)))}})(e),t)))}listParticipantsPage(e,t={}){return a(this,arguments,(function*(){if(!e.continuationToken){const r=yield s(this.client.chatThread.listChatParticipants(this.threadId,t));e.continuationToken=r.nextLink,r.value&&(yield yield s(r.value.map(y,this)))}for(;e.continuationToken;){const r=yield s(this.client.chatThread.listChatParticipantsNext(this.threadId,e.continuationToken,t));if(e.continuationToken=r.nextLink,!r.value)break;yield yield s(r.value.map(y,this))}}))}listParticipantsAll(e){return a(this,arguments,(function*(){var t,r;try{for(var n,i=u(this.listParticipantsPage({},e));!(n=yield s(i.next())).done;){const e=n.value;yield s(yield*c(u(e)))}}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i.return)&&(yield s(r.call(i)))}finally{if(t)throw t.error}}}))}listParticipants(e={}){const{span:t,updatedOptions:r}=Xe.startSpan("ChatThreadClient-ListParticipants",e);try{const e=this.listParticipantsAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listParticipantsPage(e,r)}}catch(n){throw t.setStatus({status:"error",error:n}),n}finally{t.end()}}async removeParticipant(e,t={}){return Xe.withSpan("ChatThreadClient-RemoveParticipant",t,(async t=>{await this.client.chatThread.removeChatParticipant(this.threadId,h(e),t)}))}async sendTypingNotification(e={}){return Xe.withSpan("ChatThreadClient-SendTypingNotification",e,(async e=>{const t=new Date,{senderDisplayName:r}=e,n=i(e,["senderDisplayName"]);return this.canPostTypingNotification(t)?(this.timeOfLastTypingRequest=t,await this.client.chatThread.sendTypingNotification(this.threadId,Object.assign({sendTypingNotificationRequest:{senderDisplayName:r}},n)),!0):(pr.info(`Typing Notification NOT Send. [thread_id=${this.threadId}]`),!1)}))}async sendReadReceipt(e,t={}){return Xe.withSpan("ChatThreadClient-SendReadReceipt",t,(async t=>{await this.client.chatThread.sendChatReadReceipt(this.threadId,e,t)}))}listReadReceiptsPage(e,t={}){return a(this,arguments,(function*(){if(!e.continuationToken){const r=yield s(this.client.chatThread.listChatReadReceipts(this.threadId,t));e.continuationToken=r.nextLink,r.value&&(yield yield s(r.value.map(w,this)))}for(;e.continuationToken;){const r=yield s(this.client.chatThread.listChatReadReceiptsNext(this.threadId,e.continuationToken,t));if(e.continuationToken=r.nextLink,!r.value)break;yield yield s(r.value.map(w,this))}}))}listReadReceiptsAll(e){return a(this,arguments,(function*(){var t,r;try{for(var n,i=u(this.listReadReceiptsPage({},e));!(n=yield s(i.next())).done;){const e=n.value;yield s(yield*c(u(e)))}}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i.return)&&(yield s(r.call(i)))}finally{if(t)throw t.error}}}))}listReadReceipts(e={}){const{span:t,updatedOptions:r}=Xe.startSpan("ChatThreadClient-ListChatReadReceipts",e);try{const e=this.listReadReceiptsAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listReadReceiptsPage(e,r)}}catch(n){throw t.setStatus({status:"error",error:n}),n}finally{t.end()}}canPostTypingNotification(e){if(this.timeOfLastTypingRequest){if(e.getTime()-this.timeOfLastTypingRequest.getTime()<8e3)return pr.info(`Typing interval check failed. [last_request=${this.timeOfLastTypingRequest}]`),!1}return!0}}var mr=r(7187);var yr=r(181);class gr{constructor(e,t,r={}){this.endpoint=e,this.signalingClient=void 0,this.emitter=new mr.EventEmitter,this.isRealtimeNotificationsStarted=!1,this.tokenCredential=t,this.clientOptions=Object.assign({},r);const n=Object.assign(Object.assign({},r),{loggingOptions:{logger:pr.info}});this.client=new dr(this.endpoint,Object.assign({endpoint:this.endpoint},n));const i=hr(this.tokenCredential);this.client.pipeline.addPolicy(i),this.signalingClient=((e,t,r)=>{var n;return new yr.CommunicationSignalingClient(e,t,{environment:null!==(n=null===r||void 0===r?void 0:r.environment)&&void 0!==n?n:void 0})})(t,pr,r.signalingClientOptions)}getChatThreadClient(e){return new fr(this.endpoint,e,this.tokenCredential,this.clientOptions)}async createChatThread(e,t={}){return Xe.withSpan("ChatClient-CreateChatThread",t,(async r=>{var n,o;r.idempotencyToken=null!==(n=r.idempotencyToken)&&void 0!==n?n:(0,E.Z)();const s=(e=>{const{participants:t,idempotencyToken:r}=e,n=i(e,["participants","idempotencyToken"]);return Object.assign({repeatabilityRequestId:r},n)})(r);return(e=>{const{chatThread:t}=e,r=i(e,["chatThread"]);return t?Object.assign(Object.assign({},r),{chatThread:b(t)}):Object.assign({},r)})(await this.client.chat.createChatThread({topic:e.topic,participants:null===(o=t.participants)||void 0===o?void 0:o.map((e=>m(e)))},s))}))}listChatThreadsPage(e,t={}){return a(this,arguments,(function*(){if(!e.continuationToken){const r=yield s(this.client.chat.listChatThreads(t));e.continuationToken=r.nextLink,r.value&&(yield yield s(r.value))}for(;e.continuationToken;){const r=yield s(this.client.chat.listChatThreadsNext(e.continuationToken,t));if(e.continuationToken=r.nextLink,!r.value)break;yield yield s(r.value)}}))}listChatThreadsAll(e){return a(this,arguments,(function*(){var t,r;try{for(var n,i=u(this.listChatThreadsPage({},e));!(n=yield s(i.next())).done;){const e=n.value;yield s(yield*c(u(e)))}}catch(o){t={error:o}}finally{try{n&&!n.done&&(r=i.return)&&(yield s(r.call(i)))}finally{if(t)throw t.error}}}))}listChatThreads(e={}){const{span:t,updatedOptions:r}=Xe.startSpan("ChatClient-ListChatThreads",e);try{const e=this.listChatThreadsAll(r);return{next:()=>e.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listChatThreadsPage(e,r)}}catch(n){throw t.setStatus({error:n,status:"error"}),n}finally{t.end()}}async deleteChatThread(e,t={}){return Xe.withSpan("ChatClient-DeleteChatThread",t,(async t=>{await this.client.chat.deleteChatThread(e,t)}))}async startRealtimeNotifications(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are not supported in node js.");this.isRealtimeNotificationsStarted||(this.isRealtimeNotificationsStarted=!0,await this.signalingClient.start(),this.subscribeToSignalingEvents())}async stopRealtimeNotifications(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are not supported in node js.");this.isRealtimeNotificationsStarted=!1,await this.signalingClient.stop(),this.emitter.removeAllListeners()}on(e,t){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");if(!this.isRealtimeNotificationsStarted&&"realTimeNotificationConnected"!==e&&"realTimeNotificationDisconnected"!==e)throw new Error("You must call startRealtimeNotifications before you can subscribe to events.");this.emitter.on(e,t)}off(e,t){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.emitter.removeListener(e,t)}subscribeToSignalingEvents(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.signalingClient.on("connectionChanged",(e=>{2===e?this.emitter.emit("realTimeNotificationConnected"):3===e&&this.emitter.emit("realTimeNotificationDisconnected")})),this.signalingClient.on("chatMessageReceived",(e=>{this.emitter.emit("chatMessageReceived",e)})),this.signalingClient.on("chatMessageEdited",(e=>{this.emitter.emit("chatMessageEdited",e)})),this.signalingClient.on("chatMessageDeleted",(e=>{this.emitter.emit("chatMessageDeleted",e)})),this.signalingClient.on("typingIndicatorReceived",(e=>{this.emitter.emit("typingIndicatorReceived",e)})),this.signalingClient.on("readReceiptReceived",(e=>{this.emitter.emit("readReceiptReceived",e)})),this.signalingClient.on("chatThreadCreated",(e=>{this.emitter.emit("chatThreadCreated",e)})),this.signalingClient.on("chatThreadDeleted",(e=>{this.emitter.emit("chatThreadDeleted",e)})),this.signalingClient.on("chatThreadPropertiesUpdated",(e=>{this.emitter.emit("chatThreadPropertiesUpdated",e)})),this.signalingClient.on("participantsAdded",(e=>{this.emitter.emit("participantsAdded",e)})),this.signalingClient.on("participantsRemoved",(e=>{this.emitter.emit("participantsRemoved",e)}))}}},8071:function(e,t,r){"use strict";function n(e){this.message=e}r.d(t,{H:function(){return h}}),n.prototype=new Error,n.prototype.name="InvalidCharacterError";var i="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,o=0,s=0,a="";i=t.charAt(s++);~i&&(r=o%4?64*r+i:i,o++%4)?a+=String.fromCharCode(255&r>>(-2*o&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function o(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(i(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return i(t)}}function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidTokenError";var a=function(e,t){if("string"!=typeof e)throw new s("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[r]))}catch(e){throw new s("Invalid token specified: "+e.message)}};const c=e=>{const{exp:t}=a(e);return{token:e,expiresOnTimestamp:1e3*t}},u={token:"",expiresOnTimestamp:-10},l=1e3*10*60;class d{constructor(e){this.expiringSoonIntervalInMs=l,this.refreshAfterLifetimePercentage=.5,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.disposed=!1;const{tokenRefresher:t,token:r,refreshProactively:n}=e;this.refresh=t,this.currentToken=r?c(r):u,this.refreshProactively=null!==n&&void 0!==n&&n,this.refreshProactively&&this.scheduleRefresh()}async getToken(e){if(!this.isTokenExpiringSoon(this.currentToken))return this.currentToken;if(!this.isTokenValid(this.currentToken)){const t=this.updateTokenAndReschedule(null===e||void 0===e?void 0:e.abortSignal);await t}return this.currentToken}dispose(){this.disposed=!0,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.currentToken=u,this.activeTimeout&&clearTimeout(this.activeTimeout)}async updateTokenAndReschedule(e){if(this.activeTokenUpdating)return this.activeTokenUpdating;this.activeTokenUpdating=this.refreshTokenAndReschedule(e);try{await this.activeTokenUpdating}finally{this.activeTokenUpdating=null}}async refreshTokenAndReschedule(e){const t=await this.refreshToken(e);if(!this.isTokenValid(t))throw new Error("The token returned from the tokenRefresher is expired.");this.currentToken=t,this.refreshProactively&&this.scheduleRefresh()}async refreshToken(e){try{return this.activeTokenFetching||(this.activeTokenFetching=this.refresh(e)),c(await this.activeTokenFetching)}finally{this.activeTokenFetching=null}}scheduleRefresh(){if(this.disposed)return;this.activeTimeout&&clearTimeout(this.activeTimeout);const e=this.currentToken.expiresOnTimestamp-Date.now();let t=null;t=this.isTokenExpiringSoon(this.currentToken)?e*this.refreshAfterLifetimePercentage:e-this.expiringSoonIntervalInMs,this.activeTimeout=setTimeout((()=>this.updateTokenAndReschedule()),t)}isTokenValid(e){return e&&Date.now()<e.expiresOnTimestamp}isTokenExpiringSoon(e){return!e||Date.now()>=e.expiresOnTimestamp-this.expiringSoonIntervalInMs}}class p{constructor(e){this.token=e}async getToken(){return this.token}dispose(){}}class h{constructor(e){this.disposed=!1,this.tokenCredential="string"===typeof e?new p(c(e)):new d(e)}async getToken(e){this.throwIfDisposed();const t=await this.tokenCredential.getToken(e);return this.throwIfDisposed(),t}dispose(){this.disposed=!0,this.tokenCredential.dispose()}throwIfDisposed(){if(this.disposed)throw new Error("User credential is disposed")}}},3575:function(e,t,r){"use strict";function n(e){return e.toLowerCase()}function i(e){if(e&&"object"===typeof e){const t=e;if("function"===typeof t.rawHeaders&&"function"===typeof t.clone&&"function"===typeof t.get&&"function"===typeof t.set&&"function"===typeof t.contains&&"function"===typeof t.remove&&"function"===typeof t.headersArray&&"function"===typeof t.headerValues&&"function"===typeof t.headerNames&&"function"===typeof t.toJson)return!0}return!1}r.r(t),r.d(t,{AccessTokenRefresher:function(){return Qr},ApiKeyCredentials:function(){return Yr},BaseRequestPolicy:function(){return ce},BasicAuthenticationCredentials:function(){return Jr},Constants:function(){return Le},DefaultHttpClient:function(){return re},ExpiringAccessTokenCache:function(){return Kr},HttpHeaders:function(){return o},HttpPipelineLogLevel:function(){return se},MapperType:function(){return z},QueryCollectionFormat:function(){return st},RequestPolicyOptions:function(){return ue},RestError:function(){return te},RetryMode:function(){return We},Serializer:function(){return x},ServiceClient:function(){return Ur},TopicCredentials:function(){return Zr},URLBuilder:function(){return D},URLQuery:function(){return U},WebResource:function(){return j},XML_ATTRKEY:function(){return c},XML_CHARKEY:function(){return u},applyMixins:function(){return R},bearerTokenAuthenticationPolicy:function(){return ut},createPipelineFromOptions:function(){return Lr},createSpanFunction:function(){return Wr},delay:function(){return He},deserializationPolicy:function(){return Re},deserializeResponseBody:function(){return Pe},disableResponseDecompressionPolicy:function(){return dt},encodeUri:function(){return f},executePromisesSequentially:function(){return b},exponentialRetryPolicy:function(){return Ve},flattenResponse:function(){return Vr},generateClientRequestIdPolicy:function(){return pt},generateUuid:function(){return v},getDefaultProxySettings:function(){return gt},getDefaultUserAgentValue:function(){return nt},isDuration:function(){return E},isNode:function(){return h},isTokenCredential:function(){return et},isValidUuid:function(){return g},keepAlivePolicy:function(){return Ne},logPolicy:function(){return Ge},operationOptionsToRequestOptionsBase:function(){return ae},parseXML:function(){return ge},promiseToCallback:function(){return w},promiseToServiceCallback:function(){return C},proxyPolicy:function(){return vt},redirectPolicy:function(){return qe},serializeObject:function(){return k},signingPolicy:function(){return Rt},stringifyXML:function(){return be},stripRequest:function(){return y},stripResponse:function(){return m},systemErrorRetryPolicy:function(){return Et},throttlingRetryPolicy:function(){return Ot},tracingPolicy:function(){return jr},userAgentPolicy:function(){return it}});class o{constructor(e){if(this._headersMap={},e)for(const t in e)this.set(t,e[t])}set(e,t){this._headersMap[n(e)]={name:e,value:t.toString()}}get(e){const t=this._headersMap[n(e)];return t?t.value:void 0}contains(e){return!!this._headersMap[n(e)]}remove(e){const t=this.contains(e);return delete this._headersMap[n(e)],t}rawHeaders(){return this.toJson({preserveCase:!0})}headersArray(){const e=[];for(const t in this._headersMap)e.push(this._headersMap[t]);return e}headerNames(){const e=[],t=this.headersArray();for(let r=0;r<t.length;++r)e.push(t[r].name);return e}headerValues(){const e=[],t=this.headersArray();for(let r=0;r<t.length;++r)e.push(t[r].value);return e}toJson(e={}){const t={};if(e.preserveCase)for(const r in this._headersMap){const e=this._headersMap[r];t[e.name]=e.value}else for(const r in this._headersMap){const e=this._headersMap[r];t[n(e.name)]=e.value}return t}toString(){return JSON.stringify(this.toJson({preserveCase:!0}))}clone(){const e={};for(const t in this._headersMap){const r=this._headersMap[t];e[r.name]=r.value}return new o(e)}}function s(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function a(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}const c="$",u="_";var l=r(5934),d=r(4155);const p=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,h="undefined"!==typeof d&&!!d.version&&!!d.versions&&!!d.versions.node;function f(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/"/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function m(e){const t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function y(e){const t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function g(e){return p.test(e)}function v(){return(0,l.Z)()}function b(e,t){let r=Promise.resolve(t);return e.forEach((e=>{r=r.then(e)})),r}function w(e){if("function"!==typeof e.then)throw new Error("The provided input is not a Promise.");return t=>{e.then((e=>t(void 0,e))).catch((e=>{t(e)}))}}function C(e){if("function"!==typeof e.then)throw new Error("The provided input is not a Promise.");return t=>{e.then((e=>d.nextTick(t,void 0,e.parsedBody,e.request,e))).catch((e=>{d.nextTick(t,e)}))}}function R(e,t){const r=e;t.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((t=>{r.prototype[t]=e.prototype[t]}))}))}const T=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function E(e){return T.test(e)}function S(e,t,r){return e&&t?e.split(t).join(r||""):e}class x{constructor(e={},t){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,r){const n=(e,n)=>{throw new Error(`"${r}" with value "${t}" should satisfy the constraint "${e}": ${n}.`)};if(e.constraints&&void 0!=t){const r=t,{ExclusiveMaximum:i,ExclusiveMinimum:o,InclusiveMaximum:s,InclusiveMinimum:a,MaxItems:c,MaxLength:u,MinItems:l,MinLength:d,MultipleOf:p,Pattern:h,UniqueItems:f}=e.constraints;void 0!=i&&r>=i&&n("ExclusiveMaximum",i),void 0!=o&&r<=o&&n("ExclusiveMinimum",o),void 0!=s&&r>s&&n("InclusiveMaximum",s),void 0!=a&&r<a&&n("InclusiveMinimum",a);const m=t;if(void 0!=c&&m.length>c&&n("MaxItems",c),void 0!=u&&m.length>u&&n("MaxLength",u),void 0!=l&&m.length<l&&n("MinItems",l),void 0!=d&&m.length<d&&n("MinLength",d),void 0!=p&&r%p!==0&&n("MultipleOf",p),h){const e="string"===typeof h?new RegExp(h):h;"string"===typeof t&&null!==t.match(e)||n("Pattern",h)}f&&m.some(((e,t,r)=>r.indexOf(e)!==t))&&n("UniqueItems",f)}}serialize(e,t,r,n={}){var i,o,a;const l={rootName:null!==(i=n.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=n.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(a=n.xmlCharKey)&&void 0!==a?a:u};let d={};const p=e.type.name;r||(r=e.serializedName),null!==p.match(/^Sequence$/i)&&(d=[]),e.isConstant&&(t=e.defaultValue);const{required:h,nullable:f}=e;if(h&&f&&void 0===t)throw new Error(`${r} cannot be undefined.`);if(h&&!f&&void 0==t)throw new Error(`${r} cannot be null or undefined.`);if(!h&&!1===f&&null===t)throw new Error(`${r} cannot be null.`);if(void 0==t)d=t;else if(null!==p.match(/^any$/i))d=t;else if(null!==p.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))d=function(e,t,r){if(null!==r&&void 0!==r)if(null!==e.match(/^Number$/i)){if("number"!==typeof r)throw new Error(`${t} with value ${r} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!==typeof r.valueOf())throw new Error(`${t} with value "${r}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!==typeof r.valueOf()||!g(r))throw new Error(`${t} with value "${r}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!==typeof r)throw new Error(`${t} with value ${r} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof r;if("string"!==e&&"function"!==e&&!(r instanceof ArrayBuffer)&&!ArrayBuffer.isView(r)&&("function"!==typeof Blob&&"object"!==typeof Blob||!(r instanceof Blob)))throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.`)}return r}(p,r,t);else if(null!==p.match(/^Enum$/i)){d=function(e,t,r){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"===typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r)))throw new Error(`${r} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return r}(r,e.type.allowedValues,t)}else null!==p.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?d=function(e,t,r){if(void 0!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"===typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${r} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(!e)return;"string"===typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!E(t))throw new Error(`${r} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(p,t,r):null!==p.match(/^ByteArray$/i)?d=function(e,t){let r="";if(void 0!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);r=s(t)}return r}(r,t):null!==p.match(/^Base64Url$/i)?d=function(e,t){let r="";if(void 0!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);r=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let r=e.length;for(;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}(s(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)||""}return r}(r,t):null!==p.match(/^Sequence$/i)?d=function(e,t,r,n,i,o){if(!Array.isArray(r))throw new Error(`${n} must be of type Array.`);const s=t.type.element;if(!s||"object"!==typeof s)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);const a=[];for(let u=0;u<r.length;u++){const t=e.serialize(s,r[u],n,o);if(i&&s.xmlNamespace){const e=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";"Composite"===s.type.name?(a[u]=Object.assign({},t),a[u][c]={[e]:s.xmlNamespace}):(a[u]={},a[u][o.xmlCharKey]=t,a[u][c]={[e]:s.xmlNamespace})}else a[u]=t}return a}(this,e,t,r,Boolean(this.isXML),l):null!==p.match(/^Dictionary$/i)?d=function(e,t,r,n,i,o){if("object"!==typeof r)throw new Error(`${n} must be of type object.`);const s=t.type.value;if(!s||"object"!==typeof s)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);const a={};for(const c of Object.keys(r)){const t=e.serialize(s,r[c],n,o);a[c]=A(s,t,i,o)}if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",r=a;return r[c]={[e]:t.xmlNamespace},r}return a}(this,e,t,r,Boolean(this.isXML),l):null!==p.match(/^Composite$/i)&&(d=function(e,t,r,n,i,o){q(e,t)&&(t=I(e,t,r,"clientName"));if(void 0!=r){const s={},a=N(e,t,n);for(const l of Object.keys(a)){const u=a[l];if(u.readOnly)continue;let d,p=s;if(e.isXML)d=u.xmlIsWrapped?u.xmlName:u.xmlElementName||u.xmlName;else{const e=P(u.serializedName);d=e.pop();for(const t of e){void 0!=p[t]||void 0==r[l]&&void 0===u.defaultValue||(p[t]={}),p=p[t]}}if(void 0!=p){if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";p[c]=Object.assign(Object.assign({},p[c]),{[e]:t.xmlNamespace})}const s=""!==u.serializedName?n+"."+u.serializedName:n;let a=r[l];const h=q(e,t);h&&h.clientName===l&&void 0==a&&(a=t.serializedName);const f=e.serialize(u,a,s,o);if(void 0!==f&&void 0!=d){const e=A(u,f,i,o);i&&u.xmlIsAttribute?(p[c]=p[c]||{},p[c][d]=f):i&&u.xmlIsWrapped?p[d]={[u.xmlElementName]:e}:p[d]=e}}}const u=function(e,t,r){const n=t.type.additionalProperties;if(!n&&t.type.className){const n=O(e,t,r);return null===n||void 0===n?void 0:n.type.additionalProperties}return n}(e,t,n);if(u){const t=Object.keys(a);for(const i in r){t.every((e=>e!==i))&&(s[i]=e.serialize(u,r[i],n+'["'+i+'"]',o))}}return s}return r}(this,e,t,r,Boolean(this.isXML),l));return d}deserialize(e,t,r,n={}){var i,o,s;const l={rootName:null!==(i=n.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=n.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(s=n.xmlCharKey)&&void 0!==s?s:u};if(void 0==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let d;const p=e.type.name;if(r||(r=e.serializedName),null!==p.match(/^Composite$/i))d=function(e,t,r,n,i){var o,s;const a=null!==(o=i.xmlCharKey)&&void 0!==o?o:u;q(e,t)&&(t=I(e,t,r,"serializedName"));const l=N(e,t,n);let d={};const p=[];for(const u of Object.keys(l)){const o=l[u],h=P(l[u].serializedName);p.push(h[0]);const{serializedName:f,xmlName:m,xmlElementName:y}=o;let g=n;""!==f&&void 0!==f&&(g=n+"."+f);const v=o.headerCollectionPrefix;if(v){const t={};for(const n of Object.keys(r))n.startsWith(v)&&(t[n.substring(v.length)]=e.deserialize(o.type.value,r[n],g,i)),p.push(n);d[u]=t}else if(e.isXML)if(o.xmlIsAttribute&&r[c])d[u]=e.deserialize(o,r[c][m],g,i);else if(o.xmlIsMsText)void 0!==r[a]?d[u]=r[a]:"string"===typeof r&&(d[u]=r);else{const t=y||m||f;if(o.xmlIsWrapped){const t=r[m],n=null!==(s=null===t||void 0===t?void 0:t[y])&&void 0!==s?s:[];d[u]=e.deserialize(o,n,g,i)}else{const n=r[t];d[u]=e.deserialize(o,n,g,i)}}else{let n,s=r;for(const e of h){if(!s)break;s=s[e]}n=s;const a=t.type.polymorphicDiscriminator;let c;if(a&&u===a.clientName&&void 0==n&&(n=t.serializedName),Array.isArray(r[u])&&""===l[u].serializedName){n=r[u];const t=e.deserialize(o,n,g,i);for(const[e,r]of Object.entries(d))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=r);d=t}else void 0===n&&void 0===o.defaultValue||(c=e.deserialize(o,n,g,i),d[u]=c)}}const h=t.type.additionalProperties;if(h){const t=e=>{for(const t in l){if(P(l[t].serializedName)[0]===e)return!1}return!0};for(const o in r)t(o)&&(d[o]=e.deserialize(h,r[o],n+'["'+o+'"]',i))}else if(r)for(const c of Object.keys(r))void 0!==d[c]||p.includes(c)||M(c,i)||(d[c]=r[c]);return d}(this,e,t,r,l);else{if(this.isXML){const e=l.xmlCharKey,r=t;void 0!=r[c]&&void 0!=r[e]&&(t=r[e])}null!==p.match(/^Number$/i)?(d=parseFloat(t),isNaN(d)&&(d=t)):null!==p.match(/^Boolean$/i)?d="true"===t||"false"!==t&&t:null!==p.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?d=t:null!==p.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?d=new Date(t):null!==p.match(/^UnixTime$/i)?d=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==p.match(/^ByteArray$/i)?d=a(t):null!==p.match(/^Base64Url$/i)?d=function(e){if(!e)return;if(e&&"string"!==typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return a(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==p.match(/^Sequence$/i)?d=function(e,t,r,n,i){const o=t.type.element;if(!o||"object"!==typeof o)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(r){Array.isArray(r)||(r=[r]);const t=[];for(let s=0;s<r.length;s++)t[s]=e.deserialize(o,r[s],`${n}[${s}]`,i);return t}return r}(this,e,t,r,l):null!==p.match(/^Dictionary$/i)&&(d=function(e,t,r,n,i){const o=t.type.value;if(!o||"object"!==typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(r){const t={};for(const s of Object.keys(r))t[s]=e.deserialize(o,r[s],n,i);return t}return r}(this,e,t,r,l))}return e.isConstant&&(d=e.defaultValue),d}}function P(e){const t=[];let r="";if(e){const n=e.split(".");for(const e of n)"\\"===e.charAt(e.length-1)?r+=e.substr(0,e.length-1)+".":(r+=e,t.push(r),r="")}return t}function O(e,t,r){const n=t.type.className;if(!n)throw new Error(`Class name for model "${r}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[n]}function N(e,t,r){let n=t.type.modelProperties;if(!n){const i=O(e,t,r);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(n=null===i||void 0===i?void 0:i.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${t.type.className}" for object "${r}".`)}return n}function A(e,t,r,n){if(!r||!e.xmlNamespace)return t;const i={[e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[c])return t;{const e=Object.assign({},t);return e[c]=i,e}}const o={};return o[n.xmlCharKey]=t,o[c]=i,o}function M(e,t){return[c,t.xmlCharKey].includes(e)}function I(e,t,r,n){const i=q(e,t);if(i){const o=i[n];if(void 0!=o){const n=r[o];if(void 0!=n){const r=t.type.uberParent||t.type.className,i=n===r?n:r+"."+n,o=e.modelMappers.discriminators[i];o&&(t=o)}}}return t}function q(e,t){return t.type.polymorphicDiscriminator||_(e,t.type.uberParent)||_(e,t.type.className)}function _(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}function k(e){const t=e;if(void 0!=e){if(e instanceof Uint8Array)return e=s(e);if(e instanceof Date)return e.toISOString();if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(k(e[r]));return t}if("object"===typeof e){const r={};for(const n in e)r[n]=k(t[n]);return r}return e}}const z=function(e){const t={};for(const r of e)t[r]=r;return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]);class j{constructor(e,t,r,n,s,a,c,u,l,d,p,h,f,m,y){this.streamResponseBody=a,this.streamResponseStatusCodes=y,this.url=e||"",this.method=t||"GET",this.headers=i(s)?s:new o(s),this.body=r,this.query=n,this.formData=void 0,this.withCredentials=c||!1,this.abortSignal=u,this.timeout=l||0,this.onUploadProgress=d,this.onDownloadProgress=p,this.proxySettings=h,this.keepAlive=f,this.decompressResponse=m,this.requestId=this.headers.get("x-ms-client-request-id")||v()}validateRequestProperties(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")}prepare(e){if(!e)throw new Error("options object is required");if(void 0===e.method||null===e.method||"string"!==typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if((void 0===e.pathTemplate||null===e.pathTemplate||"string"!==typeof e.pathTemplate.valueOf())&&(void 0===e.url||null===e.url||"string"!==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!==typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){const t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){const{pathTemplate:t,pathParameters:r}=e;if("string"!==typeof t)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");const n=e.baseUrl;let i=n+(n.endsWith("/")?"":"/")+(t.startsWith("/")?t.slice(1):t);const o=i.match(/({[\w-]*\s*[\w-]*})/gi);if(o&&o.length){if(!r)throw new Error(`pathTemplate: ${t} has been provided. Hence, options.pathParameters must also be provided.`);o.forEach((function(e){const n=e.slice(1,-1),o=r[n];if(null===o||void 0===o||"string"!==typeof o&&"object"!==typeof o){const e=JSON.stringify(r,void 0,2);throw new Error(`pathTemplate: ${t} contains the path parameter ${n} however, it is not present in parameters: ${e}.The value of the path parameter can either be a "string" of the form { ${n}: "some sample value" } or it can be an "object" of the form { "${n}": { value: "some sample value", skipUrlEncoding: true } }.`)}if("string"===typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"===typeof o.valueOf()){if(!o.value)throw new Error(`options.pathParameters[${n}] is of type "object" but it does not contain a "value" property.`);i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}}))}this.url=i}if(e.queryParameters){const t=e.queryParameters;if("object"!==typeof t)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");const r=[];this.query={};for(const e in t){const n=t[e];if(n)if("string"===typeof n)r.push(e+"="+encodeURIComponent(n)),this.query[e]=encodeURIComponent(n);else if("object"===typeof n){if(!n.value)throw new Error(`options.queryParameters[${e}] is of type "object" but it does not contain a "value" property.`);n.skipUrlEncoding?(r.push(e+"="+n.value),this.query[e]=n.value):(r.push(e+"="+encodeURIComponent(n.value)),this.query[e]=encodeURIComponent(n.value))}}this.url+=r.join("&")}if(e.headers){const t=e.headers;for(const r of Object.keys(e.headers))this.headers.set(r,t[r])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,void 0!==e.body&&null!==e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new x(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),e.tracingContext&&(this.tracingContext=e.tracingContext),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this}clone(){const e=new j(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(e.formData=this.formData),this.operationSpec&&(e.operationSpec=this.operationSpec),this.shouldDeserialize&&(e.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(e.operationResponseGetter=this.operationResponseGetter),e}}var $=r(2571);class U{constructor(){this._rawQuery={}}any(){return Object.keys(this._rawQuery).length>0}keys(){return Object.keys(this._rawQuery)}set(e,t){const r=t;if(e)if(void 0!==r&&null!==r){const t=Array.isArray(r)?r:r.toString();this._rawQuery[e]=t}else delete this._rawQuery[e]}get(e){return e?this._rawQuery[e]:void 0}toString(){let e="";for(const t in this._rawQuery){e&&(e+="&");const r=this._rawQuery[t];if(Array.isArray(r)){const n=[];for(const e of r)n.push(`${t}=${e}`);e+=n.join("&")}else e+=`${t}=${r}`}return e}static parse(e){const t=new U;if(e){e.startsWith("?")&&(e=e.substring(1));let r="ParameterName",n="",i="";for(let o=0;o<e.length;++o){const s=e[o];switch(r){case"ParameterName":switch(s){case"=":r="ParameterValue";break;case"&":n="",i="";break;default:n+=s}break;case"ParameterValue":switch(s){case"&":t.set(n,i),n="",i="",r="ParameterName";break;default:i+=s}break;default:throw new Error("Unrecognized URLQuery parse state: "+r)}}"ParameterValue"===r&&t.set(n,i)}return t}}class D{setScheme(e){e?this.set(e,"SCHEME"):this._scheme=void 0}getScheme(){return this._scheme}setHost(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0}getHost(){return this._host}setPort(e){void 0===e||null===e||""===e?this._port=void 0:this.set(e.toString(),"PORT")}getPort(){return this._port}setPath(e){if(e){const t=e.indexOf("://");if(-1!==t){const r=e.lastIndexOf("/",t);this.set(-1===r?e:e.substr(r+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0}appendPath(e){if(e){let t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}}getPath(){return this._path}setQuery(e){this._query=e?U.parse(e):void 0}setQueryParameter(e,t){e&&(this._query||(this._query=new U),this._query.set(e,t))}getQueryParameterValue(e){return this._query?this._query.get(e):void 0}getQuery(){return this._query?this._query.toString():void 0}set(e,t){const r=new B(e,t);for(;r.next();){const e=r.current();let t;if(e)switch(e.type){case"SCHEME":this._scheme=e.text||void 0;break;case"HOST":this._host=e.text||void 0;break;case"PORT":this._port=e.text||void 0;break;case"PATH":t=e.text||void 0,this._path&&"/"!==this._path&&"/"===t||(this._path=t);break;case"QUERY":this._query=U.parse(e.text);break;default:throw new Error(`Unrecognized URLTokenType: ${e.type}`)}}}toString(){let e="";return this._scheme&&(e+=`${this._scheme}://`),this._host&&(e+=this._host),this._port&&(e+=`:${this._port}`),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+=`?${this._query.toString()}`),e}replaceAll(e,t){e&&(this.setScheme(S(this.getScheme(),e,t)),this.setHost(S(this.getHost(),e,t)),this.setPort(S(this.getPort(),e,t)),this.setPath(S(this.getPath(),e,t)),this.setQuery(S(this.getQuery(),e,t)))}static parse(e){const t=new D;return t.set(e,"SCHEME_OR_HOST"),t}}class L{constructor(e,t){this.text=e,this.type=t}static scheme(e){return new L(e,"SCHEME")}static host(e){return new L(e,"HOST")}static port(e){return new L(e,"PORT")}static path(e){return new L(e,"PATH")}static query(e){return new L(e,"QUERY")}}class B{constructor(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=void 0!==t&&null!==t?t:"SCHEME_OR_HOST",this._currentIndex=0}current(){return this._currentToken}next(){if(H(this))switch(this._currentState){case"SCHEME":!function(e){const t=function(e){return K(e,(e=>function(e){const t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)))}(e);e._currentToken=L.scheme(t),H(e)?e._currentState="HOST":e._currentState="DONE"}(this);break;case"SCHEME_OR_HOST":!function(e){const t=Q(e,":","/","?");H(e)?":"===F(e)?"://"===W(e,3)?(e._currentToken=L.scheme(t),e._currentState="HOST"):(e._currentToken=L.host(t),e._currentState="PORT"):(e._currentToken=L.host(t),"/"===F(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=L.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===W(e,3)&&V(e,3);const t=Q(e,":","/","?");e._currentToken=L.host(t),H(e)?":"===F(e)?e._currentState="PORT":"/"===F(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===F(e)&&V(e);const t=Q(e,"/","?");e._currentToken=L.port(t),H(e)?"/"===F(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){const t=Q(e,"?");e._currentToken=L.path(t),H(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===F(e)&&V(e);const t=function(e){let t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=L.query(t),e._currentState="DONE"}(this);break;default:throw new Error(`Unrecognized URLTokenizerState: ${this._currentState}`)}else this._currentToken=void 0;return!!this._currentToken}}function H(e){return e._currentIndex<e._textLength}function F(e){return e._text[e._currentIndex]}function V(e,t){H(e)&&(t||(t=1),e._currentIndex+=t)}function W(e,t){let r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function K(e,t){let r="";for(;H(e);){const n=F(e);if(!t(n))break;r+=n,V(e)}return r}function Q(e,...t){return K(e,(e=>-1===t.indexOf(e)))}const X="REDACTED",G=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],J=["api-version"];class Y{constructor({allowedHeaderNames:e=[],allowedQueryParameters:t=[]}={}){e=Array.isArray(e)?G.concat(e):G,t=Array.isArray(t)?J.concat(t):J,this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if(r instanceof Error)return Object.assign(Object.assign({},r),{name:r.name,message:r.message});if("_headersMap"===e)return this.sanitizeHeaders(r);if("url"===e)return this.sanitizeUrl(r);if("query"===e)return this.sanitizeQuery(r);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(r)||"object"===typeof(n=r)&&null!==n&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)){if(t.has(r))return"[Circular]";t.add(r)}var n;return r}}),2)}sanitizeHeaders(e){return this.sanitizeObject(e,this.allowedHeaderNames,((e,t)=>e[t].value))}sanitizeQuery(e){return this.sanitizeObject(e,this.allowedQueryParameters,((e,t)=>e[t]))}sanitizeObject(e,t,r){if("object"!==typeof e||null===e)return e;const n={};for(const i of Object.keys(e))t.has(i.toLowerCase())?n[i]=r(e,i):n[i]=X;return n}sanitizeUrl(e){if("string"!==typeof e||null===e)return e;const t=D.parse(e),r=t.getQuery();if(!r)return e;const n=U.parse(r);for(const i of n.keys())this.allowedQueryParameters.has(i.toLowerCase())||n.set(i,X);return t.setQuery(n.toString()),t.toString()}}const Z={},ee=new Y;class te extends Error{constructor(e,t,r,n,i){super(e),this.name="RestError",this.code=t,this.statusCode=r,this.request=n,this.response=i,Object.setPrototypeOf(this,te.prototype)}[Z](){return`RestError: ${this.message} \n ${ee.sanitize(this)}`}}te.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",te.PARSE_ERROR="PARSE_ERROR";class re{sendRequest(e){var t;const r=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");const n=e.abortSignal;if(n){if(n.aborted)return Promise.reject(new $._("The operation was aborted."));const e=()=>{r.abort()};n.addEventListener("abort",e),r.addEventListener("readystatechange",(()=>{r.readyState===XMLHttpRequest.DONE&&n.removeEventListener("abort",e)}))}if(ne(r.upload,e.onUploadProgress),ne(r,e.onDownloadProgress),e.formData){const t=e.formData,r=new FormData,n=(e,t)=>{t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"options")?r.append(e,t.value,t.options):r.append(e,t)};for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(let t=0;t<r.length;t++)n(e,r[t]);else n(e,r)}e.body=r,e.formData=void 0;const i=e.headers.get("Content-Type");i&&-1!==i.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}r.open(e.method,e.url),r.timeout=e.timeout,r.withCredentials=e.withCredentials;for(const i of e.headers.headersArray())r.setRequestHeader(i.name,i.value);return r.responseType=(null===(t=e.streamResponseStatusCodes)||void 0===t?void 0:t.size)||e.streamResponseBody?"blob":"text",r.send(void 0===e.body?null:e.body),"blob"===r.responseType?new Promise(((t,n)=>{!function(e,t,r,n){e.addEventListener("readystatechange",(()=>{var i;if(e.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(t.streamResponseBody||(null===(i=t.streamResponseStatusCodes)||void 0===i?void 0:i.has(e.status))){const n=new Promise(((r,n)=>{e.addEventListener("load",(()=>{r(e.response)})),oe(t,e,n)}));r({request:t,status:e.status,headers:ie(e),blobBody:n})}else e.addEventListener("load",(()=>{if(e.response){const i=new FileReader;i.onload=function(n){var i;const o=null===(i=n.target)||void 0===i?void 0:i.result;r({request:t,status:e.status,headers:ie(e),bodyAsText:o})},i.onerror=function(e){n(i.error)},i.readAsText(e.response,"UTF-8")}else r({request:t,status:e.status,headers:ie(e)})}))}))}(r,e,t,n),oe(e,r,n)})):new Promise((function(t,n){r.addEventListener("load",(()=>t({request:e,status:r.status,headers:ie(r),bodyAsText:r.responseText}))),oe(e,r,n)}))}}function ne(e,t){t&&e.addEventListener("progress",(e=>t({loadedBytes:e.loaded})))}function ie(e){const t=new o,r=e.getAllResponseHeaders().trim().split(/[\r\n]+/);for(const n of r){const e=n.indexOf(":"),r=n.slice(0,e),i=n.slice(e+2);t.set(r,i)}return t}function oe(e,t,r){t.addEventListener("error",(()=>r(new te(`Failed to send request to ${e.url}`,te.REQUEST_SEND_ERROR,void 0,e))));const n=new $._("The operation was aborted.");t.addEventListener("abort",(()=>r(n))),t.addEventListener("timeout",(()=>r(n)))}var se;!function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(se||(se={}));Object.create;Object.create;function ae(e){const{requestOptions:t,tracingOptions:r}=e;let n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["requestOptions","tracingOptions"]);return t&&(n=Object.assign(Object.assign({},n),t)),r&&(n.tracingContext=r.tracingContext,n.spanOptions=null===r||void 0===r?void 0:r.spanOptions),n}class ce{constructor(e,t){this._nextPolicy=e,this._options=t}shouldLog(e){return this._options.shouldLog(e)}log(e,t){this._options.log(e,t)}}class ue{constructor(e){this._logger=e}shouldLog(e){return!!this._logger&&e!==se.OFF&&e<=this._logger.minimumLogLevel}log(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)}}if(!self.document||!self.DOMParser||!self.Node||!self.XMLSerializer)throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');let le,de,pe,he,fe;function me(){return le||(le=document.implementation.createDocument(null,null,null)),le}function ye(){return de||(de=new DOMParser),de}function ge(e,t={}){var r,n,i,o;try{const s={rootName:null!==(r=t.rootName)&&void 0!==r?r:"",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(i=t.xmlCharKey)&&void 0!==i?i:u},a=ye().parseFromString(null!==(o=null===he||void 0===he?void 0:he.createHTML(e))&&void 0!==o?o:e,"application/xml");let c;return function(e){const t=e.getElementsByTagName("parsererror");if(t.length>0&&function(){var e,t;if(void 0===fe)try{const r=null!==(e=null===he||void 0===he?void 0:he.createHTML("INVALID"))&&void 0!==e?e:"INVALID";fe=null!==(t=ye().parseFromString(r,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==t?t:""}catch(r){fe=""}return fe}())for(let r=0;r<t.length;r++)if(t[r].namespaceURI===fe)throw new Error(t[r].innerHTML)}(a),c=s.includeRoot?ve(a,s):ve(a.childNodes[0],s),Promise.resolve(c)}catch(s){return Promise.reject(s)}}function ve(e,t){let r={};const n=e.childNodes.length,i=e.childNodes[0],o=i&&1===n&&i.nodeType===Node.TEXT_NODE&&i.nodeValue||void 0,s=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(e);if(s){r[c]={};for(let e=0;e<s.attributes.length;e++){const t=s.attributes[e];r[c][t.nodeName]=t.nodeValue}o&&(r[t.xmlCharKey]=o)}else 0===n?r="":o&&(r=o);if(!o)for(let a=0;a<n;a++){const n=e.childNodes[a];if(n.nodeType!==Node.TEXT_NODE){const e=ve(n,t);r[n.nodeName]?Array.isArray(r[n.nodeName])?r[n.nodeName].push(e):r[n.nodeName]=[r[n.nodeName],e]:r[n.nodeName]=e}}return r}function be(e,t={}){var r,n,i;const o={rootName:null!==(r=t.rootName)&&void 0!==r?r:"root",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(i=t.xmlCharKey)&&void 0!==i?i:u},s=Ce(e,o.rootName,o)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(pe||(pe=new XMLSerializer),pe).serializeToString(s)}function we(e){const t=[];for(const r of Object.keys(e)){const n=me().createAttribute(r);n.value=e[r].toString(),t.push(n)}return t}function Ce(e,t,r){if(void 0===e||null===e||"string"===typeof e||"number"===typeof e||"boolean"===typeof e){const r=me().createElement(t);return r.textContent=void 0===e||null===e?"":e.toString(),[r]}if(Array.isArray(e)){const n=[];for(const i of e)for(const e of Ce(i,t,r))n.push(e);return n}if("object"===typeof e){const n=me().createElement(t);for(const t of Object.keys(e))if(t===c)for(const r of we(e[t]))n.attributes.setNamedItem(r);else if(t===r.xmlCharKey)n.textContent=e[t].toString();else for(const i of Ce(e[t],t,r))n.appendChild(i);return[n]}throw new Error(`Illegal value passed to buildObject: ${e}`)}function Re(e,t){return{create:(r,n)=>new xe(r,n,e,t)}}"undefined"!==typeof self.trustedTypes&&(he=self.trustedTypes.createPolicy("@azure/core-http#xml.browser",{createHTML:e=>e}));const Te=["application/json","text/json"],Ee=["application/xml","application/atom+xml"],Se={expectedContentTypes:{json:Te,xml:Ee}};class xe extends ce{constructor(e,t,r,n={}){var i;super(e,t),this.jsonContentTypes=r&&r.json||Te,this.xmlContentTypes=r&&r.xml||Ee,this.xmlCharKey=null!==(i=n.xmlCharKey)&&void 0!==i?i:u}async sendRequest(e){return this._nextPolicy.sendRequest(e).then((e=>Pe(this.jsonContentTypes,this.xmlContentTypes,e,{xmlCharKey:this.xmlCharKey})))}}function Pe(e,t,r,n={}){var i,o,s;const a={rootName:null!==(i=n.rootName)&&void 0!==i?i:"",includeRoot:null!==(o=n.includeRoot)&&void 0!==o&&o,xmlCharKey:null!==(s=n.xmlCharKey)&&void 0!==s?s:u};return function(e,t,r,n){var i;const o=e=>{const t=`Error "${e}" occurred while parsing the response body - ${r.bodyAsText}.`,n=e.code||te.PARSE_ERROR,i=new te(t,n,r.status,r.request,r);return Promise.reject(i)};if(!(null===(i=r.request.streamResponseStatusCodes)||void 0===i?void 0:i.has(r.status))&&!r.request.streamResponseBody&&r.bodyAsText){const i=r.bodyAsText,s=r.headers.get("Content-Type")||"",a=s?s.split(";").map((e=>e.toLowerCase())):[];if(0===a.length||a.some((t=>-1!==e.indexOf(t))))return new Promise((e=>{r.parsedBody=JSON.parse(i),e(r)})).catch(o);if(a.some((e=>-1!==t.indexOf(e))))return ge(i,n).then((e=>(r.parsedBody=e,r))).catch(o)}return Promise.resolve(r)}(e,t,r,a).then((e=>{if(!function(e){const t=e.request.shouldDeserialize;let r;return r=void 0===t||("boolean"===typeof t?t:t(e)),r}(e))return e;const t=e.request.operationSpec;if(!t||!t.responses)return e;const i=function(e){let t;const r=e.request,n=r.operationSpec;if(n){const i=r.operationResponseGetter;t=i?i(n,e):n.responses[e.status]}return t}(e),{error:o,shouldReturnResponse:s}=function(e,t,r){var n;const i=200<=e.status&&e.status<300;if(function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?i:r){if(!r)return{error:null,shouldReturnResponse:!1};if(!r.isError)return{error:null,shouldReturnResponse:!1}}const o=null!==r&&void 0!==r?r:t.responses.default,s=(null===(n=e.request.streamResponseStatusCodes)||void 0===n?void 0:n.has(e.status))||e.request.streamResponseBody?`Unexpected status code: ${e.status}`:e.bodyAsText,a=new te(s,void 0,e.status,e.request,e);if(!o)throw a;const c=o.bodyMapper,u=o.headersMapper;try{if(e.parsedBody){const r=e.parsedBody;let n;if(c){let e=r;t.isXML&&c.type.name===z.Sequence&&(e="object"===typeof r?r[c.xmlElementName]:[]),n=t.serializer.deserialize(c,e,"error.response.parsedBody")}const i=r.error||n||r;a.code=i.code,i.message&&(a.message=i.message),c&&(a.response.parsedBody=n)}e.headers&&u&&(a.response.parsedHeaders=t.serializer.deserialize(u,e.headers.toJson(),"operationRes.parsedHeaders"))}catch(l){a.message=`Error "${l.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:a,shouldReturnResponse:!1}}(e,t,i);if(o)throw o;if(s)return e;if(i){if(i.bodyMapper){let r=e.parsedBody;t.isXML&&i.bodyMapper.type.name===z.Sequence&&(r="object"===typeof r?r[i.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(i.bodyMapper,r,"operationRes.parsedBody",n)}catch(a){throw new te(`Error ${a} occurred in deserializing the responseBody - ${e.bodyAsText}`,void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);i.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(i.headersMapper,e.headers.toJson(),"operationRes.parsedHeaders",n))}return e}))}const Oe={enable:!0};function Ne(e){return{create:(t,r)=>new Ae(t,r,e||Oe)}}class Ae extends ce{constructor(e,t,r){super(e,t),this.keepAliveOptions=r}async sendRequest(e){return e.keepAlive=this.keepAliveOptions.enable,this._nextPolicy.sendRequest(e)}}const Me=["GET","HEAD"],Ie={handleRedirects:!0,maxRetries:20};function qe(e=20){return{create:(t,r)=>new _e(t,r,e)}}class _e extends ce{constructor(e,t,r=20){super(e,t),this.maxRetries=r}sendRequest(e){return this._nextPolicy.sendRequest(e).then((e=>ke(this,e,0)))}}function ke(e,t,r){const{request:n,status:i}=t,o=t.headers.get("location");if(o&&(300===i||301===i&&Me.includes(n.method)||302===i&&Me.includes(n.method)||303===i&&"POST"===n.method||307===i)&&(!e.maxRetries||r<e.maxRetries)){const t=D.parse(n.url);return t.setPath(o),n.url=t.toString(),303===i&&(n.method="GET",delete n.body),e._nextPolicy.sendRequest(n).then((t=>ke(e,t,r+1)))}return Promise.resolve(t)}const ze=3e4,je=9e4;function $e(e){return"number"===typeof e}function Ue(e,t,r,n,i){return!!t(n,i)&&r.retryCount<e}function De(e,t={retryCount:0,retryInterval:0},r){r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;let n=Math.pow(2,t.retryCount-1)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}const Le={coreHttpVersion:"2.3.1",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429,ServiceUnavailable:503}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}};function Be(e){return"undefined"!==typeof e&&null!==e}function He(e,t){return new Promise(((r,n)=>{let i,o;const s=()=>{var e;return n(new $._(null!==(e=null===t||void 0===t?void 0:t.abortErrorMsg)&&void 0!==e?e:"The operation was aborted."))},a=()=>{(null===t||void 0===t?void 0:t.abortSignal)&&o&&t.abortSignal.removeEventListener("abort",o)};if(o=()=>(Be(i)&&clearTimeout(i),a(),s()),(null===t||void 0===t?void 0:t.abortSignal)&&t.abortSignal.aborted)return s();i=setTimeout((()=>{a(),r()}),e),(null===t||void 0===t?void 0:t.abortSignal)&&t.abortSignal.addEventListener("abort",o)}))}const Fe=(0,r(8417).YR)("core-http");function Ve(e,t,r){return{create:(n,i)=>new Qe(n,i,e,t,r)}}var We;!function(e){e[e.Exponential=0]="Exponential"}(We||(We={}));const Ke={maxRetries:3,retryDelayInMs:ze,maxRetryDelayInMs:je};class Qe extends ce{constructor(e,t,r,n,i){super(e,t),this.retryCount=$e(r)?r:3,this.retryInterval=$e(n)?n:ze,this.maxRetryInterval=$e(i)?i:je}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).then((t=>Xe(this,e,t))).catch((t=>Xe(this,e,t.response,void 0,t)))}}async function Xe(e,t,r,n,i){n=De({retryInterval:e.retryInterval,minRetryInterval:0,maxRetryInterval:e.maxRetryInterval},n,i);const o=t.abortSignal&&t.abortSignal.aborted;if(o||!Ue(e.retryCount,(function(e){const t=null===e||void 0===e?void 0:e.status;return(503!==t||!(null===r||void 0===r?void 0:r.headers.get(Le.HeaderConstants.RETRY_AFTER)))&&!(void 0===t||t<500&&408!==t||501===t||505===t)}),n,r)){if(o||i||!r){throw n.error||new te("Failed to send the request.",te.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r)}return r}Fe.info(`Retrying request in ${n.retryInterval}`);try{await He(n.retryInterval);const r=await e._nextPolicy.sendRequest(t.clone());return Xe(e,t,r,n)}catch(s){return Xe(e,t,r,n,s)}}function Ge(e={}){return{create:(t,r)=>new Je(t,r,e)}}class Je extends ce{constructor(e,t,{logger:r=Fe.info,allowedHeaderNames:n=[],allowedQueryParameters:i=[]}={}){super(e,t),this.logger=r,this.sanitizer=new Y({allowedHeaderNames:n,allowedQueryParameters:i})}get allowedHeaderNames(){return this.sanitizer.allowedHeaderNames}set allowedHeaderNames(e){this.sanitizer.allowedHeaderNames=e}get allowedQueryParameters(){return this.sanitizer.allowedQueryParameters}set allowedQueryParameters(e){this.sanitizer.allowedQueryParameters=e}sendRequest(e){return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then((e=>this.logResponse(e)))):this._nextPolicy.sendRequest(e)}logRequest(e){this.logger(`Request: ${this.sanitizer.sanitize(e)}`)}logResponse(e){return this.logger(`Response status code: ${e.status}`),this.logger(`Headers: ${this.sanitizer.sanitize(e.headers)}`),e}}function Ye(e){return Ze(e.parameterPath,e.mapper)}function Ze(e,t){let r;return r="string"===typeof e?e:Array.isArray(e)?e.join("."):t.serializedName,r}function et(e){const t=e;return t&&"function"===typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}function tt(){return"x-ms-useragent"}const rt=tt;function nt(){const e=[{key:"core-http",value:Le.coreHttpVersion}],t=function(){const e=self.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return function(e,t=" ",r="/"){return e.map((e=>{const t=e.value?`${r}${e.value}`:"";return`${e.key}${t}`})).join(t)}(e.concat(t))}function it(e){const t=e&&void 0!==e.key&&null!==e.key?e.key:"x-ms-useragent",r=e&&void 0!==e.value&&null!==e.value?e.value:nt();return{create:(e,n)=>new ot(e,n,t,r)}}class ot extends ce{constructor(e,t,r,n){super(e,t),this._nextPolicy=e,this._options=t,this.headerKey=r,this.headerValue=n}sendRequest(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)}addUserAgentHeader(e){e.headers||(e.headers=new o),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)}}var st;!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(st||(st={}));const at={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function ct(e,t,r){let n=null,i=null;const o=Object.assign(Object.assign({},at),r),s={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!s.isRefreshing&&(null!==(e=null===i||void 0===i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function a(r){var a;if(!s.isRefreshing){n=async function(e,t,r){async function n(){if(!(Date.now()<r)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(a){return null}}let i=await n();for(;null===i;)await He(t),i=await n();return i}((()=>e.getToken(t,r)),o.retryIntervalInMs,null!==(a=null===i||void 0===i?void 0:i.expiresOnTimestamp)&&void 0!==a?a:Date.now()).then((e=>(n=null,i=e,i))).catch((e=>{throw n=null,i=null,e}))}return n}return async e=>s.mustRefresh?a(e):(s.shouldRefresh&&a(e),i)}function ut(e,t){const r=ct(e,t);class n extends ce{constructor(e,t){super(e,t)}async sendRequest(e){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");const{token:t}=await r({abortSignal:e.abortSignal,tracingOptions:{tracingContext:e.tracingContext}});return e.headers.set(Le.HeaderConstants.AUTHORIZATION,`Bearer ${t}`),this._nextPolicy.sendRequest(e)}}return{create:(e,t)=>new n(e,t)}}const lt=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");function dt(){return{create:(e,t)=>{throw lt}}}function pt(e="x-ms-client-request-id"){return{create:(t,r)=>new ht(t,r,e)}}class ht extends ce{constructor(e,t,r){super(e,t),this._requestIdHeaderName=r}sendRequest(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)}}let ft;class mt extends ce{constructor(e,t){super(e,t)}async sendRequest(e){if("string"===typeof e.body&&e.body.startsWith("[")){const t=JSON.parse(e.body);Array.isArray(t)&&(e.body=t.map((e=>JSON.stringify(e)+"\n")).join(""))}return this._nextPolicy.sendRequest(e)}}const yt=new Error("ProxyPolicy is not supported in browser environment");function gt(e){}function vt(e){return{create:(e,t)=>{throw yt}}}class bt extends ce{constructor(e,t,r=30){super(e,t),this._retryTimeout=r}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).then((t=>function(e,t,r){if(409===r.status){const n=function(e){let t,r;if(e){try{r=JSON.parse(e)}catch(n){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){const e=r.error.message.match(/.*'(.*)'/i);e&&(t=e.pop())}}return t}(r.bodyAsText);if(n){const i=function(e){let t;const r=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!r||!r[0])throw new Error(`Unable to extract subscriptionId from the given url - ${e}.`);t=r[0];return t}(t.url);return async function(e,t,r,n){const i=`${t}providers/${r}/register?api-version=2016-02-01`,o=`${t}providers/${r}?api-version=2016-02-01`,s=wt(n);s.method="POST",s.url=i;if(200!==(await e._nextPolicy.sendRequest(s)).status)throw new Error(`Autoregistration of ${r} failed. Please try registering manually.`);return Ct(e,o,n)}(e,i,n,t).catch((()=>!1)).then((n=>n?(t.headers.set("x-ms-client-request-id",v()),e._nextPolicy.sendRequest(t.clone())):r))}}return Promise.resolve(r)}(this,e,t)))}}function wt(e,t=!1){const r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",v()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}async function Ct(e,t,r){const n=wt(r);n.url=t,n.method="GET";const i=await e._nextPolicy.sendRequest(n),o=i.parsedBody;return!(!i.parsedBody||!o.registrationState||"Registered"!==o.registrationState)||(await He(1e3*e._retryTimeout),Ct(e,t,r))}function Rt(e){return{create:(t,r)=>new Tt(t,r,e)}}class Tt extends ce{constructor(e,t,r){super(e,t),this.authenticationProvider=r}signRequest(e){return this.authenticationProvider.signRequest(e)}sendRequest(e){return this.signRequest(e).then((e=>this._nextPolicy.sendRequest(e)))}}function Et(e,t,r,n){return{create:(i,o)=>new St(i,o,e,t,r,n)}}class St extends ce{constructor(e,t,r,n,i,o){super(e,t),this.retryCount=$e(r)?r:3,this.retryInterval=$e(n)?n:ze,this.minRetryInterval=$e(i)?i:3e3,this.maxRetryInterval=$e(o)?o:je}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).catch((t=>xt(this,e,t.response,t)))}}async function xt(e,t,r,n,i){if(i=De(e,i,n),!Ue(e.retryCount,(function(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}),i,r,n))return n?Promise.reject(i.error):r;try{return await He(i.retryInterval),e._nextPolicy.sendRequest(t.clone())}catch(o){return xt(e,t,r,o,i)}}const Pt=Le.HttpConstants.StatusCodes;function Ot(){return{create:(e,t)=>new At(e,t)}}const Nt="The operation was aborted.";class At extends ce{constructor(e,t,r){super(e,t),this.numberOfRetries=0,this._handleResponse=r||this._defaultResponseHandler}async sendRequest(e){const t=await this._nextPolicy.sendRequest(e.clone());return t.status!==Pt.TooManyRequests&&t.status!==Pt.ServiceUnavailable?t:this._handleResponse(e,t)}async _defaultResponseHandler(e,t){var r;const n=t.headers.get(Le.HeaderConstants.RETRY_AFTER);if(n){const t=At.parseRetryAfterHeader(n);if(t){if(this.numberOfRetries+=1,await He(t,{abortSignal:e.abortSignal,abortErrorMsg:Nt}),null===(r=e.abortSignal)||void 0===r?void 0:r.aborted)throw new $._(Nt);return this.numberOfRetries<3?this.sendRequest(e):this._nextPolicy.sendRequest(e)}}return t}static parseRetryAfterHeader(e){const t=Number(e);return Number.isNaN(t)?At.parseDateRetryAfterHeader(e):1e3*t}static parseDateRetryAfterHeader(e){try{const t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(t){return}}}var Mt="object"===typeof globalThis?globalThis:"object"===typeof self?self:"object"===typeof window?window:"object"===typeof r.g?r.g:{},It="1.4.0",qt=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var _t=function(e){var t=new Set([e]),r=new Set,n=e.match(qt);if(!n)return function(){return!1};var i=+n[1],o=+n[2],s=+n[3];if(null!=n[4])return function(t){return t===e};function a(e){return r.add(e),!1}function c(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var n=e.match(qt);if(!n)return a(e);var u=+n[1],l=+n[2],d=+n[3];return null!=n[4]||i!==u?a(e):0===i?o===l&&s<=d?c(e):a(e):o<=l?c(e):a(e)}}(It),kt=It.split(".")[0],zt=Symbol.for("opentelemetry.js.api."+kt),jt=Mt;function $t(e,t,r,n){var i;void 0===n&&(n=!1);var o=jt[zt]=null!==(i=jt[zt])&&void 0!==i?i:{version:It};if(!n&&o[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(s.stack||s.message),!1}if(o.version!==It){s=new Error("@opentelemetry/api: All API registration versions must match");return r.error(s.stack||s.message),!1}return o[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+"1.4.0."),!0}function Ut(e){var t,r,n=null===(t=jt[zt])||void 0===t?void 0:t.version;if(n&&_t(n))return null===(r=jt[zt])||void 0===r?void 0:r[e]}function Dt(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+"1.4.0.");var r=jt[zt];r&&delete r[e]}var Lt,Bt=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,n){var i=new e(r._currentContext);return i._currentContext.set(t,n),i},r.deleteValue=function(t){var n=new e(r._currentContext);return n._currentContext.delete(t),n}},Ht=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},Ft=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Vt=function(){function e(){}return e.prototype.active=function(){return Bt},e.prototype.with=function(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return t.call.apply(t,Ft([r],Ht(n),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),Wt=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},Kt=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Qt=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt("verbose",this._namespace,e)},e}();function Xt(e,t,r){var n=Ut("diag");if(n)return r.unshift(t),n[e].apply(n,Kt([],Wt(r),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(Lt||(Lt={}));var Gt,Jt=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},Yt=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Zt=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=Ut("diag");if(n)return n[e].apply(n,Yt([],Jt(t),!1))}}var t=this;t.setLogger=function(e,r){var n,i,o;if(void 0===r&&(r={logLevel:Lt.INFO}),e===t){var s=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=s.stack)&&void 0!==n?n:s.message),!1}"number"===typeof r&&(r={logLevel:r});var a=Ut("diag"),c=function(e,t){function r(r,n){var i=t[r];return"function"===typeof i&&e>=n?i.bind(t):function(){}}return e<Lt.NONE?e=Lt.NONE:e>Lt.ALL&&(e=Lt.ALL),t=t||{},{error:r("error",Lt.ERROR),warn:r("warn",Lt.WARN),info:r("info",Lt.INFO),debug:r("debug",Lt.DEBUG),verbose:r("verbose",Lt.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:Lt.INFO,e);if(a&&!r.suppressOverrideMessage){var u=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+u),c.warn("Current logger will overwrite one already registered from "+u)}return $t("diag",c,t,!0)},t.disable=function(){Dt("diag",t)},t.createComponentLogger=function(e){return new Qt(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),er=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},tr=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},rr="context",nr=new Vt,ir=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return $t(rr,e,Zt.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var n,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return(n=this._getContextManager()).with.apply(n,tr([e,t,r],er(i),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Ut(rr)||nr},e.prototype.disable=function(){this._getContextManager().disable(),Dt(rr,Zt.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Gt||(Gt={}));var or,sr="0000000000000000",ar="00000000000000000000000000000000",cr={traceId:ar,spanId:sr,traceFlags:Gt.NONE},ur=function(){function e(e){void 0===e&&(e=cr),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),lr=(or="OpenTelemetry Context Key SPAN",Symbol.for(or));function dr(e){return e.getValue(lr)||void 0}function pr(){return dr(ir.getInstance().active())}function hr(e,t){return e.setValue(lr,t)}function fr(e){return e.deleteValue(lr)}function mr(e,t){return hr(e,new ur(t))}function yr(e){var t;return null===(t=dr(e))||void 0===t?void 0:t.spanContext()}var gr=/^([0-9a-f]{32})$/i,vr=/^[0-9a-f]{16}$/i;function br(e){return r=e.traceId,gr.test(r)&&r!==ar&&(t=e.spanId,vr.test(t)&&t!==sr);var t,r}function wr(e){return new ur(e)}var Cr=ir.getInstance(),Rr=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=Cr.active()),Boolean(null===t||void 0===t?void 0:t.root))return new ur;var n,i=r&&yr(r);return"object"===typeof(n=i)&&"string"===typeof n.spanId&&"string"===typeof n.traceId&&"number"===typeof n.traceFlags&&br(i)?new ur(i):new ur},e.prototype.startActiveSpan=function(e,t,r,n){var i,o,s;if(!(arguments.length<2)){2===arguments.length?s=t:3===arguments.length?(i=t,s=r):(i=t,o=r,s=n);var a=null!==o&&void 0!==o?o:Cr.active(),c=this.startSpan(e,i,a),u=hr(a,c);return Cr.with(u,s,void 0,c)}},e}();var Tr,Er=new Rr,Sr=function(){function e(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Er},e}(),xr=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new Rr},e}()),Pr=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var n;return null!==(n=this.getDelegateTracer(e,t,r))&&void 0!==n?n:new Sr(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:xr},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,r)},e}(),Or="trace",Nr=function(){function e(){this._proxyTracerProvider=new Pr,this.wrapSpanContext=wr,this.isSpanContextValid=br,this.deleteSpan=fr,this.getSpan=dr,this.getActiveSpan=pr,this.getSpanContext=yr,this.setSpan=hr,this.setSpanContext=mr}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=$t(Or,this._proxyTracerProvider,Zt.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return Ut(Or)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){Dt(Or,Zt.instance()),this._proxyTracerProvider=new Pr},e}().getInstance(),Ar=ir.getInstance();function Mr(e,t){return Nr.setSpan(e,t)}!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Tr||(Tr={}));const Ir=Ar;var qr;!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(qr||(qr={}));var _r=r(4155);function kr(e){return function(t,r){const n=Nr.getTracer(i||"azure/core-tracing",o);var i,o;const s=(null===r||void 0===r?void 0:r.tracingOptions)||{},a=Object.assign({kind:Tr.INTERNAL},s.spanOptions),c=e.packagePrefix?`${e.packagePrefix}.${t}`:t;let u;u=function(){var e;if("undefined"===typeof _r)return!1;const t=null===(e=_r.env.AZURE_TRACING_DISABLED)||void 0===e?void 0:e.toLowerCase();return"false"!==t&&"0"!==t&&Boolean(t)}()?Nr.wrapSpanContext(cr):n.startSpan(c,a,s.tracingContext),e.namespace&&u.setAttribute("az.namespace",e.namespace);let l=s.spanOptions||{};u.isRecording()&&e.namespace&&(l=Object.assign(Object.assign({},s.spanOptions),{attributes:Object.assign(Object.assign({},a.attributes),{"az.namespace":e.namespace})}));const d=Object.assign(Object.assign({},s),{spanOptions:l,tracingContext:Mr(s.tracingContext||Ir.active(),u)});return{span:u,updatedOptions:Object.assign(Object.assign({},r),{tracingOptions:d})}}}const zr=kr({packagePrefix:"",namespace:""});function jr(e={}){return{create:(t,r)=>new $r(t,r,e)}}class $r extends ce{constructor(e,t,r){super(e,t),this.userAgent=r.userAgent}async sendRequest(e){if(!e.tracingContext)return this._nextPolicy.sendRequest(e);const t=this.tryCreateSpan(e);if(!t)return this._nextPolicy.sendRequest(e);try{const r=await this._nextPolicy.sendRequest(e);return this.tryProcessResponse(t,r),r}catch(r){throw this.tryProcessError(t,r),r}}tryCreateSpan(e){var t;try{const{span:r}=zr(`HTTP ${e.method}`,{tracingOptions:{spanOptions:Object.assign(Object.assign({},e.spanOptions),{kind:Tr.CLIENT}),tracingContext:e.tracingContext}});if(!r.isRecording())return void r.end();const n=null===(t=e.tracingContext)||void 0===t?void 0:t.getValue(Symbol.for("az.namespace"));"string"===typeof n&&r.setAttribute("az.namespace",n),r.setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&r.setAttribute("http.user_agent",this.userAgent);const i=r.spanContext(),o=function(e){const t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),t.length)return;const r=(e.traceFlags||0).toString(16),n=1===r.length?`0${r}`:r;return`00-${e.traceId}-${e.spanId}-${n}`}(i);if(o&&function(e){return Nr.isSpanContextValid(e)}(i)){e.headers.set("traceparent",o);const t=i.traceState&&i.traceState.serialize();t&&e.headers.set("tracestate",t)}return r}catch(r){return void Fe.warning(`Skipping creating a tracing span due to an error: ${r.message}`)}}tryProcessError(e,t){try{e.setStatus({code:qr.ERROR,message:t.message}),t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(r){Fe.warning(`Skipping tracing span processing due to an error: ${r.message}`)}}tryProcessResponse(e,t){try{e.setAttribute("http.status_code",t.status);const r=t.headers.get("x-ms-request-id");r&&e.setAttribute("serviceRequestId",r),e.setStatus({code:qr.OK}),e.end()}catch(r){Fe.warning(`Skipping tracing span processing due to an error: ${r.message}`)}}}class Ur{constructor(e,t){let r;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||(ft||(ft=new re),ft),this._requestPolicyOptions=new ue(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))Fe.info("ServiceClient: using custom request policies"),r=t.requestPolicyFactories;else{let n;if(et(e)){Fe.info("ServiceClient: creating bearer token authentication policy from provided credentials");n=(()=>{let r;const n=this,i=t;return{create(t,o){const s=function(e,t){if(null===e||void 0===e?void 0:e.credentialScopes){const t=e.credentialScopes;return Array.isArray(t)?t.map((e=>new URL(e).toString())):new URL(t).toString()}if(t)return`${t}/.default`;return}(i,n.baseUri);if(!s)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return void 0!==r&&null!==r||(r=ut(e,s)),r.create(t,o)}}})()}else if(e&&"function"===typeof e.signRequest)Fe.info("ServiceClient: creating signing policy from provided credentials"),n=Rt(e);else if(void 0!==e&&null!==e)throw new Error("The credentials argument must implement the TokenCredential interface");if(Fe.info("ServiceClient: using default request policies"),r=function(e,t){const r=[];t.generateClientRequestIdHeader&&r.push(pt(t.clientRequestIdHeaderName));e&&r.push(e);const n=Dr(t.userAgentHeaderName,rt),i=Dr(t.userAgent,nt);n&&i&&r.push(it({key:n,value:i}));r.push(qe()),r.push(function(e=30){return{create:(t,r)=>new bt(t,r,e)}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(r.push(Ve()),r.push(Et()),r.push(Ot()));r.push(Re(t.deserializationContentTypes)),h&&r.push(vt(t.proxySettings));return r.push(Ge({logger:Fe.info})),r}(n,t),t.requestPolicyFactories){const e=t.requestPolicyFactories(r);e&&(r=e)}}this._requestPolicyFactories=r}sendRequest(e){if(null===e||void 0===e||"object"!==typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");let t;try{!function(e){if(e&&"object"===typeof e){const t=e;if("string"===typeof t.url&&"string"===typeof t.method&&"object"===typeof t.headers&&i(t.headers)&&"function"===typeof t.validateRequestProperties&&"function"===typeof t.prepare&&"function"===typeof t.clone)return!0}return!1}(e)?(t=new j,t=t.prepare(e)):(e.validateRequestProperties(),t=e)}catch(n){return Promise.reject(n)}let r=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(let i=this._requestPolicyFactories.length-1;i>=0;--i)r=this._requestPolicyFactories[i].create(r,this._requestPolicyOptions);return r.sendRequest(t)}async sendOperationRequest(e,t,r){var n;"function"===typeof e.options&&(r=e.options,e.options=void 0);const i=null===(n=e.options)||void 0===n?void 0:n.serializerOptions,o=new j;let s;try{const r=t.baseUrl||this.baseUri;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");o.method=t.httpMethod,o.operationSpec=t;const n=D.parse(r);if(t.path&&n.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(const o of t.urlParameters){let r=Br(this,e,o,t.serializer);r=t.serializer.serialize(o.mapper,r,Ye(o),i),o.skipEncoding||(r=encodeURIComponent(r)),n.replaceAll(`{${o.mapper.serializedName||Ye(o)}}`,r)}if(t.queryParameters&&t.queryParameters.length>0)for(const o of t.queryParameters){let r=Br(this,e,o,t.serializer);if(void 0!==r&&null!==r){if(r=t.serializer.serialize(o.mapper,r,Ye(o),i),void 0!==o.collectionFormat&&null!==o.collectionFormat)if(o.collectionFormat===st.Multi){if(0===r.length)continue;for(const e in r){const t=r[e];r[e]=void 0===t||null===t?"":t.toString()}}else o.collectionFormat!==st.Ssv&&o.collectionFormat!==st.Tsv||(r=r.join(o.collectionFormat));if(!o.skipEncoding)if(Array.isArray(r))for(const e in r)void 0!==r[e]&&null!==r[e]&&(r[e]=encodeURIComponent(r[e]));else r=encodeURIComponent(r);void 0!==o.collectionFormat&&null!==o.collectionFormat&&o.collectionFormat!==st.Multi&&o.collectionFormat!==st.Ssv&&o.collectionFormat!==st.Tsv&&(r=r.join(o.collectionFormat)),n.setQueryParameter(o.mapper.serializedName||Ye(o),r)}}o.url=n.toString();const a=t.contentType||this.requestContentType;if(a&&t.requestBody&&o.headers.set("Content-Type",a),t.headerParameters)for(const s of t.headerParameters){let r=Br(this,e,s,t.serializer);if(void 0!==r&&null!==r){r=t.serializer.serialize(s.mapper,r,Ye(s),i);const e=s.mapper.headerCollectionPrefix;if(e)for(const t of Object.keys(r))o.headers.set(e+t,r[t]);else o.headers.set(s.mapper.serializedName||Ye(s),r)}}const d=e.options;if(d){if(d.customHeaders)for(const e in d.customHeaders)o.headers.set(e,d.customHeaders[e]);d.abortSignal&&(o.abortSignal=d.abortSignal),d.timeout&&(o.timeout=d.timeout),d.onUploadProgress&&(o.onUploadProgress=d.onUploadProgress),d.onDownloadProgress&&(o.onDownloadProgress=d.onDownloadProgress),d.spanOptions&&(o.spanOptions=d.spanOptions),d.tracingContext&&(o.tracingContext=d.tracingContext),void 0!==d.shouldDeserialize&&null!==d.shouldDeserialize&&(o.shouldDeserialize=d.shouldDeserialize)}let p,h;o.withCredentials=this._withCredentials,function(e,t,r,n){var i,o,s,a,l,d;const p=null!==(o=null===(i=r.options)||void 0===i?void 0:i.serializerOptions)&&void 0!==o?o:{},h={rootName:null!==(s=p.rootName)&&void 0!==s?s:"",includeRoot:null!==(a=p.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(l=p.xmlCharKey)&&void 0!==l?l:u},f=p.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=Br(e,r,n.requestBody,n.serializer);const i=n.requestBody.mapper,{required:o,xmlName:s,xmlElementName:a,serializedName:u,xmlNamespace:l,xmlNamespacePrefix:p}=i,y=i.type.name;try{if(void 0!==t.body&&null!==t.body||o){const e=Ye(n.requestBody);t.body=n.serializer.serialize(i,t.body,e,h);const r=y===z.Stream;if(n.isXML){const e=p?`xmlns:${p}`:"xmlns",n=function(e,t,r,n,i){if(e&&!["Composite","Sequence","Dictionary"].includes(r)){const r={};return r[i.xmlCharKey]=n,r[c]={[t]:e},r}return n}(l,e,y,t.body,h);y===z.Sequence?t.body=be(function(e,t,r,n){if(Array.isArray(e)||(e=[e]),!r||!n)return{[t]:e};const i={[t]:e};return i[c]={[r]:n},i}(n,a||s||u,e,l),{rootName:s||u,xmlCharKey:f}):r||(t.body=be(n,{rootName:s||u,xmlCharKey:f}))}else{if(y===z.String&&((null===(d=n.contentType)||void 0===d?void 0:d.match("text/plain"))||"text"===n.mediaType))return;r||(t.body=JSON.stringify(t.body))}}}catch(m){throw new Error(`Error "${m.message}" occurred in serializing the payload - ${JSON.stringify(u,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const i of n.formDataParameters){const o=Br(e,r,i,n.serializer);if(void 0!==o&&null!==o){const e=i.mapper.serializedName||Ye(i);t.formData[e]=n.serializer.serialize(i.mapper,o,Ye(i),h)}}}}(this,o,e,t),void 0===o.streamResponseStatusCodes&&(o.streamResponseStatusCodes=function(e){const t=new Set;for(const r in e.responses){const n=e.responses[r];n.bodyMapper&&n.bodyMapper.type.name===z.Stream&&t.add(Number(r))}return t}(t));try{p=await this.sendRequest(o)}catch(l){h=l}h?(h.response&&(h.details=Vr(h.response,t.responses[h.statusCode]||t.responses.default)),s=Promise.reject(h)):s=Promise.resolve(Vr(p,t.responses[p.status]))}catch(l){s=Promise.reject(l)}const a=r;return a&&s.then((e=>a(null,e._response.parsedBody,e._response.request,e._response))).catch((e=>a(e))),s}}function Dr(e,t){let r;return"string"===typeof e?r=e:(r=t(),"function"===typeof e&&(r=e(r))),r}function Lr(e,t){const r=[];let n;if(e.sendStreamingJson&&r.push({create:(e,t)=>new mt(e,t)}),e.userAgentOptions&&e.userAgentOptions.userAgentPrefix){const t=[];t.push(e.userAgentOptions.userAgentPrefix);const r=nt();-1===t.indexOf(r)&&t.push(r),n=t.join(" ")}const i=Object.assign(Object.assign({},Oe),e.keepAliveOptions),o=Object.assign(Object.assign({},Ke),e.retryOptions),s=Object.assign(Object.assign({},Ie),e.redirectOptions);h&&r.push(vt(e.proxyOptions));const a=Object.assign(Object.assign({},Se),e.deserializationOptions),c=Object.assign({},e.loggingOptions);return r.push(jr({userAgent:n}),Ne(i),it({value:n}),pt(),Re(a.expectedContentTypes),Ot(),Et(),Ve(o.maxRetries,o.retryDelayInMs,o.maxRetryDelayInMs)),s.handleRedirects&&r.push(qe(s.maxRetries)),t&&r.push(t),r.push(Ge(c)),h&&!1===e.decompressResponse&&r.push(dt()),{httpClient:e.httpClient,requestPolicyFactories:r}}function Br(e,t,r,n){return Hr(e,t,r.parameterPath,r.mapper,n)}function Hr(e,t,r,n,i){var o;let s;"string"===typeof r&&(r=[r]);const a=null===(o=t.options)||void 0===o?void 0:o.serializerOptions;if(Array.isArray(r)){if(r.length>0){if(n.isConstant)s=n.defaultValue;else{let i=Fr(t,r);i.propertyFound||(i=Fr(e,r));let o=!1;i.propertyFound||(o=n.required||"options"===r[0]&&2===r.length),s=o?n.defaultValue:i.propertyValue}const o=Ze(r,n);i.serialize(n,s,o,a)}}else{n.required&&(s={});for(const o in r){const c=n.type.modelProperties[o],u=r[o],l=Hr(e,t,u,c,i),d=Ze(u,c);i.serialize(c,l,d,a),void 0!==l&&null!==l&&(s||(s={}),s[o]=l)}}return s}function Fr(e,t){const r={propertyFound:!1};let n=0;for(;n<t.length;++n){const r=t[n];if(void 0===e||null===e||!(r in e))break;e=e[r]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function Vr(e,t){const r=e.parsedHeaders,n=t&&t.bodyMapper,i=t=>Object.defineProperty(t,"_response",{value:e});if(n){const t=n.type.name;if("Stream"===t)return i(Object.assign(Object.assign({},r),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));const o="Composite"===t&&n.type.modelProperties||{},s=Object.keys(o).some((e=>""===o[e].serializedName));if("Sequence"===t||s){const t=[...e.parsedBody||[]];for(const r of Object.keys(o))o[r].serializedName&&(t[r]=e.parsedBody[r]);if(r)for(const e of Object.keys(r))t[e]=r[e];return i(t),t}if("Composite"===t||"Dictionary"===t)return i(Object.assign(Object.assign({},r),e.parsedBody))}return n||"HEAD"===e.request.method||("object"!==typeof(o=e.parsedBody)&&"function"!==typeof o||null===o)?i(Object.assign(Object.assign({},r),{body:e.parsedBody})):i(Object.assign(Object.assign({},r),e.parsedBody));var o}function Wr(e){return kr(e)}class Kr{constructor(e=12e4){this.cachedToken=void 0,this.tokenRefreshBufferMs=e}setCachedToken(e){this.cachedToken=e}getCachedToken(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken}}class Qr{constructor(e,t,r=3e4){this.credential=e,this.scopes=t,this.requiredMillisecondsBeforeNewRefresh=r,this.lastCalled=0}isReady(){return!this.lastCalled||Date.now()-this.lastCalled>this.requiredMillisecondsBeforeNewRefresh}async getToken(e){this.lastCalled=Date.now();const t=await this.credential.getToken(this.scopes,e);return this.promise=void 0,t||void 0}refresh(e){return this.promise||(this.promise=this.getToken(e)),this.promise}}const Xr=Le.HeaderConstants,Gr="Basic";class Jr{constructor(e,t,r="Basic"){if(this.authorizationScheme=Gr,null===e||void 0===e||"string"!==typeof e.valueOf())throw new Error("userName cannot be null or undefined and must be of type string.");if(null===t||void 0===t||"string"!==typeof t.valueOf())throw new Error("password cannot be null or undefined and must be of type string.");this.userName=e,this.password=t,this.authorizationScheme=r}signRequest(e){const t=`${this.userName}:${this.password}`,r=`${this.authorizationScheme} ${n=t,btoa(n)}`;var n;return e.headers||(e.headers=new o),e.headers.set(Xr.AUTHORIZATION,r),Promise.resolve(e)}}class Yr{constructor(e){if(!e||e&&!e.inHeader&&!e.inQuery)throw new Error('options cannot be null or undefined. Either "inHeader" or "inQuery" property of the options object needs to be provided.');this.inHeader=e.inHeader,this.inQuery=e.inQuery}signRequest(e){if(!e)return Promise.reject(new Error('webResource cannot be null or undefined and must be of type "object".'));if(this.inHeader){e.headers||(e.headers=new o);for(const t in this.inHeader)e.headers.set(t,this.inHeader[t])}if(this.inQuery){if(!e.url)return Promise.reject(new Error("url cannot be null in the request object."));e.url.indexOf("?")<0&&(e.url+="?");for(const t in this.inQuery)e.url.endsWith("?")||(e.url+="&"),e.url+=`${t}=${this.inQuery[t]}`}return Promise.resolve(e)}}class Zr extends Yr{constructor(e){if(!e||e&&"string"!==typeof e)throw new Error("topicKey cannot be null or undefined and must be of type string.");super({inHeader:{"aeg-sas-key":e}})}}},8417:function(e,t,r){"use strict";r.d(t,{YR:function(){return T}});var n=r(8955);const i="undefined"!==typeof n&&n.env&&n.env.DEBUG||void 0;let o,s=[],a=[];const c=[];i&&l(i);const u=Object.assign((e=>p(e)),{enable:l,enabled:d,disable:function(){const e=o||"";return l(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function l(e){o=e,s=[],a=[];const t=/\*/g,r=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const n of r)n.startsWith("-")?a.push(new RegExp(`^${n.substr(1)}$`)):s.push(new RegExp(`^${n}$`));for(const n of c)n.enabled=d(n.namespace)}function d(e){if(e.endsWith("*"))return!0;for(const t of a)if(t.test(e))return!1;for(const t of s)if(t.test(e))return!0;return!1}function p(e){const t=Object.assign((function(...r){if(!t.enabled)return;r.length>0&&(r[0]=`${e} ${r[0]}`);t.log(...r)}),{enabled:d(e),destroy:h,log:u.log,namespace:e,extend:f});return c.push(t),t}function h(){const e=c.indexOf(this);return e>=0&&(c.splice(e,1),!0)}function f(e){const t=p(`${this.namespace}:${e}`);return t.log=this.log,t}var m=u,y=r(8955);const g=new Set,v="undefined"!==typeof y&&y.env&&y.env.AZURE_LOG_LEVEL||void 0;let b;const w=m("azure");w.log=(...e)=>{m.log(...e)};const C=["verbose","info","warning","error"];v&&(P(v)?function(e){if(e&&!P(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${C.join(",")}`);b=e;const t=[];for(const r of g)x(r)&&t.push(r.namespace);m.enable(t.join(","))}(v):console.error(`AZURE_LOG_LEVEL set to unknown log level '${v}'; logging is not enabled. Acceptable values: ${C.join(", ")}.`));const R={verbose:400,info:300,warning:200,error:100};function T(e){const t=w.extend(e);return E(w,t),{error:S(t,"error"),warning:S(t,"warning"),info:S(t,"info"),verbose:S(t,"verbose")}}function E(e,t){t.log=(...t)=>{e.log(...t)}}function S(e,t){const r=Object.assign(e.extend(t),{level:t});if(E(e,r),x(r)){const e=m.disable();m.enable(e+","+r.namespace)}return g.add(r),r}function x(e){return!!(b&&R[e.level]<=R[b])}function P(e){return C.includes(e)}},5193:function(e,t,r){"use strict";r.d(t,{zx:function(){return T},hU:function(){return x}});var n=r(7375),i=r(5993),o=r(4592),s=r(8554),a=r.n(s),c=r(7294),u=r(6450),l=r(9609);function d(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var h=["size","colorScheme","variant","className","spacing","isAttached","isDisabled"],f=(0,u.kr)({strict:!1,name:"ButtonGroupContext"}),m=f[0],y=f[1],g=(0,i.Gp)((function(e,t){var r=e.size,n=e.colorScheme,s=e.variant,a=e.className,u=e.spacing,l=void 0===u?"0.5rem":u,f=e.isAttached,y=e.isDisabled,g=d(e,h),v=(0,o.cx)("chakra-button__group",a),b=c.useMemo((function(){return{size:r,colorScheme:n,variant:s,isDisabled:y}}),[r,n,s,y]),w={display:"inline-flex"};return w=p({},w,f?{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}}:{"& > *:not(style) ~ *:not(style)":{marginStart:l}}),c.createElement(m,{value:b},c.createElement(i.m$.div,p({ref:t,role:"group",__css:w,className:v},g)))}));o.Ts&&(g.displayName="ButtonGroup");var v=["label","placement","spacing","children","className","__css"],b=function(e){var t=e.label,r=e.placement,n=e.spacing,s=void 0===n?"0.5rem":n,a=e.children,u=void 0===a?c.createElement(l.$,{color:"currentColor",width:"1em",height:"1em"}):a,h=e.className,f=e.__css,m=d(e,v),y=(0,o.cx)("chakra-button__spinner",h),g="start"===r?"marginEnd":"marginStart",b=c.useMemo((function(){var e;return p(((e={display:"flex",alignItems:"center",position:t?"relative":"absolute"})[g]=t?s:0,e.fontSize="1em",e.lineHeight="normal",e),f)}),[f,t,g,s]);return c.createElement(i.m$.div,p({className:y},m,{__css:b}),u)};o.Ts&&(b.displayName="ButtonSpinner");var w=["children","className"],C=function(e){var t=e.children,r=e.className,n=d(e,w),s=c.isValidElement(t)?c.cloneElement(t,{"aria-hidden":!0,focusable:!1}):t,a=(0,o.cx)("chakra-button__icon",r);return c.createElement(i.m$.span,p({display:"inline-flex",alignSelf:"center",flexShrink:0},n,{className:a}),s)};o.Ts&&(C.displayName="ButtonIcon");var R=["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"],T=(0,i.Gp)((function(e,t){var r=y(),s=(0,i.mq)("Button",p({},r,e)),u=(0,i.Lr)(e),l=u.isDisabled,h=void 0===l?null==r?void 0:r.isDisabled:l,f=u.isLoading,m=u.isActive,g=u.isFullWidth,v=u.children,w=u.leftIcon,C=u.rightIcon,T=u.loadingText,S=u.iconSpacing,x=void 0===S?"0.5rem":S,P=u.type,O=u.spinner,N=u.spinnerPlacement,A=void 0===N?"start":N,M=u.className,I=u.as,q=d(u,R),_=c.useMemo((function(){var e,t=a()({},null!=(e=null==s?void 0:s._focus)?e:{},{zIndex:1});return p({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:g?"100%":"auto"},s,!!r&&{_focus:t})}),[s,r,g]),k=function(e){var t=c.useState(!e),r=t[0],n=t[1];return{ref:c.useCallback((function(e){e&&n("BUTTON"===e.tagName)}),[]),type:r?"button":void 0}}(I),z=k.ref,j=k.type,$={rightIcon:C,leftIcon:w,iconSpacing:x,children:v};return c.createElement(i.m$.button,p({disabled:h||f,ref:(0,n.qq)(t,z),as:I,type:null!=P?P:j,"data-active":(0,o.PB)(m),"data-loading":(0,o.PB)(f),__css:_,className:(0,o.cx)("chakra-button",M)},q),f&&"start"===A&&c.createElement(b,{className:"chakra-button__spinner--start",label:T,placement:"start",spacing:x},O),f?T||c.createElement(i.m$.span,{opacity:0},c.createElement(E,$)):c.createElement(E,$),f&&"end"===A&&c.createElement(b,{className:"chakra-button__spinner--end",label:T,placement:"end",spacing:x},O))}));function E(e){var t=e.leftIcon,r=e.rightIcon,n=e.children,i=e.iconSpacing;return c.createElement(c.Fragment,null,t&&c.createElement(C,{marginEnd:i},t),n,r&&c.createElement(C,{marginStart:i},r))}o.Ts&&(T.displayName="Button");var S=["icon","children","isRound","aria-label"],x=(0,i.Gp)((function(e,t){var r=e.icon,n=e.children,i=e.isRound,o=e["aria-label"],s=d(e,S),a=r||n,u=c.isValidElement(a)?c.cloneElement(a,{"aria-hidden":!0,focusable:!1}):null;return c.createElement(T,p({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":o},s),u)}));o.Ts&&(x.displayName="IconButton")},9609:function(e,t,r){"use strict";r.d(t,{$:function(){return d}});var n=r(917),i=r(5993),o=r(4592),s=r(1358),a=r(7294);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var u=["label","thickness","speed","emptyColor","className"],l=(0,n.F4)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),d=(0,i.Gp)((function(e,t){var r=(0,i.mq)("Spinner",e),n=(0,i.Lr)(e),d=n.label,p=void 0===d?"Loading...":d,h=n.thickness,f=void 0===h?"2px":h,m=n.speed,y=void 0===m?"0.45s":m,g=n.emptyColor,v=void 0===g?"transparent":g,b=n.className,w=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(n,u),C=(0,o.cx)("chakra-spinner",b),R=c({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:f,borderBottomColor:v,borderLeftColor:v,animation:l+" "+y+" linear infinite"},r);return a.createElement(i.m$.div,c({ref:t,__css:R,className:C},w),p&&a.createElement(s.TX,null,p))}));o.Ts&&(d.displayName="Spinner")},1358:function(e,t,r){"use strict";r.d(t,{TX:function(){return s},NL:function(){return o}});var n=r(5993),i=r(4592),o={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},s=(0,n.m$)("span",{baseStyle:o});i.Ts&&(s.displayName="VisuallyHidden");var a=(0,n.m$)("input",{baseStyle:o});i.Ts&&(a.displayName="VisuallyHiddenInput")},9742:function(e,t){"use strict";t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=c(e),s=o[0],a=o[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),l=0,d=a>0?s-4:s;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[l++]=255&t);1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,c=n-i;a<c;a+=s)o.push(u(e,a,a+s>c?c:a+s));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:function(e,t,r){"use strict";var n=r(9742),i=r(645),o="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50;var s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,r)}function u(e,t,r){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|m(e,t),n=a(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(B(e,SharedArrayBuffer)||e&&B(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);var i=function(e){if(c.isBuffer(e)){var t=0|f(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!==typeof e.length||H(e.length)?a(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return l(e),a(e<0?0:0|f(e))}function p(e){for(var t=e.length<0?0:0|f(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(e).length;default:if(i)return n?-1:U(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return N(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return x(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),H(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var d=!0,p=0;p<c;p++)if(u(e,o+p)!==u(t,p)){d=!1;break}if(d)return o}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(H(a))return s;e[r+s]=a}return s}function C(e,t,r,n){return L(U(t,e.length-r),e,r,n)}function R(e,t,r,n){return L(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function T(e,t,r,n){return R(e,t,r,n)}function E(e,t,r,n){return L(D(t),e,r,n)}function S(e,t,r,n){return L(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function P(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128===(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128===(192&o)&&128===(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=d}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"===typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return d(e)},c.allocUnsafeSlow=function(e){return d(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(B(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(B(o,Uint8Array)&&(o=c.from(o)),!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?P(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(B(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),l=e.slice(t,r),d=0;d<a;++d)if(u[d]!==l[d]){o=u[d],s=l[d];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return C(this,e,t,r);case"ascii":return R(this,e,t,r);case"latin1":case"binary":return T(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function N(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=F[e[o]];return i}function I(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function q(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function _(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function k(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function z(e,t,r,n,o){return t=+t,r>>>=0,o||k(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function j(e,t,r,n,o){return t=+t,r>>>=0,o||k(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||q(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||q(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return e>>>=0,t||q(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||q(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||q(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||q(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||q(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||q(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||q(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||q(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||q(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||q(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||q(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||q(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||q(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||q(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||q(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||q(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);_(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);_(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,r){return z(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return z(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return j(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return j(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;o>=0;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},c.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=c.isBuffer(e)?e:c.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var $=/[^+/0-9A-Za-z-_]/g;function U(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function D(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function L(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function H(e){return e!==e}var F=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},7187:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"===typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var u=c.length,l=f(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},645:function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?i-1:0,p=r?-1:1,h=e[t+d];for(d+=p,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+e[t+d],d+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),o-=u}return(h?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+h]=255&a,h+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+h]=255&s,h+=f,s/=256,u-=8);e[r+h-f]|=128*m}},5934:function(e,t,r){"use strict";var n;r.d(t,{Z:function(){return d}});var i=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=function(e){return"string"===typeof e&&s.test(e)},c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};var d=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)}}}]);