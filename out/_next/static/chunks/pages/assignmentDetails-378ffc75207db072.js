(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1451],{1391:function(e,n,t){"use strict";t.d(n,{Ph:function(){return g}});var r=t(9762),s=t(5993),i=t(4244),a=t(4592),c=t(8554),o=t.n(c),l=t(7294);function d(){return(d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function u(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}var h=["children","placeholder","className"],p=["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"],x=["children"],f=(0,s.Gp)((function(e,n){var t=e.children,r=e.placeholder,i=e.className,c=u(e,h);return l.createElement(s.m$.select,d({},c,{ref:n,className:(0,a.cx)("chakra-select",i)}),r&&l.createElement("option",{value:""},r),t)}));a.Ts&&(f.displayName="SelectField");var g=(0,s.Gp)((function(e,n){var t=(0,s.jC)("Select",e),c=(0,s.Lr)(e),h=c.rootProps,x=c.placeholder,g=c.icon,m=c.color,v=c.height,b=c.h,w=c.minH,y=c.minHeight,k=c.iconColor,C=c.iconSize;c.isFullWidth;var S=u(c,p),_=(0,a.Vl)(S,i.oE),I=_[0],E=_[1],D=(0,r.Yp)(E),O={width:"100%",height:"fit-content",position:"relative",color:m},W=o()({paddingEnd:"2rem"},t.field,{_focus:{zIndex:"unset"}});return l.createElement(s.m$.div,d({className:"chakra-select__wrapper",__css:O},I,h),l.createElement(f,d({ref:n,height:null!=b?b:v,minH:null!=w?w:y,placeholder:x},D,{__css:W}),e.children),l.createElement(j,d({"data-disabled":(0,a.PB)(D.disabled)},(k||m)&&{color:k||m},{__css:t.icon},C&&{fontSize:C}),g))}));a.Ts&&(g.displayName="Select");var m=function(e){return l.createElement("svg",d({viewBox:"0 0 24 24"},e),l.createElement("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}))},v=(0,s.m$)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),j=function(e){var n=e.children,t=void 0===n?l.createElement(m,null):n,r=u(e,x),s=l.cloneElement(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return l.createElement(v,d({},r,{className:"chakra-select__icon-wrapper"}),l.isValidElement(t)?s:null)};a.Ts&&(j.displayName="SelectIcon")},3441:function(e,n,t){"use strict";t.d(n,{g:function(){return l}});var r=t(9762),s=t(5993),i=t(4592),a=t(7294);function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var o=["className","rows"],l=(0,s.Gp)((function(e,n){var t=(0,s.mq)("Textarea",e),l=(0,s.Lr)(e),d=l.className,u=l.rows,h=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(l,o),p=(0,r.Yp)(h),x=u?(0,i.CE)(t,["h","minH","height","minHeight"]):t;return a.createElement(s.m$.textarea,c({ref:n,rows:u},p,{className:(0,i.cx)("chakra-textarea",d),__css:x}))}));i.Ts&&(l.displayName="Textarea")},6358:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/assignmentDetails",function(){return t(1234)}])},1234:function(e,n,t){"use strict";t.r(n);var r=t(8520),s=t.n(r),i=t(5893),a=t(9669),c=t.n(a),o=t(7294),l=t(8756),d=t(1163),u=t(7388),h=t(6257),p=t(2028),x=t(4612),f=t(9762),g=t(3441),m=t(5193),v=t(7375),j=t(8790),b=t(1391),w=t(9736);function y(e,n,t,r,s,i,a){try{var c=e[i](a),o=c.value}catch(l){return void t(l)}c.done?n(o):Promise.resolve(o).then(r,s)}function k(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function a(e){y(i,r,s,a,c,"next",e)}function c(e){y(i,r,s,a,c,"throw",e)}a(void 0)}))}}n.default=function(){var e=function(){return(0,i.jsxs)(p.u_,{size:"2xl",onClose:se.onClose,isOpen:se.isOpen,onOpen:se.onOpen,isCentered:!0,children:[(0,i.jsx)(p.ZA,{}),(0,i.jsxs)(p.hz,{children:[(0,i.jsx)(p.xB,{children:"Rework Request"}),(0,i.jsx)(p.ol,{}),(0,i.jsx)(p.fe,{children:(0,i.jsxs)(x.BZ,{flexDirection:"column",children:[(0,i.jsx)(f.lX,{children:"Add Comments For Experts"}),(0,i.jsx)(g.g,{id:"reworkComment"})]})}),(0,i.jsx)(p.mz,{children:(0,i.jsx)(m.zx,{onClick:function(){!function(){ce.apply(this,arguments)}()},children:"Send"})})]})]})},n=(0,o.useState)(),t=n[0],r=n[1],a=(0,o.useState)(!0),y=a[0],C=a[1],S=(0,o.useState)([]),_=S[0],I=S[1],E=(0,o.useState)(""),D=E[0],O=E[1],W=(0,o.useState)(""),F=(W[0],W[1]),P=(0,o.useState)(""),U=P[0],N=P[1],R=(0,d.useRouter)(),T=(0,v.qY)(),z=T.isOpen,A=T.onOpen,B=T.onClose,H=(0,o.useRef)(null),J=(0,o.useState)(""),L=J[0],q=J[1],X=(0,o.useState)([]),Y=X[0],Z=X[1],M=(0,o.useState)({_id:"INR",INRFactor:"1"}),Q=M[0],$=M[1],G=[];function K(){return V.apply(this,arguments)}function V(){return(V=k(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==localStorage.getItem("clientToken")&&R.replace("/"),e.next=5,c().post(l.JW+"/util/currency/fetch");case 5:if(n=e.sent,t=n.data.res,G=[],0!==t.length)for(r=0;r<t.length;r++)G.push({_id:t[r]._id,INRFactor:t[r].INRFactor});else console.log("No Currencies");Z(G),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function ee(){return ne.apply(this,arguments)}function ne(){return(ne=k(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().get(l.JW+"/util/sas-token?container_name=assignment-dscp");case 3:n=e.sent,(t=n.data).success&&q(t.SASToken),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function te(){return re.apply(this,arguments)}function re(){return(re=k(s().mark((function e(){var n,t,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==(n=localStorage.getItem("clientToken"))&&R.replace("/"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=6,c().get(l.JW+"/assignment/fetch?_id="+R.query.assignmentID,t);case 6:return i=e.sent,e.next=9,i.data.assignmentData;case 9:if(0===(a=e.sent).length){e.next=22;break}return r({id:a[0]._id,assignedExpert:a[0].assignedExpert,assignedOperator:a[0].assignedOperator,assignedSales:a[0].assignedSales,client_id:a[0].client_id,subject:a[0].subject,status:a[0].status,quotation:a[0].quotation,currencyOfQuote:a[0].currencyOfQuote,createdAt:new Date(a[0].createdAt).toLocaleTimeString()+", "+new Date(a[0].createdAt).toDateString(),expertDeadline:a[0].expertDeadline?new Date(a[0].expertDeadline).toLocaleTimeString()+", "+new Date(a[0].expertDeadline).toDateString():"",level:a[0].level,reference:a[0].reference,description:a[0].description,descriptionFile:a[0].descriptionFile,numOfPages:a[0].numOfPages,paid:a[0].paid,deadline:new Date(a[0].deadline).toLocaleTimeString()+", "+new Date(a[0].deadline).toDateString()}),F(a[0].assignedOperator),N(a[0].assignedSales),e.next=16,oe(a[0].assignedSales,a[0]._id);case 16:return e.next=18,K();case 18:return e.next=20,ee();case 20:e.next=23;break;case 22:console.log("Assignment Not Found");case 23:C(!1),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.log(e.t0);case 29:case"end":return e.stop()}}),e,null,[[0,26]])})))).apply(this,arguments)}(0,o.useEffect)((function(){te()}),[]);var se=(0,v.qY)();function ie(){return ae.apply(this,arguments)}function ae(){return(ae=k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se.onOpen();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(){return(ce=k(s().mark((function e(){var n,r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(n=document.getElementById("reworkComment")).value){e.next=5;break}window.alert("Add a comment"),e.next=20;break;case 5:return e.prev=5,r=localStorage.getItem("clientToken"),i={headers:{Authorization:"Bearer ".concat(r)}},e.next=10,c().post(l.JW+"/assignment/update",{_id:t.id,status:"Client Rework",clientComments:n.value},i);case 10:return e.sent,e.next=13,c().post(l.JW+"/notifications",{assignmentId:t.id,status:"Client Rework",read:!1},i);case 13:e.sent,te(),se.onClose(),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(5);case 20:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}function oe(e,n){return le.apply(this,arguments)}function le(){return(le=k(s().mark((function e(n,t){var r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n){e.next=13;break}return r=localStorage.getItem("clientEmail"),O(r),e.prev=3,i=r+"_"+n+"_"+t,e.next=7,(0,h.QT)((0,h.JU)(u.db,"chat",i));case 7:e.sent,(0,h.cf)((0,h.JU)(u.db,"chat",i),(function(e){I(e.data().conversation)})),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function de(){return ue.apply(this,arguments)}function ue(){return(ue=k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.getItem("clientEmail"),e.prev=1,e.next=4,(0,h.pl)((0,h.JU)(u.db,"sales_chat",t.id),{sales:"",assignment:t.id,time:Date.now()});case 4:e.sent,window.alert("Request Sent, Sales Will Respond Soon. Please Stay on this page."),(0,h.cf)((0,h.JU)(u.db,"sales_chat",t.id),(function(e){""!==e.data().sales&&window.location.reload()})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}return y?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(j.M5,{children:"Loading....."})}):void 0==t?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("h2",{children:"Invalid ID"})}):(0,i.jsxs)(j.gC,{alignItems:"start",margin:5,children:[(0,i.jsx)(e,{}),(0,i.jsxs)(p.u_,{closeOnOverlayClick:!1,isOpen:z,onClose:B,children:[(0,i.jsx)(p.ZA,{}),(0,i.jsxs)(p.hz,{children:[(0,i.jsx)(p.xB,{children:"File Upload"}),(0,i.jsx)(p.ol,{}),(0,i.jsx)(p.fe,{pb:6,children:"File is being uploaded, please wait.."})]})]}),(0,i.jsxs)(j.Ug,{children:[(0,i.jsx)(b.Ph,{maxW:"100px",id:"currency",onChange:function(e){$(Y[e.target.value])},children:Y.map((function(e,n){return(0,i.jsx)("option",{value:n,children:e._id},n)}))}),(0,i.jsx)(m.zx,{onClick:k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R.replace("/assignments");case 1:case"end":return e.stop()}}),e)}))),children:"Back to Assignments"}),(0,i.jsx)(m.zx,{display:void 0!==U?"none":"flex",onClick:k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de();case 2:case"end":return e.stop()}}),e)}))),children:"Chat with Sales"}),(0,i.jsx)(m.zx,{visibility:"CP2 Done"===t.status?"visible":"hidden",color:"red",onClick:k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie());case 1:case"end":return e.stop()}}),e)}))),children:"Send for Rework"})]}),(0,i.jsxs)(j.Ug,{children:[(0,i.jsxs)(j.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,i.jsx)(j.xu,{bgColor:"gray.200",p:4,children:(0,i.jsx)(j.X6,{fontSize:"xl",children:"Order Details"})}),(0,i.jsxs)(j.gC,{alignItems:"start",margin:3,minH:"sm",maxH:"sm",overflowY:"scroll",children:[(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Ordered At:"}),(0,i.jsx)(j.xv,{children:t.createdAt})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Assignment ID:"}),(0,i.jsx)(j.xv,{children:t.id})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Subject:"}),(0,i.jsx)(j.xv,{children:t.subject})]}),(0,i.jsxs)(j.gC,{padding:2,alignItems:"left",children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Description:"}),(0,i.jsx)(g.g,{width:"lg",contentEditable:!1,value:t.description,children:t.description})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Level:"}),(0,i.jsx)(j.xv,{children:t.level})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Reference:"}),(0,i.jsx)(j.xv,{children:t.reference})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Pages:"}),(0,i.jsx)(j.xv,{children:t.numOfPages})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Deadline:"}),(0,i.jsx)(j.xv,{children:t.deadline})]}),(0,i.jsx)(j.gC,{padding:2,alignItems:"left",children:0!=t.descriptionFile.length?t.descriptionFile.map((function(e,n){return(0,i.jsx)(j.rU,{href:t.descriptionFile[n],fontWeight:"bold",color:"blue",isExternal:!0,children:t.descriptionFile[n].substring(62)})})):(0,i.jsx)(i.Fragment,{})})]})]}),(0,i.jsxs)(j.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,i.jsx)(j.xu,{bgColor:"gray.200",p:4,children:(0,i.jsx)(j.X6,{fontSize:"xl",children:"Status & Quote"})}),(0,i.jsxs)(j.gC,{alignItems:"start",margin:3,minH:"sm",maxH:"sm",overflowY:"scroll",children:[(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Current Status:"}),(0,i.jsx)(j.xv,{children:"Fresh Order"===t.status?"Order Under Review":"CP1 Pending"===t.status?"1st Payment Link Sent":"CP2 Pending"===t.status?"2nd Payment Link Sent":"CP2 Done"===t.status?"Assignment Done":"CP2 Pending"===t.status?"2nd Payment Link Sent":"Work Underway"})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Quotation:"}),(0,i.jsx)(j.xv,{children:null!==t.quotation?Q._id+" "+(parseFloat(t.quotation)*parseFloat(Q.INRFactor)).toFixed(2):""})]}),(0,i.jsxs)(j.Ug,{padding:2,children:[(0,i.jsx)(j.xv,{fontWeight:"bold",children:"Paid:"}),(0,i.jsx)(j.xv,{children:null!==t.paid?Q._id+" "+(parseFloat(t.paid)*parseFloat(Q.INRFactor)).toFixed(2):""})]})]})]})]}),(0,i.jsx)(j.Ug,{children:(0,i.jsxs)(j.xu,{visibility:void 0!==U?"visible":"hidden",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,i.jsx)(j.xu,{p:4,bgColor:"gray.200",children:(0,i.jsx)(j.X6,{fontSize:"xl",children:"Chat with Sales"})}),(0,i.jsxs)(j.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,i.jsx)(j.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:_.map((function(e,n){return(0,i.jsx)(j.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",alignSelf:e.user===D?"flex-end":"flex-start",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:e.user===D?"blue.100":"green.100",children:(0,i.jsxs)(j.gC,{maxWidth:"100%",overflowWrap:"break-word",children:[(0,i.jsx)(j.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,i.jsx)(j.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg.substring(62)})]})},n)}))}),(0,i.jsxs)(x.BZ,{children:[(0,i.jsx)(x.II,{type:"text",id:"addSalesChat"}),(0,i.jsx)(x.II,{type:"file",id:"addFileSalesClient",onChange:k(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",H){A();try{r={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(H.current.files[0].name)+"?"+L,headers:{"x-ms-blob-type":"BlockBlob"},data:H.current.files[0]},c()(r).then(function(e){var r=k(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(H.current.files[0].name),e.next=3,(0,h.r7)((0,h.JU)(u.db,"chat",D+"_"+U+"_"+t.id),{conversation:(0,h.vr)({msg:n,time:Date.now(),type:"MEDIA",user:D})});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return r.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(i){console.log(i)}B()}case 2:case"end":return e.stop()}}),e)}))),ref:H,style:{display:"none"}}),(0,i.jsx)(x.Z8,{h:"full",children:(0,i.jsx)(m.zx,{id:"attachButton",onClick:k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,i.jsx)(w.Uj,{})})}),(0,i.jsx)(x.xH,{h:"full",children:(0,i.jsx)(m.zx,{id:"sendButton",onClick:k(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=/\b[\+]?[(]?[0-9]{2,6}[)]?[-\s\.]?[-\s\/\.0-9]{3,15}\b/m,""===(r=document.getElementById("addSalesChat")).value||void 0===r.value){e.next=10;break}if(!n.test(r.value)){e.next=7;break}window.alert("You are not allowed to share phone numbers in the chat"),e.next=10;break;case 7:return e.next=9,(0,h.r7)((0,h.JU)(u.db,"chat",D+"_"+U+"_"+t.id),{conversation:(0,h.vr)({msg:r.value,time:Date.now(),type:"TEXT",user:D})});case 9:e.sent;case 10:r.value="";case 11:case"end":return e.stop()}}),e)}))),children:(0,i.jsx)(w.mr,{})})})]})]})]})})]})}},7388:function(e,n,t){"use strict";t.d(n,{db:function(){return a}});t(8520);var r=t(5503),s=t(6257);var i=(0,r.ZF)({apiKey:"AIzaSyDni_CDXk80T4e4DbmAdxPejk6K8gl1_BE",authDomain:"assignment-santa.firebaseapp.com",projectId:"assignment-santa",storageBucket:"assignment-santa.appspot.com",messagingSenderId:"697591868119",appId:"1:697591868119:web:ab0da28fc783e036ab1e92"}),a=(0,s.ad)(i)}},function(e){e.O(0,[2016,9669,8527,7496,1716,3673,4612,9002,9774,2888,179],(function(){return n=6358,e(e.s=n);var n}));var n=e.O();_N_E=n}]);