(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8144],{2018:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/assignment_details/[assignmentID]",function(){return t(8694)}])},8694:function(e,n,t){"use strict";t.r(n);var r=t(8520),s=t.n(r),a=t(5893),i=t(9669),o=t.n(i),c=t(7294),l=(t(129),t(8754)),d=t(1163),u=t(2748),x=t(7388),h=t(6257),p=t(2028),m=t(9042),g=t(8790),f=t(8133),j=t(4612),b=t(5193),v=t(9762),w=t(7375),y=t(3441),C=t(9736),k=t(2024);function I(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(l){return void t(l)}o.done?n(c):Promise.resolve(c).then(r,s)}function S(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){I(a,r,s,i,o,"next",e)}function o(e){I(a,r,s,i,o,"throw",e)}i(void 0)}))}}n.default=function(){var e=function(){var e=[],n=(0,c.useState)(!1),t=n[0],i=n[1];return(0,a.jsxs)(p.u_,{size:"2xl",onClose:En.onClose,isOpen:En.isOpen,onOpen:En.onOpen,isCentered:!0,children:[(0,a.jsx)(p.ZA,{}),(0,a.jsxs)(p.hz,{children:[(0,a.jsx)(p.xB,{children:"Select the Files to Send"}),(0,a.jsx)(p.ol,{}),(0,a.jsx)(p.fe,{children:(0,a.jsxs)(m.iA,{variant:"simple",size:"sm",children:[(0,a.jsx)(m.hr,{bgColor:"gray.200",children:(0,a.jsxs)(m.Tr,{children:[(0,a.jsx)(m.Th,{children:"File"}),(0,a.jsx)(m.Th,{children:"Category"}),(0,a.jsx)(m.Th,{children:"User"}),(0,a.jsx)(m.Th,{})]})}),(0,a.jsx)(m.p3,{children:0===H.length?(0,a.jsx)(a.Fragment,{}):H.map((function(n,t){return(0,a.jsxs)(m.Tr,{children:[(0,a.jsx)(m.Td,{maxW:"100px",children:(0,a.jsx)(g.rU,{isExternal:!0,href:n.url,children:n.name})}),(0,a.jsx)(m.Td,{children:n.category}),(0,a.jsx)(m.Td,{children:n.userId}),(0,a.jsx)(m.Td,{children:(0,a.jsx)(f.XZ,{className:"fileCheckBox",value:{category:n.category,url:n.url,name:n.name},onChange:function(t){t.target.checked?e.push({category:n.category,url:n.url,name:n.name}):e.splice(e.indexOf(t.target.value))}})})]},t)}))})]})}),(0,a.jsx)(p.mz,{children:(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(f.XZ,{value:t,onChange:function(e){e.target.checked?i(!0):i(!1)},children:"Custom Email"}),(0,a.jsx)(j.II,{display:t?"block":"none",type:"text",id:"customMail"}),(0,a.jsx)(b.zx,{onClick:S(s().mark((function n(){var a,i,c;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==e.length){n.next=4;break}window.alert("Select Files to Send"),n.next=43;break;case 4:if(a=localStorage.getItem("userToken"),i={headers:{Authorization:"Bearer ".concat(a)}},!t){n.next=27;break}if(""!==(c=document.getElementById("customMail")).value){n.next=12;break}window.alert("Enter Email"),n.next=25;break;case 12:return n.prev=12,n.next=15,o().post(l.JW+"/assignment/final-delivery",{_id:fe.query.assignmentID,emailToDeliver:c.value,fileLinks:e},i);case 15:return n.sent,n.next=18,o().post(l.JW+"/notifications",{assignmentId:r.id,status:"CP2 Done",read:!1},i);case 18:n.sent,En.onClose(),window.alert("Files Sent to Client"),n.next=25;break;case 23:n.prev=23,n.t0=n.catch(12);case 25:n.next=43;break;case 27:return n.prev=27,n.next=30,o().post(l.JW+"/assignment/final-delivery",{_id:fe.query.assignmentID,emailToDeliver:r.client_id,fileLinks:e},i);case 30:return n.sent,n.next=33,o().post(l.JW+"/notifications",{assignmentId:r.id,status:"CP2 Done",read:!1},i);case 33:return n.sent,n.next=36,o().post(l.JW+"/assignment/update",{_id:fe.query.assignmentID,status:"CP2 Done"},i);case 36:n.sent,En.onClose(),window.alert("Files Sent to Client"),n.next=43;break;case 41:n.prev=41,n.t1=n.catch(27);case 43:case"end":return n.stop()}}),n,null,[[12,23],[27,41]])}))),children:"Send"})]})})]})]})},n=function(){return(0,a.jsxs)(p.u_,{size:"2xl",onClose:Un.onClose,isOpen:Un.isOpen,onOpen:Un.onOpen,isCentered:!0,children:[(0,a.jsx)(p.ZA,{}),(0,a.jsxs)(p.hz,{children:[(0,a.jsx)(p.xB,{children:"Add Assignment Files"}),(0,a.jsx)(p.ol,{}),(0,a.jsxs)(p.fe,{children:[(0,a.jsxs)(v.NI,{id:"file",children:[(0,a.jsx)(v.lX,{children:"1) Choose Upload File"}),(0,a.jsxs)(j.BZ,{children:[(0,a.jsx)(j.II,{type:"text",isReadOnly:!0,value:Qe}),(0,a.jsxs)(j.xW,{children:[(0,a.jsx)(b.zx,{onClick:function(){return Me.current.click()},children:(0,a.jsx)(C.Uj,{})}),(0,a.jsx)("input",{type:"file",onChange:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xe(Me.current.files[0].name),e.next=3,Sn(Me.current.files[0].name,Me.current.files[0]);case 3:case"end":return e.stop()}}),e)}))),ref:Me,style:{display:"none"}})]})]})]}),(0,a.jsxs)(j.BZ,{flexDirection:"column",children:[(0,a.jsx)(v.lX,{children:"2) Enter File Category"}),(0,a.jsx)(j.II,{type:"text",id:"fileCategory"})]})]}),(0,a.jsx)(p.mz,{children:(0,a.jsx)(b.zx,{onClick:S(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Pe){e.next=4;break}window.alert("File is still uploading... Please wait and try again"),e.next=21;break;case 4:if(""!==(n=document.getElementById("fileCategory")).value){e.next=9;break}window.alert("Please Enter File Category"),e.next=21;break;case 9:return t=localStorage.getItem("userToken"),r={headers:{Authorization:"Bearer ".concat(t)}},e.prev=11,e.next=14,o().post(l.JW+"/assignment/assignmentFiles",{_id:fe.query.assignmentID,files:[{category:n.value,url:Ne,name:Qe}]},r);case 14:e.sent,Un.onClose(),xn(),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(11);case 21:case"end":return e.stop()}}),e,null,[[11,19]])}))),children:"Upload"})})]})]})},t=(0,c.useState)(),r=t[0],i=t[1],I=(0,c.useState)(!0),W=I[0],E=I[1],A=(0,c.useState)([]),U=A[0],_=A[1],D=(0,c.useState)([]),T=D[0],F=D[1],B=(0,c.useState)([]),R=B[0],z=B[1],O=(0,c.useState)([]),J=O[0],Q=O[1],X=(0,c.useState)([]),H=X[0],N=X[1],q=(0,c.useState)([]),Z=q[0],P=q[1],Y=(0,c.useState)([]),M=Y[0],L=Y[1],V=(0,c.useState)([]),K=V[0],G=V[1],$=(0,c.useState)([]),ee=$[0],ne=$[1],te=(0,c.useState)([]),re=te[0],se=te[1],ae=(0,c.useState)([]),ie=ae[0],oe=ae[1],ce=(0,c.useState)([]),le=ce[0],de=ce[1],ue=(0,c.useState)(""),xe=ue[0],he=ue[1],pe=(0,c.useState)(""),me=pe[0],ge=pe[1],fe=(0,d.useRouter)(),je=[],be=[],ve=[],we=[],ye=[],Ce=[],ke=(0,c.useState)(""),Ie=ke[0],Se=ke[1],We=(0,c.useRef)(null),Ee=(0,c.useRef)(null),Ae=(0,c.useRef)(null),Ue=(0,c.useRef)(null),_e=(0,c.useRef)(null),De=(0,c.useState)(""),Te=De[0],Fe=De[1],Be=(0,w.qY)(),Re=Be.isOpen,ze=Be.onOpen,Oe=Be.onClose,Je=(0,c.useState)(""),Qe=Je[0],Xe=Je[1],He=(0,c.useState)(""),Ne=He[0],qe=He[1],Ze=(0,c.useState)(!1),Pe=Ze[0],Ye=Ze[1],Me=(0,c.useRef)(null);function Le(){return Ve.apply(this,arguments)}function Ve(){return(Ve=S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o().get(l.JW+"/util/sas-token?container_name=assignment-dscp");case 3:n=e.sent,(t=n.data).success&&Fe(t.SASToken),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Ke(){return Ge.apply(this,arguments)}function Ge(){return(Ge=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==(n=localStorage.getItem("userToken"))&&fe.replace("/admin/login"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=6,o().get(l.JW+"/assignment/quotes/fetch?assignment_id="+fe.query.assignmentID,t);case 6:return r=e.sent,e.next=9,r.data.result.expertQuotations;case 9:if(a=e.sent,Ce=[],0!==a.length)for(i=0;i<a.length;i++)Ce.push({_id:a[i]._id,wordCount:a[i].wordCount,cost:a[i].cost,currency:a[i].currency,comments:a[i].comments});else console.log("No Experts Found");P(Ce),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function $e(){return en.apply(this,arguments)}function en(){return(en=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().get(l.JW+"/assignment/assignmentFiles/fetch?assignment_id="+fe.query.assignmentID,t);case 4:return r=e.sent,e.next=7,r.data.result.assignmentFiles;case 7:if(a=e.sent,ye=[],null!==a)for(i=0;i<a.length;i++)ye.push({_id:a[i]._id,userId:a[i].userId,name:a[i].name,url:a[i].url,category:a[i].category,createdAt:new Date(a[i].createdAt).toLocaleTimeString()+", "+new Date(a[i].createdAt).toDateString()});else console.log("Activities Not Found");N(ye.reverse());case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nn(){return tn.apply(this,arguments)}function tn(){return(tn=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().get(l.JW+"/assignment/submissions/fetch?assignment_id="+fe.query.assignmentID,t);case 4:return r=e.sent,e.next=7,r.data.result.workSubmissions;case 7:if(a=e.sent,we=[],null!==a)for(i=0;i<a.length;i++)we.push({_id:a[i]._id,expertId:a[i].expertId,name:a[i].name,url:a[i].url,category:a[i].category,createdAt:new Date(a[i].createdAt).toLocaleTimeString()+", "+new Date(a[i].createdAt).toDateString()});else console.log("Activities Not Found");Q(we.reverse());case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rn(){return sn.apply(this,arguments)}function sn(){return(sn=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().get(l.JW+"/assignment/activity/fetch?assignment_id="+fe.query.assignmentID,t);case 4:return r=e.sent,e.next=7,r.data.result;case 7:if(a=e.sent,be=[],null!==a)for(i=0;i<a.activity.length;i++)be.push({_id:a.activity[i]._id,role:a.activity[i].role,user:a.activity[i].user,uid:a.activity[i].uid,action:a.activity[i].action,at:new Date(a.activity[i].createdAt).toLocaleTimeString()+", "+new Date(a.activity[i].createdAt).toDateString()});else console.log("Activities Not Found");z(be.reverse());case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(){return on.apply(this,arguments)}function on(){return(on=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().get(l.JW+"/assignment/qc-comments/fetch?assignment_id="+fe.query.assignmentID,t);case 4:return r=e.sent,e.next=7,r.data.result;case 7:if(a=e.sent,ve=[],null!==a)for(i=0;i<a.commentsFromQC.length;i++)ve.push({id:a.commentsFromQC[i]._id,name:a.commentsFromQC[i].name,comment:a.commentsFromQC[i].comment});else console.log("Notes Not Found");F(ve);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cn(){return(cn=S(s().mark((function e(){var n,t,a,i,c,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("userToken"),t=localStorage.getItem("userEmail"),a=localStorage.getItem("userName"),i=document.getElementById("addQc"),c={headers:{Authorization:"Bearer ".concat(n)}},""!==i.value){e.next=9;break}window.alert("Notes cannot be empty"),e.next=19;break;case 9:return e.next=11,o().post(l.JW+"/assignment/comments/QCToExpert",{assignmentId:fe.query.assignmentID,expertId:r.assignedExpert,commentsFromQC:{_id:t,name:a,comment:i.value}},c);case 11:if(!(d=e.sent).data.success){e.next=18;break}return e.next=15,an();case 15:i.value="",e.next=19;break;case 18:console.log(d);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ln(){return dn.apply(this,arguments)}function dn(){return(dn=S(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().get(l.JW+"/assignment/comments/fetch?assignment_id="+fe.query.assignmentID,t);case 4:return r=e.sent,e.next=7,r.data.result;case 7:if(a=e.sent,je=[],null!==a)for(i=0;i<a.notesFromOperator.length;i++)je.push({id:a.notesFromOperator[i]._id,name:a.notesFromOperator[i].name,comment:a.notesFromOperator[i].comment});else console.log("Notes Not Found");_(je);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function un(){return(un=S(s().mark((function e(){var n,t,a,i,c,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("userToken"),t=localStorage.getItem("userEmail"),a=localStorage.getItem("userName"),i=document.getElementById("addSticky"),c={headers:{Authorization:"Bearer ".concat(n)}},""!==i.value){e.next=9;break}window.alert("Notes cannot be empty"),e.next=19;break;case 9:return e.next=11,o().post(l.JW+"/assignment/comments/operatorToExpert",{assignmentId:fe.query.assignmentID,expertId:r.assignedExpert,notesFromOperator:{_id:t,name:a,comment:i.value}},c);case 11:if(!(d=e.sent).data.success){e.next=18;break}return e.next=15,ln();case 15:i.value="",e.next=19;break;case 18:console.log(d);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xn(){return hn.apply(this,arguments)}function hn(){return(hn=S(s().mark((function e(){var n,t,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,null==(n=localStorage.getItem("userToken"))&&fe.replace("/admin/login"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=6,o().get(l.JW+"/assignment/fetch?_id="+fe.query.assignmentID,t);case 6:return r=e.sent,e.next=9,r.data.assignmentData;case 9:if(0===(a=e.sent).length){e.next=41;break}return i({id:a[0]._id,assignedOperator:a[0].assignedOperator,assignedExpert:a[0].assignedExpert,assignedSales:a[0].assignedSales,assignedQC:a[0].assignedQC,client_id:a[0].client_id,subject:a[0].subject,status:a[0].status,quotation:a[0].quotation,currencyOfQuote:a[0].currencyOfQuote,createdAt:new Date(a[0].createdAt).toLocaleTimeString()+", "+new Date(a[0].createdAt).toDateString(),expertDeadline:a[0].expertDeadline?new Date(a[0].expertDeadline).toLocaleTimeString()+", "+new Date(a[0].expertDeadline).toDateString():"",level:a[0].level,reference:a[0].reference,description:a[0].description,descriptionFile:a[0].descriptionFile,numOfPages:a[0].numOfPages,paid:a[0].paid,deadline:new Date(a[0].deadline).toLocaleTimeString()+", "+new Date(a[0].deadline).toDateString()}),ge(a[0].client_id),e.next=15,gn(a[0].client_id,a[0].assignedSales,a[0]._id);case 15:return e.next=17,pn(a[0].client_id,a[0]._id);case 17:return e.next=19,vn(a[0].assignedExpert,a[0].assignedOperator,a[0]._id);case 19:return e.next=21,jn(a[0].assignedExpert,a[0]._id);case 21:return e.next=23,kn(a[0].assignedExpert,a[0].assignedQC,a[0]._id);case 23:return e.next=25,yn(a[0].assignedExpert,a[0]._id);case 25:return e.next=27,ln();case 27:return e.next=29,an();case 29:return e.next=31,rn();case 31:return e.next=33,nn();case 33:return e.next=35,$e();case 35:return e.next=37,Ke();case 37:return e.next=39,Le();case 39:e.next=42;break;case 41:console.log("Assignment Not Found");case 42:E(!1),e.next=48;break;case 45:e.prev=45,e.t0=e.catch(0),console.log(e.t0);case 48:case"end":return e.stop()}}),e,null,[[0,45]])})))).apply(this,arguments)}function pn(e,n){return mn.apply(this,arguments)}function mn(){return(mn=S(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=localStorage.getItem("userEmail"),he(r),e.prev=2,a=n+"_"+r+"_"+t,e.next=6,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 6:if(e.sent.exists()){e.next=10;break}return e.next=10,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 10:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){L(e.data().conversation)})),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(2);case 15:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}function gn(e,n,t){return fn.apply(this,arguments)}function fn(){return(fn=S(s().mark((function e(n,t,r){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Admin"!==localStorage.getItem("userRole")&&"Super Admin"!==localStorage.getItem("userRole")){e.next=14;break}return e.prev=1,a=n+"_"+t+"_"+r,e.next=5,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 5:if(e.sent.exists()){e.next=9;break}return e.next=9,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 9:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){G(e.data().conversation)})),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function jn(e,n){return bn.apply(this,arguments)}function bn(){return(bn=S(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=localStorage.getItem("userEmail"),e.prev=1,a=n+"_"+r+"_"+t,e.next=5,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 5:if(e.sent.exists()){e.next=9;break}return e.next=9,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 9:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){ne(e.data().conversation)})),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function vn(e,n,t){return wn.apply(this,arguments)}function wn(){return(wn=S(s().mark((function e(n,t,r){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Admin"!==localStorage.getItem("userRole")&&"Super Admin"!==localStorage.getItem("userRole")){e.next=14;break}return e.prev=1,a=n+"_"+t+"_"+r,e.next=5,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 5:if(e.sent.exists()){e.next=9;break}return e.next=9,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 9:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){se(e.data().conversation)})),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function yn(e,n){return Cn.apply(this,arguments)}function Cn(){return(Cn=S(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=localStorage.getItem("userEmail"),e.prev=1,a=n+"_"+r+"_"+t,e.next=5,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 5:if(e.sent.exists()){e.next=9;break}return e.next=9,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 9:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){oe(e.data().conversation)})),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function kn(e,n,t){return In.apply(this,arguments)}function In(){return(In=S(s().mark((function e(n,t,r){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Admin"!==localStorage.getItem("userRole")&&"Super Admin"!==localStorage.getItem("userRole")){e.next=14;break}return e.prev=1,a=n+"_"+t+"_"+r,e.next=5,(0,h.QT)((0,h.JU)(x.db,"chat",a));case 5:if(e.sent.exists()){e.next=9;break}return e.next=9,(0,h.pl)((0,h.JU)(x.db,"chat",a),{conversation:[]});case 9:(0,h.cf)((0,h.JU)(x.db,"chat",a),(function(e){de(e.data().conversation)})),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function Sn(e,n){return Wn.apply(this,arguments)}function Wn(){return(Wn=S(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(!0),r=t,a={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(n)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:r},o()(a).then((function(e){qe("https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(n)),Ye(!1)})).catch((function(e){console.log(e),Ye(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,c.useEffect)((function(){xn(),Se(localStorage.getItem("userRole"))}),[fe]);var En=(0,w.qY)();function An(){return(An=S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:En.onOpen();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Un=(0,w.qY)();function _n(){return(_n=S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Xe(""),qe(""),Un.onOpen();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return W?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(g.M5,{children:"Loading....."})}):void 0==r?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("h2",{children:"Invalid ID"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.default,{}),(0,a.jsxs)(g.gC,{alignItems:"start",margin:5,children:[(0,a.jsxs)(p.u_,{closeOnOverlayClick:!1,isOpen:Re,onClose:Oe,children:[(0,a.jsx)(p.ZA,{}),(0,a.jsxs)(p.hz,{children:[(0,a.jsx)(p.xB,{children:"File Upload"}),(0,a.jsx)(p.ol,{}),(0,a.jsx)(p.fe,{pb:6,children:"File is being uploaded, please wait.."})]})]}),(0,a.jsx)(n,{}),(0,a.jsx)(e,{}),(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(b.zx,{onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fe.replace("/admin/portal");case 1:case"end":return e.stop()}}),e)}))),children:"Back to Orders"}),(0,a.jsx)(b.zx,{leftIcon:(0,a.jsx)(C.ny,{}),onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xn();case 1:case"end":return e.stop()}}),e)}))),children:"Refresh"})]}),(0,a.jsxs)(g.Eq,{width:"100%",children:[(0,a.jsxs)(g.xu,{borderWidth:"1px",borderRadius:"md",width:"100%",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Order Details"})}),(0,a.jsxs)(g.gC,{alignItems:"start",margin:3,minH:"sm",maxH:"sm",overflowY:"scroll",children:[(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Ordered At:"}),(0,a.jsx)(g.xv,{children:r.createdAt})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Assignment ID:"}),(0,a.jsx)(g.xv,{children:r.id})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Subject:"}),(0,a.jsx)(g.xv,{children:r.subject})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Quotation:"}),(0,a.jsx)(g.xv,{children:r.quotation})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Paid:"}),(0,a.jsx)(g.xv,{children:r.paid})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Assigned Expert:"}),(0,a.jsx)(g.xv,{children:r.assignedExpert})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Assigned Sales:"}),(0,a.jsx)(g.xv,{children:r.assignedSales})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Assigned QC:"}),(0,a.jsx)(g.xv,{children:r.assignedQC})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Assigned Operator:"}),(0,a.jsx)(g.xv,{children:r.assignedOperator})]}),(0,a.jsxs)(g.gC,{padding:2,alignItems:"left",children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Description:"}),(0,a.jsx)(y.g,{width:"lg",contentEditable:!1,value:r.description,children:r.description})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Level:"}),(0,a.jsx)(g.xv,{children:r.level})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Reference:"}),(0,a.jsx)(g.xv,{children:r.reference})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Pages:"}),(0,a.jsx)(g.xv,{children:r.numOfPages})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Client Deadline:"}),(0,a.jsx)(g.xv,{children:r.deadline})]}),(0,a.jsxs)(g.Ug,{padding:2,children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Expert Deadline:"}),(0,a.jsx)(g.xv,{children:r.expertDeadline})]}),(0,a.jsx)(g.gC,{padding:2,alignItems:"left",children:0!=r.descriptionFile.length?r.descriptionFile.map((function(e,n){return(0,a.jsx)(g.rU,{href:r.descriptionFile[n],fontWeight:"bold",color:"blue",isExternal:!0,children:r.descriptionFile[n].substring(62)})})):(0,a.jsx)(a.Fragment,{})})]})]}),(0,a.jsxs)(g.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Action Window"})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===R.length?(0,a.jsx)(a.Fragment,{}):R.map((function(e,n){return(0,a.jsx)(g.xu,{children:(0,a.jsxs)(g.gC,{alignItems:"start",children:[(0,a.jsxs)(g.Ug,{children:[0===n?(0,a.jsx)(u.E.div,{animate:{scale:.5},transition:{repeat:1/0,repeatType:"reverse",duration:1},children:(0,a.jsx)(g.Cd,{size:"10px",bgColor:"tomato"})}):(0,a.jsx)(g.Cd,{size:"10px",bgColor:"blue.600"}),(0,a.jsx)(g.xv,{children:e.at+": "}),(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Client"===e.role?"Client":e.uid})]}),(0,a.jsx)(g.xv,{children:e.action}),(0,a.jsx)(g.xv,{fontWeight:"bold",children:"By: "+e.role})]})},e._id)}))})})]}),(0,a.jsxs)(g.xu,{display:"Admin"===Ie||"Super Admin"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Expert Quotations"})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===Z.length?(0,a.jsx)(a.Fragment,{}):Z.map((function(e,n){return(0,a.jsx)(g.xu,{children:(0,a.jsx)(g.gC,{alignItems:"start",marginBottom:"20px",children:(0,a.jsxs)(g.gC,{alignItems:"flex-start",children:[(0,a.jsxs)(g.xv,{color:e._id===r.assignedExpert?"red":"",fontWeight:"bold",children:["Expert: ",e._id]}),(0,a.jsxs)(g.xv,{children:["Amount: ",e.cost]})]})})},n)}))})})]}),(0,a.jsxs)(g.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsxs)(g.xu,{display:"flex",alignItems:"center",bgColor:"gray.200",p:2,children:[(0,a.jsx)(g.X6,{fontSize:"xl",children:"Assignment Files"}),(0,a.jsx)(g.LZ,{}),(0,a.jsx)(b.zx,{marginRight:"10px",onClick:function(){!function(){An.apply(this,arguments)}()},children:"Send to Client"}),(0,a.jsx)(b.zx,{onClick:function(){!function(){_n.apply(this,arguments)}()},children:"Upload"})]}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===H.length?(0,a.jsx)(a.Fragment,{}):H.map((function(e,n){return(0,a.jsx)(g.xu,{children:(0,a.jsxs)(g.gC,{alignItems:"start",marginBottom:"20px",children:[(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"\u2022 Category: "}),(0,a.jsx)(g.xv,{children:e.category})]}),(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"File Name: "}),(0,a.jsx)(g.rU,{isExternal:!0,href:e.url,children:e.name})]}),(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"User: "}),(0,a.jsx)(g.xv,{fontWeight:"bold",children:e.userId})]})]})},n)}))})})]}),(0,a.jsxs)(g.xu,{display:"QC"===Ie||"Admin"===Ie||"Super Admin"===Ie||"Operator"===Ie||"Sales"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Expert Submissions"})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===J.length?(0,a.jsx)(a.Fragment,{}):J.map((function(e,n){return(0,a.jsx)(g.xu,{children:(0,a.jsxs)(g.gC,{alignItems:"start",marginBottom:"20px",children:[(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"\u2022 Category: "}),(0,a.jsx)(g.xv,{children:e.category})]}),(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"File Name: "}),(0,a.jsx)(g.rU,{isExternal:!0,href:e.url,children:e.name})]}),(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:"Expert: "}),(0,a.jsx)(g.xv,{fontWeight:"bold",children:e.expertId})]})]})},e._id)}))})})]}),(0,a.jsxs)(g.xu,{display:"Operator"===Ie&&void 0!==r.assignedExpert?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsx)(g.Ug,{children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Operator Chat with Expert"})})}),(0,a.jsxs)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:ee.map((function(e,n){return(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",alignSelf:e.user===xe?"flex-end":"flex-start",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:e.user===xe?"blue.100":"green.100",children:(0,a.jsxs)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg&&e.msg.substring(62)})]})},n)}))}),(0,a.jsxs)(j.BZ,{children:[(0,a.jsx)(j.II,{type:"text",id:"addChatOperatorExpert"}),(0,a.jsx)(j.II,{type:"file",id:"addFileOperatorExpert",onChange:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",Ee){ze();try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ee.current.files[0].name)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:Ee.current.files[0]},o()(t).then(function(e){var t=S(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ee.current.files[0].name),e.next=3,(0,h.r7)((0,h.JU)(x.db,"chat",r.assignedExpert+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:n,time:Date.now(),type:"MEDIA",user:xe})});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(a){console.log(a)}Oe()}case 2:case"end":return e.stop()}}),e)}))),ref:Ee,style:{display:"none"}}),(0,a.jsx)(j.Z8,{h:"full",children:(0,a.jsx)(b.zx,{id:"attachButton",onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ee.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.Uj,{})})}),(0,a.jsx)(j.xH,{h:"full",children:(0,a.jsx)(b.zx,{id:"sendButton",onClick:S(s().mark((function e(){var n,t,a,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("userToken"),t=/\b[\+]?[(]?[0-9]{2,6}[)]?[-\s\.]?[-\s\/\.0-9]{3,15}\b/m,""===(a=document.getElementById("addChatOperatorExpert")).value||void 0===a.value){e.next=23;break}if(!t.test(a.value)){e.next=8;break}window.alert("Sharing Phone Numbers through Chat is not allowed"),e.next=23;break;case 8:return e.next=10,(0,h.r7)((0,h.JU)(x.db,"chat",r.assignedExpert+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:a.value,time:Date.now(),type:"TEXT",user:xe})});case 10:return e.sent,i={headers:{Authorization:"Bearer ".concat(n)}},e.prev=12,e.next=15,o().post(l.JW+"/messages",{id:r.id,expertEmail:r.assignedExpert},i);case 15:c=e.sent,c.data.success,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(12),console.log(e.t0);case 23:a.value="";case 24:case"end":return e.stop()}}),e,null,[[12,20]])}))),children:(0,a.jsx)(C.mr,{})})})]})]})]}),(0,a.jsxs)(g.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"Sticky Notes"})}),(0,a.jsxs)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===U.length?(0,a.jsx)(a.Fragment,{}):U.map((function(e,n){return(0,a.jsxs)(g.xu,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:e.name+":"}),(0,a.jsx)(g.xv,{display:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"==e.comment.substring(0,62)?"none":"flex",children:e.comment}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"==e.comment.substring(0,62)?"flex":"none",href:e.comment,children:e.comment.substring(62)})]},e.id+e.comment)}))}),(0,a.jsxs)(j.BZ,{visibility:"Operator"===Ie||"Admin"===Ie||"Super Admin"===Ie?"visible":"hidden",children:[(0,a.jsx)(j.II,{type:"text",id:"addSticky"}),(0,a.jsx)(j.II,{type:"file",id:"addFileStickyNotes",onChange:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",Ue)try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ue.current.files[0].name)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:Ue.current.files[0]},o()(t).then(function(e){var t=S(s().mark((function e(t){var a,i,c,d,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ue.current.files[0].name),a=localStorage.getItem("userToken"),i=localStorage.getItem("userEmail"),c=localStorage.getItem("userName"),d={headers:{Authorization:"Bearer ".concat(a)}},""!==n){e.next=9;break}window.alert("Attachment cannot be empty"),e.next=18;break;case 9:return e.next=11,o().post(l.JW+"/assignment/comments/operatorToExpert",{assignmentId:fe.query.assignmentID,expertId:r.assignedExpert,notesFromOperator:{_id:i,name:c,comment:n}},d);case 11:if(!(u=e.sent).data.success){e.next=17;break}return e.next=15,ln();case 15:e.next=18;break;case 17:console.log(u);case 18:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(a){console.log(a)}case 2:case"end":return e.stop()}}),e)}))),ref:Ue,style:{display:"none"}}),(0,a.jsx)(j.Z8,{h:"full",children:(0,a.jsx)(b.zx,{id:"attachButton",onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ue.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.Uj,{})})}),(0,a.jsx)(j.xH,{h:"full",children:(0,a.jsx)(b.zx,{variant:"outline",onClick:function(){!function(){un.apply(this,arguments)}()},children:(0,a.jsx)(C.mr,{})})})]})]})]}),(0,a.jsx)(g.Ug,{display:"QC"===Ie?"block":"none",children:(0,a.jsxs)(g.xu,{borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{bgColor:"gray.200",p:4,children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"QC Notes"})}),(0,a.jsxs)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:0===T.length?(0,a.jsx)(a.Fragment,{}):T.map((function(e,n){return(0,a.jsxs)(g.xu,{children:[(0,a.jsx)(g.xv,{fontWeight:"bold",children:e.name+":"}),(0,a.jsx)(g.xv,{display:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"==e.comment.substring(0,62)?"none":"flex",children:e.comment}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"==e.comment.substring(0,62)?"flex":"none",href:e.comment,children:e.comment.substring(62)})]},e.id+e.comment)}))}),(0,a.jsxs)(j.BZ,{visibility:"QC"===Ie?"visible":"hidden",children:[(0,a.jsx)(j.II,{type:"text",id:"addQc"}),(0,a.jsx)(j.II,{type:"file",id:"addFileQCNotes",onChange:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",_e)try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(_e.current.files[0].name)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:_e.current.files[0]},o()(t).then(function(e){var t=S(s().mark((function e(t){var a,i,c,d,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(_e.current.files[0].name),a=localStorage.getItem("userToken"),i=localStorage.getItem("userEmail"),c=localStorage.getItem("userName"),d={headers:{Authorization:"Bearer ".concat(a)}},""!==n){e.next=9;break}window.alert("Attachment cannot be empty"),e.next=18;break;case 9:return e.next=11,o().post(l.JW+"/assignment/comments/QCToExpert",{assignmentId:fe.query.assignmentID,expertId:r.assignedExpert,commentsFromQC:{_id:i,name:c,comment:n}},d);case 11:if(!(u=e.sent).data.success){e.next=17;break}return e.next=15,an();case 15:e.next=18;break;case 17:console.log(u);case 18:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(a){console.log(a)}case 2:case"end":return e.stop()}}),e)}))),ref:_e,style:{display:"none"}}),(0,a.jsx)(j.Z8,{h:"full",children:(0,a.jsx)(b.zx,{id:"attachButton",onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_e.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.Uj,{})})}),(0,a.jsx)(j.xH,{h:"full",children:(0,a.jsx)(b.zx,{variant:"outline",onClick:function(){!function(){cn.apply(this,arguments)}()},children:(0,a.jsx)(C.mr,{})})})]})]})]})}),(0,a.jsxs)(g.xu,{display:"QC"===Ie&&xe===r.assignedQC&&void 0!==r.assignedExpert?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsx)(g.Ug,{children:(0,a.jsx)(g.X6,{fontSize:"xl",children:"QC Chat with Expert"})})}),(0,a.jsxs)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:ie.map((function(e,n){return(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",alignSelf:e.user===xe?"flex-end":"flex-start",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:e.user===xe?"blue.100":"green.100",children:(0,a.jsxs)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg&&e.msg.substring(62)})]})},n)}))}),(0,a.jsxs)(j.BZ,{children:[(0,a.jsx)(j.II,{type:"text",id:"addChatQCExpert"}),(0,a.jsx)(j.II,{type:"file",id:"addFileQCExpert",onChange:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",We){ze();try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(We.current.files[0].name)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:We.current.files[0]},o()(t).then(function(e){var t=S(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(We.current.files[0].name),e.next=3,(0,h.r7)((0,h.JU)(x.db,"chat",r.assignedExpert+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:n,time:Date.now(),type:"MEDIA",user:xe})});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(a){console.log(a)}Oe()}case 2:case"end":return e.stop()}}),e)}))),ref:We,style:{display:"none"}}),(0,a.jsx)(j.Z8,{h:"full",children:(0,a.jsx)(b.zx,{id:"attachButton",onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:We.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.Uj,{})})}),(0,a.jsx)(j.xH,{h:"full",children:(0,a.jsx)(b.zx,{id:"sendButton",onClick:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=/\b[\+]?[(]?[0-9]{2,6}[)]?[-\s\.]?[-\s\/\.0-9]{3,15}\b/m,""===(t=document.getElementById("addChatQCExpert")).value||void 0===t.value){e.next=10;break}if(!n.test(t.value)){e.next=7;break}window.alert("Sharing Phone Numbers through Chat is not allowed"),e.next=10;break;case 7:return e.next=9,(0,h.r7)((0,h.JU)(x.db,"chat",r.assignedExpert+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:t.value,time:Date.now(),type:"TEXT",user:xe})});case 9:e.sent;case 10:t.value="";case 11:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.mr,{})})})]})]})]}),(0,a.jsxs)(g.xu,{display:"Sales"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.X6,{fontSize:"xl",children:"Sales Chat with Client"}),(0,a.jsx)(g.LZ,{}),(0,a.jsx)(g.xv,{visibility:"Sales"===Ie&&r.assignedSales!==xe?"visible":"hidden",color:"red",onClick:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("userToken"),t={headers:{Authorization:"Bearer ".concat(n)}},e.next=4,o().post(l.JW+"/assignment/update",{_id:r.id,assignedSales:xe},t);case 4:return e.sent,e.next=7,xn();case 7:window.alert("Override Complete. You are now Assigned to this Assignment");case 8:case"end":return e.stop()}}),e)}))),children:"Override"})]})}),(0,a.jsxs)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:[(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:M.map((function(e,n){return(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",alignSelf:e.user===xe?"flex-end":"flex-start",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:e.user===xe?"blue.100":"green.100",children:(0,a.jsxs)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg.substring(62)})]})},n)}))}),(0,a.jsxs)(j.BZ,{children:[(0,a.jsx)(j.II,{type:"text",id:"addChatSales"}),(0,a.jsx)(j.II,{type:"file",id:"addFileSalesClient",onChange:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",Ae)try{t={method:"put",url:"https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ae.current.files[0].name)+"?"+Te,headers:{"x-ms-blob-type":"BlockBlob"},data:Ae.current.files[0]},o()(t).then(function(e){var t=S(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://assignmentsanta.blob.core.windows.net/assignment-dscp/"+encodeURIComponent(Ae.current.files[0].name),e.next=3,(0,h.r7)((0,h.JU)(x.db,"chat",me+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:n,time:Date.now(),type:"MEDIA",user:xe})});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}catch(a){console.log(a)}case 2:case"end":return e.stop()}}),e)}))),ref:Ae,style:{display:"none"}}),(0,a.jsx)(j.Z8,{h:"full",children:(0,a.jsx)(b.zx,{id:"attachButton",onClick:S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ae.current.click();case 1:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.Uj,{})})}),(0,a.jsx)(j.xH,{h:"full",children:(0,a.jsx)(b.zx,{id:"sendButton",onClick:S(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.assignedSales===xe){e.next=4;break}window.alert("You are not assigned to this Assignment!!! You will have to override first to continue"),e.next=15;break;case 4:if(n=/\b[\+]?[(]?[0-9]{2,6}[)]?[-\s\.]?[-\s\/\.0-9]{3,15}\b/m,""===(t=document.getElementById("addChatSales")).value||void 0===t.value){e.next=14;break}if(!n.test(t.value)){e.next=11;break}window.alert("Sharing Phone Numbers through Chat is not allowed"),e.next=14;break;case 11:return e.next=13,(0,h.r7)((0,h.JU)(x.db,"chat",me+"_"+xe+"_"+r.id),{conversation:(0,h.vr)({msg:t.value,time:Date.now(),type:"TEXT",user:xe})});case 13:e.sent;case 14:t.value="";case 15:case"end":return e.stop()}}),e)}))),children:(0,a.jsx)(C.mr,{})})})]})]})]}),(0,a.jsxs)(g.xu,{display:"Admin"===Ie||"Super Admin"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.X6,{fontSize:"xl",children:"Sales Chat with Client (Admin View)"}),(0,a.jsx)(g.LZ,{})]})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:K.map((function(e,n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.xv,{fontWeight:"bold",maxWidth:"100%",children:[e.user,":"]}),(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:"green.100",children:(0,a.jsx)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:(0,a.jsxs)(g.gC,{children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg.substring(62)})]})})},n)]})}))})})]}),(0,a.jsxs)(g.xu,{display:"Admin"===Ie||"Super Admin"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.X6,{fontSize:"xl",children:"Operator Chat with Expert (Admin View)"}),(0,a.jsx)(g.LZ,{})]})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:re.map((function(e,n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.xv,{fontWeight:"bold",maxWidth:"100%",children:[e.user,":"]}),(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:"green.100",children:(0,a.jsx)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:(0,a.jsxs)(g.gC,{children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg.substring(62)})]})})},n)]})}))})})]}),(0,a.jsxs)(g.xu,{display:"Admin"===Ie||"Super Admin"===Ie?"block":"none",borderWidth:"1px",borderRadius:"md",width:"xl",children:[(0,a.jsx)(g.xu,{p:4,bgColor:"gray.200",children:(0,a.jsxs)(g.Ug,{children:[(0,a.jsx)(g.X6,{fontSize:"xl",children:"QC Chat with Expert (Admin View)"}),(0,a.jsx)(g.LZ,{})]})}),(0,a.jsx)(g.gC,{alignItems:"start",justifyContent:"space-between",margin:3,minH:"sm",maxH:"sm",children:(0,a.jsx)(g.gC,{overflowY:"scroll",alignItems:"start",width:"100%",children:le.map((function(e,n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.xv,{fontWeight:"bold",maxWidth:"100%",children:[e.user,":"]}),(0,a.jsx)(g.xu,{display:"TEXT"===e.type||"MEDIA"===e.type?"flex":"none",flexWrap:!0,padding:2,borderRadius:"md",maxWidth:"70%",bgColor:"green.100",children:(0,a.jsx)(g.gC,{maxWidth:"100%",overflowWrap:"break-word",children:(0,a.jsxs)(g.gC,{children:[(0,a.jsx)(g.xv,{display:"TEXT"===e.type?"flex":"none",maxWidth:"100%",children:e.msg}),(0,a.jsx)(g.rU,{color:"blue",fontWeight:"bold",display:"MEDIA"===e.type?"flex":"none",maxWidth:"100%",href:e.msg,children:e.msg.substring(62)})]})})},n)]})}))})})]})]})]})]})}},7388:function(e,n,t){"use strict";t.d(n,{db:function(){return i}});t(8520);var r=t(5503),s=t(6257);var a=(0,r.ZF)({apiKey:"AIzaSyDni_CDXk80T4e4DbmAdxPejk6K8gl1_BE",authDomain:"assignment-santa.firebaseapp.com",projectId:"assignment-santa",storageBucket:"assignment-santa.appspot.com",messagingSenderId:"697591868119",appId:"1:697591868119:web:ab0da28fc783e036ab1e92"}),i=(0,s.ad)(a)},4671:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(7294);function s(e){let n;const t=new Set,r=(e,r)=>{const s="function"===typeof e?e(n):e;if(s!==n){const e=n;n=r?s:Object.assign({},n,s),t.forEach((t=>t(n,e)))}},s=()=>n,a={setState:r,getState:s,subscribe:(e,r,a)=>r||a?((e,r=s,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let i=r(n);function o(){const t=r(n);if(!a(i,t)){const n=i;e(i=t,n)}}return t.add(o),()=>t.delete(o)})(e,r,a):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return n=e(r,s,a),a}const a="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?r.useEffect:r.useLayoutEffect;function i(e){const n="function"===typeof e?s(e):e,t=(e=n.getState,t=Object.is)=>{const[,s]=(0,r.useReducer)((e=>e+1),0),i=n.getState(),o=(0,r.useRef)(i),c=(0,r.useRef)(e),l=(0,r.useRef)(t),d=(0,r.useRef)(!1),u=(0,r.useRef)();let x;void 0===u.current&&(u.current=e(i));let h=!1;(o.current!==i||c.current!==e||l.current!==t||d.current)&&(x=e(i),h=!t(u.current,x)),a((()=>{h&&(u.current=x),o.current=i,c.current=e,l.current=t,d.current=!1}));const p=(0,r.useRef)(i);a((()=>{const e=()=>{try{const e=n.getState(),t=c.current(e);l.current(u.current,t)||(o.current=e,u.current=t,s())}catch(e){d.current=!0,s()}},t=n.subscribe(e);return n.getState()!==p.current&&e(),t}),[]);const m=h?x:u.current;return(0,r.useDebugValue)(m),m};return Object.assign(t,n),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[t,n];return{next(){const n=e.length<=0;return{value:e.shift(),done:n}}}},t}},4654:function(){}},function(e){e.O(0,[2016,9669,8527,7496,1716,3673,4612,5738,9002,3918,9411,129,6412,1172,2024,9774,2888,179],(function(){return n=2018,e(e.s=n);var n}));var n=e.O();_N_E=n}]);